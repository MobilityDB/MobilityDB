select tstzrange(p) from tbl_period;
                      tstzrange                      
-----------------------------------------------------
 ["2001-02-24 14:00:00+00","2001-02-24 14:00:00+00"]
 ("2001-09-11 20:08:00+00","2001-09-11 20:11:00+00"]
 ("2001-09-02 13:41:00+00","2001-09-02 13:47:00+00")
 ("2001-02-11 02:56:00+00","2001-02-11 03:00:00+00"]
 ("2001-06-03 09:57:00+00","2001-06-03 10:04:00+00")
 ["2001-09-25 11:37:00+00","2001-09-25 11:37:00+00"]
 ["2001-05-17 15:47:00+00","2001-05-17 15:49:00+00")
 ("2001-02-02 00:06:00+00","2001-02-02 00:14:00+00")
 ["2001-05-30 01:54:00+00","2001-05-30 01:55:00+00"]
 ["2001-04-09 15:30:00+00","2001-04-09 15:39:00+00"]
 ["2001-04-19 02:14:00+00","2001-04-19 02:18:00+00"]
 ["2001-11-22 14:48:00+00","2001-11-22 14:52:00+00"]
 ("2001-11-01 20:57:00+00","2001-11-01 20:58:00+00"]
 ("2001-06-03 06:51:00+00","2001-06-03 06:59:00+00"]
 ("2001-12-20 23:38:00+00","2001-12-20 23:46:00+00"]
 ["2001-04-23 19:13:00+00","2001-04-23 19:21:00+00"]
 ["2001-08-11 09:40:00+00","2001-08-11 09:48:00+00")
 ["2001-03-02 17:41:00+00","2001-03-02 17:41:00+00"]
 ["2001-07-14 04:06:00+00","2001-07-14 04:13:00+00"]
 ("2001-09-03 11:22:00+00","2001-09-03 11:28:00+00"]
 ("2001-12-10 23:51:00+00","2001-12-10 23:59:00+00"]
 ["2001-07-02 11:07:00+00","2001-07-02 11:10:00+00")
 ["2001-07-22 07:54:00+00","2001-07-22 07:54:00+00"]
 ["2001-02-22 00:56:00+00","2001-02-22 00:59:00+00")
 ("2001-11-04 06:08:00+00","2001-11-04 06:15:00+00"]
 ["2001-05-08 02:39:00+00","2001-05-08 02:42:00+00")
 ("2001-11-21 01:24:00+00","2001-11-21 01:28:00+00"]
 ("2001-12-01 13:53:00+00","2001-12-01 13:57:00+00"]
 ["2001-01-14 02:14:00+00","2001-01-14 02:23:00+00")
 ("2001-10-22 13:18:00+00","2001-10-22 13:25:00+00")
 ["2001-08-14 08:42:00+00","2001-08-14 08:45:00+00")
 ["2001-08-29 21:16:00+00","2001-08-29 21:21:00+00")
 ["2001-02-24 03:17:00+00","2001-02-24 03:24:00+00")
 ["2001-04-18 05:38:00+00","2001-04-18 05:38:00+00"]
 ["2001-08-27 00:30:00+00","2001-08-27 00:34:00+00")
 ["2001-03-30 12:18:00+00","2001-03-30 12:24:00+00")
 ("2001-02-21 18:17:00+00","2001-02-21 18:19:00+00"]
 ("2001-05-27 23:38:00+00","2001-05-27 23:43:00+00"]
 ["2001-07-31 16:01:00+00","2001-07-31 16:07:00+00")
 ["2001-01-24 20:01:00+00","2001-01-24 20:01:00+00"]
 ("2001-10-25 12:59:00+00","2001-10-25 13:04:00+00"]
 ["2001-09-12 21:35:00+00","2001-09-12 21:36:00+00")
 ("2001-05-08 06:40:00+00","2001-05-08 06:49:00+00"]
 ["2001-09-20 10:50:00+00","2001-09-20 10:50:00+00"]
 ("2001-11-20 04:50:00+00","2001-11-20 04:51:00+00"]
 ["2001-02-13 10:11:00+00","2001-02-13 10:12:00+00"]
 ("2001-09-21 07:22:00+00","2001-09-21 07:23:00+00"]
 ["2001-12-23 15:59:00+00","2001-12-23 15:59:00+00"]
 ["2001-12-26 13:58:00+00","2001-12-26 14:07:00+00"]
 ("2001-11-15 17:48:00+00","2001-11-15 17:49:00+00"]
 ["2001-04-24 23:11:00+00","2001-04-24 23:17:00+00")
 ("2001-08-04 09:02:00+00","2001-08-04 09:11:00+00"]
 ["2001-07-29 20:15:00+00","2001-07-29 20:16:00+00"]
 ["2001-11-10 22:11:00+00","2001-11-10 22:19:00+00"]
 ("2001-10-16 10:22:00+00","2001-10-16 10:29:00+00"]
 ["2001-04-01 10:53:00+00","2001-04-01 10:55:00+00"]
 ["2001-07-08 20:44:00+00","2001-07-08 20:47:00+00")
 ("2001-06-03 03:16:00+00","2001-06-03 03:21:00+00"]
 ["2001-02-19 10:08:00+00","2001-02-19 10:17:00+00"]
 ["2001-10-09 11:44:00+00","2001-10-09 11:49:00+00"]
 ("2001-08-20 14:54:00+00","2001-08-20 15:02:00+00"]
 ("2001-03-06 00:50:00+00","2001-03-06 00:57:00+00"]
 ["2001-05-27 02:26:00+00","2001-05-27 02:31:00+00")
 ("2001-11-28 20:24:00+00","2001-11-28 20:28:00+00")
 ["2001-10-09 22:24:00+00","2001-10-09 22:33:00+00"]
 ["2001-09-20 11:55:00+00","2001-09-20 12:03:00+00"]
 ("2001-01-28 18:45:00+00","2001-01-28 18:46:00+00"]
 ("2001-12-29 18:29:00+00","2001-12-29 18:33:00+00")
 ["2001-12-19 08:53:00+00","2001-12-19 09:02:00+00"]
 ["2001-01-29 05:06:00+00","2001-01-29 05:12:00+00")
 ["2001-12-16 06:53:00+00","2001-12-16 07:00:00+00"]
 ("2001-09-13 18:31:00+00","2001-09-13 18:40:00+00")
 ("2001-10-31 11:14:00+00","2001-10-31 11:22:00+00"]
 ["2001-03-23 07:55:00+00","2001-03-23 07:58:00+00")
 ["2001-12-30 00:05:00+00","2001-12-30 00:06:00+00"]
 ["2001-10-22 07:07:00+00","2001-10-22 07:08:00+00")
 ("2001-02-07 01:24:00+00","2001-02-07 01:25:00+00"]
 ("2001-11-23 01:21:00+00","2001-11-23 01:29:00+00"]
 ("2001-05-17 00:51:00+00","2001-05-17 00:58:00+00"]
 ["2001-12-26 01:44:00+00","2001-12-26 01:46:00+00"]
 ["2001-12-03 10:49:00+00","2001-12-03 10:51:00+00"]
 ["2001-08-24 00:07:00+00","2001-08-24 00:08:00+00")
 ("2001-12-14 00:47:00+00","2001-12-14 00:49:00+00")
 ["2001-05-05 21:12:00+00","2001-05-05 21:12:00+00"]
 ["2001-09-20 15:49:00+00","2001-09-20 15:51:00+00"]
 ["2001-09-07 15:25:00+00","2001-09-07 15:31:00+00")
 ["2001-05-20 22:12:00+00","2001-05-20 22:12:00+00"]
 ("2001-03-20 04:54:00+00","2001-03-20 04:56:00+00"]
 ["2001-10-31 18:36:00+00","2001-10-31 18:44:00+00")
 ["2001-01-10 04:11:00+00","2001-01-10 04:19:00+00")
 ("2001-12-22 01:33:00+00","2001-12-22 01:35:00+00")
 ["2001-12-01 10:40:00+00","2001-12-01 10:47:00+00")
 ("2001-05-14 07:00:00+00","2001-05-14 07:01:00+00")
 ["2001-02-24 21:32:00+00","2001-02-24 21:33:00+00")
 ["2001-11-13 16:48:00+00","2001-11-13 16:53:00+00"]
 ["2001-11-01 23:03:00+00","2001-11-01 23:04:00+00"]
 ["2001-10-03 20:17:00+00","2001-10-03 20:23:00+00"]
 ["2001-09-04 21:11:00+00","2001-09-04 21:19:00+00")
 ["2001-05-01 02:09:00+00","2001-05-01 02:16:00+00")
 ["2001-09-06 03:14:00+00","2001-09-06 03:21:00+00")
(100 rows)

select period(r) from tbl_tstzrange;
                      period                      
--------------------------------------------------
 (2001-11-10 23:37:00+00, 2001-11-10 23:38:00+00)
 [2001-02-14 15:54:00+00, 2001-02-14 15:54:00+00]
 [2001-04-03 06:14:00+00, 2001-04-03 06:14:00+00]
 [2001-10-08 20:35:00+00, 2001-10-08 20:39:00+00)
 [2001-04-03 17:32:00+00, 2001-04-03 17:37:00+00]
 [2001-01-14 22:07:00+00, 2001-01-14 22:16:00+00)
 (2001-09-29 19:05:00+00, 2001-09-29 19:12:00+00)
 [2001-01-20 13:58:00+00, 2001-01-20 14:01:00+00)
 (2001-09-05 18:55:00+00, 2001-09-05 19:02:00+00]
 (2001-06-05 21:17:00+00, 2001-06-05 21:23:00+00]
 (2001-07-14 05:39:00+00, 2001-07-14 05:48:00+00)
 (2001-11-02 22:14:00+00, 2001-11-02 22:20:00+00]
 (2001-02-04 05:30:00+00, 2001-02-04 05:31:00+00)
 (2001-10-09 00:23:00+00, 2001-10-09 00:31:00+00)
 [2001-06-27 15:43:00+00, 2001-06-27 15:43:00+00]
 [2001-04-26 15:40:00+00, 2001-04-26 15:43:00+00)
 (2001-03-11 12:40:00+00, 2001-03-11 12:47:00+00]
 [2001-06-13 14:14:00+00, 2001-06-13 14:14:00+00]
 [2001-03-17 21:57:00+00, 2001-03-17 22:03:00+00]
 [2001-10-04 22:12:00+00, 2001-10-04 22:16:00+00)
 (2001-01-24 04:54:00+00, 2001-01-24 05:00:00+00]
 (2001-06-12 01:01:00+00, 2001-06-12 01:08:00+00)
 [2001-12-09 02:55:00+00, 2001-12-09 02:59:00+00)
 (2001-12-12 08:44:00+00, 2001-12-12 08:53:00+00]
 (2001-03-20 23:00:00+00, 2001-03-20 23:06:00+00)
 [2001-11-28 20:20:00+00, 2001-11-28 20:23:00+00]
 [2001-03-23 11:31:00+00, 2001-03-23 11:33:00+00)
 [2001-03-09 08:20:00+00, 2001-03-09 08:23:00+00)
 (2001-03-13 00:15:00+00, 2001-03-13 00:19:00+00]
 [2001-10-08 09:13:00+00, 2001-10-08 09:19:00+00]
 (2001-11-03 03:13:00+00, 2001-11-03 03:16:00+00)
 (2001-02-05 11:35:00+00, 2001-02-05 11:42:00+00]
 (2001-06-02 20:57:00+00, 2001-06-02 21:02:00+00)
 (2001-06-17 16:41:00+00, 2001-06-17 16:46:00+00]
 [2001-07-27 02:37:00+00, 2001-07-27 02:38:00+00]
 [2001-02-05 04:53:00+00, 2001-02-05 04:59:00+00)
 [2001-07-20 21:55:00+00, 2001-07-20 21:56:00+00)
 (2001-01-08 01:14:00+00, 2001-01-08 01:15:00+00)
 (2001-10-23 15:12:00+00, 2001-10-23 15:18:00+00)
 [2001-11-07 14:32:00+00, 2001-11-07 14:37:00+00)
 [2001-04-20 11:31:00+00, 2001-04-20 11:38:00+00]
 [2001-10-29 17:15:00+00, 2001-10-29 17:15:00+00]
 (2001-06-24 16:49:00+00, 2001-06-24 16:53:00+00)
 (2001-12-02 04:18:00+00, 2001-12-02 04:27:00+00]
 (2001-07-12 04:09:00+00, 2001-07-12 04:18:00+00]
 (2001-09-15 12:33:00+00, 2001-09-15 12:41:00+00)
 [2001-08-10 09:09:00+00, 2001-08-10 09:14:00+00)
 (2001-09-25 23:32:00+00, 2001-09-25 23:39:00+00)
 [2001-07-03 03:45:00+00, 2001-07-03 03:46:00+00]
 [2001-11-18 19:23:00+00, 2001-11-18 19:28:00+00)
 [2001-11-08 19:57:00+00, 2001-11-08 20:02:00+00]
 (2001-06-22 13:15:00+00, 2001-06-22 13:24:00+00]
 (2001-03-14 23:06:00+00, 2001-03-14 23:09:00+00)
 (2001-08-27 07:16:00+00, 2001-08-27 07:20:00+00)
 (2001-11-21 07:42:00+00, 2001-11-21 07:44:00+00)
 [2001-05-29 12:37:00+00, 2001-05-29 12:43:00+00)
 (2001-02-15 12:47:00+00, 2001-02-15 12:49:00+00]
 [2001-10-30 21:25:00+00, 2001-10-30 21:31:00+00)
 [2001-10-30 02:48:00+00, 2001-10-30 02:54:00+00)
 [2001-01-21 07:38:00+00, 2001-01-21 07:45:00+00)
 (2001-12-04 13:41:00+00, 2001-12-04 13:46:00+00)
 [2001-07-14 09:10:00+00, 2001-07-14 09:11:00+00)
 (2001-06-01 14:57:00+00, 2001-06-01 14:58:00+00]
 (2001-06-04 23:54:00+00, 2001-06-05 00:02:00+00)
 [2001-11-01 00:01:00+00, 2001-11-01 00:01:00+00]
 (2001-04-17 17:17:00+00, 2001-04-17 17:24:00+00]
 [2001-10-02 20:09:00+00, 2001-10-02 20:13:00+00]
 [2001-01-05 09:42:00+00, 2001-01-05 09:46:00+00]
 [2001-04-23 19:03:00+00, 2001-04-23 19:11:00+00)
 [2001-12-09 07:03:00+00, 2001-12-09 07:04:00+00]
 (2001-03-29 01:05:00+00, 2001-03-29 01:14:00+00)
 [2001-05-15 07:46:00+00, 2001-05-15 07:49:00+00)
 [2001-03-30 06:13:00+00, 2001-03-30 06:20:00+00)
 [2001-02-16 07:58:00+00, 2001-02-16 08:05:00+00]
 [2001-01-06 07:11:00+00, 2001-01-06 07:11:00+00]
 (2001-01-30 06:15:00+00, 2001-01-30 06:21:00+00]
 [2001-01-08 09:02:00+00, 2001-01-08 09:09:00+00)
 [2001-08-23 14:23:00+00, 2001-08-23 14:30:00+00]
 (2001-03-23 15:50:00+00, 2001-03-23 15:54:00+00]
 [2001-05-18 19:02:00+00, 2001-05-18 19:06:00+00)
 (2001-09-15 20:43:00+00, 2001-09-15 20:50:00+00)
 (2001-04-02 14:35:00+00, 2001-04-02 14:39:00+00]
 [2001-12-03 21:30:00+00, 2001-12-03 21:37:00+00)
 [2001-07-29 05:58:00+00, 2001-07-29 05:58:00+00]
 [2001-01-25 13:54:00+00, 2001-01-25 14:00:00+00]
 (2001-11-14 16:59:00+00, 2001-11-14 17:02:00+00)
 (2001-06-10 06:43:00+00, 2001-06-10 06:49:00+00]
 [2001-02-18 14:58:00+00, 2001-02-18 14:58:00+00]
 (2001-12-18 16:09:00+00, 2001-12-18 16:12:00+00)
 (2001-12-13 11:02:00+00, 2001-12-13 11:09:00+00]
 (2001-08-05 22:50:00+00, 2001-08-05 22:55:00+00]
 (2001-08-24 21:22:00+00, 2001-08-24 21:25:00+00)
 [2001-02-22 01:46:00+00, 2001-02-22 01:54:00+00)
 [2001-05-26 14:54:00+00, 2001-05-26 15:03:00+00]
 [2001-10-01 13:16:00+00, 2001-10-01 13:20:00+00)
 (2001-02-02 04:31:00+00, 2001-02-02 04:37:00+00)
 (2001-11-13 11:56:00+00, 2001-11-13 12:01:00+00)
 [2001-06-18 15:06:00+00, 2001-06-18 15:07:00+00]
 (2001-02-27 19:47:00+00, 2001-02-27 19:50:00+00]
 (2001-05-06 07:50:00+00, 2001-05-06 07:51:00+00)
(100 rows)

select lower(p) from tbl_period;
         lower          
------------------------
 2001-02-24 14:00:00+00
 2001-09-11 20:08:00+00
 2001-09-02 13:41:00+00
 2001-02-11 02:56:00+00
 2001-06-03 09:57:00+00
 2001-09-25 11:37:00+00
 2001-05-17 15:47:00+00
 2001-02-02 00:06:00+00
 2001-05-30 01:54:00+00
 2001-04-09 15:30:00+00
 2001-04-19 02:14:00+00
 2001-11-22 14:48:00+00
 2001-11-01 20:57:00+00
 2001-06-03 06:51:00+00
 2001-12-20 23:38:00+00
 2001-04-23 19:13:00+00
 2001-08-11 09:40:00+00
 2001-03-02 17:41:00+00
 2001-07-14 04:06:00+00
 2001-09-03 11:22:00+00
 2001-12-10 23:51:00+00
 2001-07-02 11:07:00+00
 2001-07-22 07:54:00+00
 2001-02-22 00:56:00+00
 2001-11-04 06:08:00+00
 2001-05-08 02:39:00+00
 2001-11-21 01:24:00+00
 2001-12-01 13:53:00+00
 2001-01-14 02:14:00+00
 2001-10-22 13:18:00+00
 2001-08-14 08:42:00+00
 2001-08-29 21:16:00+00
 2001-02-24 03:17:00+00
 2001-04-18 05:38:00+00
 2001-08-27 00:30:00+00
 2001-03-30 12:18:00+00
 2001-02-21 18:17:00+00
 2001-05-27 23:38:00+00
 2001-07-31 16:01:00+00
 2001-01-24 20:01:00+00
 2001-10-25 12:59:00+00
 2001-09-12 21:35:00+00
 2001-05-08 06:40:00+00
 2001-09-20 10:50:00+00
 2001-11-20 04:50:00+00
 2001-02-13 10:11:00+00
 2001-09-21 07:22:00+00
 2001-12-23 15:59:00+00
 2001-12-26 13:58:00+00
 2001-11-15 17:48:00+00
 2001-04-24 23:11:00+00
 2001-08-04 09:02:00+00
 2001-07-29 20:15:00+00
 2001-11-10 22:11:00+00
 2001-10-16 10:22:00+00
 2001-04-01 10:53:00+00
 2001-07-08 20:44:00+00
 2001-06-03 03:16:00+00
 2001-02-19 10:08:00+00
 2001-10-09 11:44:00+00
 2001-08-20 14:54:00+00
 2001-03-06 00:50:00+00
 2001-05-27 02:26:00+00
 2001-11-28 20:24:00+00
 2001-10-09 22:24:00+00
 2001-09-20 11:55:00+00
 2001-01-28 18:45:00+00
 2001-12-29 18:29:00+00
 2001-12-19 08:53:00+00
 2001-01-29 05:06:00+00
 2001-12-16 06:53:00+00
 2001-09-13 18:31:00+00
 2001-10-31 11:14:00+00
 2001-03-23 07:55:00+00
 2001-12-30 00:05:00+00
 2001-10-22 07:07:00+00
 2001-02-07 01:24:00+00
 2001-11-23 01:21:00+00
 2001-05-17 00:51:00+00
 2001-12-26 01:44:00+00
 2001-12-03 10:49:00+00
 2001-08-24 00:07:00+00
 2001-12-14 00:47:00+00
 2001-05-05 21:12:00+00
 2001-09-20 15:49:00+00
 2001-09-07 15:25:00+00
 2001-05-20 22:12:00+00
 2001-03-20 04:54:00+00
 2001-10-31 18:36:00+00
 2001-01-10 04:11:00+00
 2001-12-22 01:33:00+00
 2001-12-01 10:40:00+00
 2001-05-14 07:00:00+00
 2001-02-24 21:32:00+00
 2001-11-13 16:48:00+00
 2001-11-01 23:03:00+00
 2001-10-03 20:17:00+00
 2001-09-04 21:11:00+00
 2001-05-01 02:09:00+00
 2001-09-06 03:14:00+00
(100 rows)

select upper(p) from tbl_period;
         upper          
------------------------
 2001-02-24 14:00:00+00
 2001-09-11 20:11:00+00
 2001-09-02 13:47:00+00
 2001-02-11 03:00:00+00
 2001-06-03 10:04:00+00
 2001-09-25 11:37:00+00
 2001-05-17 15:49:00+00
 2001-02-02 00:14:00+00
 2001-05-30 01:55:00+00
 2001-04-09 15:39:00+00
 2001-04-19 02:18:00+00
 2001-11-22 14:52:00+00
 2001-11-01 20:58:00+00
 2001-06-03 06:59:00+00
 2001-12-20 23:46:00+00
 2001-04-23 19:21:00+00
 2001-08-11 09:48:00+00
 2001-03-02 17:41:00+00
 2001-07-14 04:13:00+00
 2001-09-03 11:28:00+00
 2001-12-10 23:59:00+00
 2001-07-02 11:10:00+00
 2001-07-22 07:54:00+00
 2001-02-22 00:59:00+00
 2001-11-04 06:15:00+00
 2001-05-08 02:42:00+00
 2001-11-21 01:28:00+00
 2001-12-01 13:57:00+00
 2001-01-14 02:23:00+00
 2001-10-22 13:25:00+00
 2001-08-14 08:45:00+00
 2001-08-29 21:21:00+00
 2001-02-24 03:24:00+00
 2001-04-18 05:38:00+00
 2001-08-27 00:34:00+00
 2001-03-30 12:24:00+00
 2001-02-21 18:19:00+00
 2001-05-27 23:43:00+00
 2001-07-31 16:07:00+00
 2001-01-24 20:01:00+00
 2001-10-25 13:04:00+00
 2001-09-12 21:36:00+00
 2001-05-08 06:49:00+00
 2001-09-20 10:50:00+00
 2001-11-20 04:51:00+00
 2001-02-13 10:12:00+00
 2001-09-21 07:23:00+00
 2001-12-23 15:59:00+00
 2001-12-26 14:07:00+00
 2001-11-15 17:49:00+00
 2001-04-24 23:17:00+00
 2001-08-04 09:11:00+00
 2001-07-29 20:16:00+00
 2001-11-10 22:19:00+00
 2001-10-16 10:29:00+00
 2001-04-01 10:55:00+00
 2001-07-08 20:47:00+00
 2001-06-03 03:21:00+00
 2001-02-19 10:17:00+00
 2001-10-09 11:49:00+00
 2001-08-20 15:02:00+00
 2001-03-06 00:57:00+00
 2001-05-27 02:31:00+00
 2001-11-28 20:28:00+00
 2001-10-09 22:33:00+00
 2001-09-20 12:03:00+00
 2001-01-28 18:46:00+00
 2001-12-29 18:33:00+00
 2001-12-19 09:02:00+00
 2001-01-29 05:12:00+00
 2001-12-16 07:00:00+00
 2001-09-13 18:40:00+00
 2001-10-31 11:22:00+00
 2001-03-23 07:58:00+00
 2001-12-30 00:06:00+00
 2001-10-22 07:08:00+00
 2001-02-07 01:25:00+00
 2001-11-23 01:29:00+00
 2001-05-17 00:58:00+00
 2001-12-26 01:46:00+00
 2001-12-03 10:51:00+00
 2001-08-24 00:08:00+00
 2001-12-14 00:49:00+00
 2001-05-05 21:12:00+00
 2001-09-20 15:51:00+00
 2001-09-07 15:31:00+00
 2001-05-20 22:12:00+00
 2001-03-20 04:56:00+00
 2001-10-31 18:44:00+00
 2001-01-10 04:19:00+00
 2001-12-22 01:35:00+00
 2001-12-01 10:47:00+00
 2001-05-14 07:01:00+00
 2001-02-24 21:33:00+00
 2001-11-13 16:53:00+00
 2001-11-01 23:04:00+00
 2001-10-03 20:23:00+00
 2001-09-04 21:19:00+00
 2001-05-01 02:16:00+00
 2001-09-06 03:21:00+00
(100 rows)

select lower_inc(p) from tbl_period;
 lower_inc 
-----------
 t
 f
 f
 f
 f
 t
 t
 f
 t
 t
 t
 t
 f
 f
 f
 t
 t
 t
 t
 f
 f
 t
 t
 t
 f
 t
 f
 f
 t
 f
 t
 t
 t
 t
 t
 t
 f
 f
 t
 t
 f
 t
 f
 t
 f
 t
 f
 t
 t
 f
 t
 f
 t
 t
 f
 t
 t
 f
 t
 t
 f
 f
 t
 f
 t
 t
 f
 f
 t
 t
 t
 f
 f
 t
 t
 t
 f
 f
 f
 t
 t
 t
 f
 t
 t
 t
 t
 f
 t
 t
 f
 t
 f
 t
 t
 t
 t
 t
 t
 t
(100 rows)

select upper_inc(p) from tbl_period;
 upper_inc 
-----------
 t
 t
 f
 t
 f
 t
 f
 f
 t
 t
 t
 t
 t
 t
 t
 t
 f
 t
 t
 t
 t
 f
 t
 f
 t
 f
 t
 t
 f
 f
 f
 f
 f
 t
 f
 f
 t
 t
 f
 t
 t
 f
 t
 t
 t
 t
 t
 t
 t
 t
 f
 t
 t
 t
 t
 t
 f
 t
 t
 t
 t
 t
 f
 f
 t
 t
 t
 f
 t
 f
 t
 f
 t
 f
 t
 f
 t
 t
 t
 t
 t
 f
 f
 t
 t
 f
 t
 t
 f
 f
 f
 f
 f
 f
 t
 t
 t
 f
 f
 f
(100 rows)

select duration(p) from tbl_period;
 duration 
----------
 00:00:00
 00:03:00
 00:06:00
 00:04:00
 00:07:00
 00:00:00
 00:02:00
 00:08:00
 00:01:00
 00:09:00
 00:04:00
 00:04:00
 00:01:00
 00:08:00
 00:08:00
 00:08:00
 00:08:00
 00:00:00
 00:07:00
 00:06:00
 00:08:00
 00:03:00
 00:00:00
 00:03:00
 00:07:00
 00:03:00
 00:04:00
 00:04:00
 00:09:00
 00:07:00
 00:03:00
 00:05:00
 00:07:00
 00:00:00
 00:04:00
 00:06:00
 00:02:00
 00:05:00
 00:06:00
 00:00:00
 00:05:00
 00:01:00
 00:09:00
 00:00:00
 00:01:00
 00:01:00
 00:01:00
 00:00:00
 00:09:00
 00:01:00
 00:06:00
 00:09:00
 00:01:00
 00:08:00
 00:07:00
 00:02:00
 00:03:00
 00:05:00
 00:09:00
 00:05:00
 00:08:00
 00:07:00
 00:05:00
 00:04:00
 00:09:00
 00:08:00
 00:01:00
 00:04:00
 00:09:00
 00:06:00
 00:07:00
 00:09:00
 00:08:00
 00:03:00
 00:01:00
 00:01:00
 00:01:00
 00:08:00
 00:07:00
 00:02:00
 00:02:00
 00:01:00
 00:02:00
 00:00:00
 00:02:00
 00:06:00
 00:00:00
 00:02:00
 00:08:00
 00:08:00
 00:02:00
 00:07:00
 00:01:00
 00:01:00
 00:05:00
 00:01:00
 00:06:00
 00:08:00
 00:07:00
 00:07:00
(100 rows)

select shift(p, '5 min') from tbl_period;
                      shift                       
--------------------------------------------------
 [2001-02-24 14:05:00+00, 2001-02-24 14:05:00+00]
 (2001-09-11 20:13:00+00, 2001-09-11 20:16:00+00]
 (2001-09-02 13:46:00+00, 2001-09-02 13:52:00+00)
 (2001-02-11 03:01:00+00, 2001-02-11 03:05:00+00]
 (2001-06-03 10:02:00+00, 2001-06-03 10:09:00+00)
 [2001-09-25 11:42:00+00, 2001-09-25 11:42:00+00]
 [2001-05-17 15:52:00+00, 2001-05-17 15:54:00+00)
 (2001-02-02 00:11:00+00, 2001-02-02 00:19:00+00)
 [2001-05-30 01:59:00+00, 2001-05-30 02:00:00+00]
 [2001-04-09 15:35:00+00, 2001-04-09 15:44:00+00]
 [2001-04-19 02:19:00+00, 2001-04-19 02:23:00+00]
 [2001-11-22 14:53:00+00, 2001-11-22 14:57:00+00]
 (2001-11-01 21:02:00+00, 2001-11-01 21:03:00+00]
 (2001-06-03 06:56:00+00, 2001-06-03 07:04:00+00]
 (2001-12-20 23:43:00+00, 2001-12-20 23:51:00+00]
 [2001-04-23 19:18:00+00, 2001-04-23 19:26:00+00]
 [2001-08-11 09:45:00+00, 2001-08-11 09:53:00+00)
 [2001-03-02 17:46:00+00, 2001-03-02 17:46:00+00]
 [2001-07-14 04:11:00+00, 2001-07-14 04:18:00+00]
 (2001-09-03 11:27:00+00, 2001-09-03 11:33:00+00]
 (2001-12-10 23:56:00+00, 2001-12-11 00:04:00+00]
 [2001-07-02 11:12:00+00, 2001-07-02 11:15:00+00)
 [2001-07-22 07:59:00+00, 2001-07-22 07:59:00+00]
 [2001-02-22 01:01:00+00, 2001-02-22 01:04:00+00)
 (2001-11-04 06:13:00+00, 2001-11-04 06:20:00+00]
 [2001-05-08 02:44:00+00, 2001-05-08 02:47:00+00)
 (2001-11-21 01:29:00+00, 2001-11-21 01:33:00+00]
 (2001-12-01 13:58:00+00, 2001-12-01 14:02:00+00]
 [2001-01-14 02:19:00+00, 2001-01-14 02:28:00+00)
 (2001-10-22 13:23:00+00, 2001-10-22 13:30:00+00)
 [2001-08-14 08:47:00+00, 2001-08-14 08:50:00+00)
 [2001-08-29 21:21:00+00, 2001-08-29 21:26:00+00)
 [2001-02-24 03:22:00+00, 2001-02-24 03:29:00+00)
 [2001-04-18 05:43:00+00, 2001-04-18 05:43:00+00]
 [2001-08-27 00:35:00+00, 2001-08-27 00:39:00+00)
 [2001-03-30 12:23:00+00, 2001-03-30 12:29:00+00)
 (2001-02-21 18:22:00+00, 2001-02-21 18:24:00+00]
 (2001-05-27 23:43:00+00, 2001-05-27 23:48:00+00]
 [2001-07-31 16:06:00+00, 2001-07-31 16:12:00+00)
 [2001-01-24 20:06:00+00, 2001-01-24 20:06:00+00]
 (2001-10-25 13:04:00+00, 2001-10-25 13:09:00+00]
 [2001-09-12 21:40:00+00, 2001-09-12 21:41:00+00)
 (2001-05-08 06:45:00+00, 2001-05-08 06:54:00+00]
 [2001-09-20 10:55:00+00, 2001-09-20 10:55:00+00]
 (2001-11-20 04:55:00+00, 2001-11-20 04:56:00+00]
 [2001-02-13 10:16:00+00, 2001-02-13 10:17:00+00]
 (2001-09-21 07:27:00+00, 2001-09-21 07:28:00+00]
 [2001-12-23 16:04:00+00, 2001-12-23 16:04:00+00]
 [2001-12-26 14:03:00+00, 2001-12-26 14:12:00+00]
 (2001-11-15 17:53:00+00, 2001-11-15 17:54:00+00]
 [2001-04-24 23:16:00+00, 2001-04-24 23:22:00+00)
 (2001-08-04 09:07:00+00, 2001-08-04 09:16:00+00]
 [2001-07-29 20:20:00+00, 2001-07-29 20:21:00+00]
 [2001-11-10 22:16:00+00, 2001-11-10 22:24:00+00]
 (2001-10-16 10:27:00+00, 2001-10-16 10:34:00+00]
 [2001-04-01 10:58:00+00, 2001-04-01 11:00:00+00]
 [2001-07-08 20:49:00+00, 2001-07-08 20:52:00+00)
 (2001-06-03 03:21:00+00, 2001-06-03 03:26:00+00]
 [2001-02-19 10:13:00+00, 2001-02-19 10:22:00+00]
 [2001-10-09 11:49:00+00, 2001-10-09 11:54:00+00]
 (2001-08-20 14:59:00+00, 2001-08-20 15:07:00+00]
 (2001-03-06 00:55:00+00, 2001-03-06 01:02:00+00]
 [2001-05-27 02:31:00+00, 2001-05-27 02:36:00+00)
 (2001-11-28 20:29:00+00, 2001-11-28 20:33:00+00)
 [2001-10-09 22:29:00+00, 2001-10-09 22:38:00+00]
 [2001-09-20 12:00:00+00, 2001-09-20 12:08:00+00]
 (2001-01-28 18:50:00+00, 2001-01-28 18:51:00+00]
 (2001-12-29 18:34:00+00, 2001-12-29 18:38:00+00)
 [2001-12-19 08:58:00+00, 2001-12-19 09:07:00+00]
 [2001-01-29 05:11:00+00, 2001-01-29 05:17:00+00)
 [2001-12-16 06:58:00+00, 2001-12-16 07:05:00+00]
 (2001-09-13 18:36:00+00, 2001-09-13 18:45:00+00)
 (2001-10-31 11:19:00+00, 2001-10-31 11:27:00+00]
 [2001-03-23 08:00:00+00, 2001-03-23 08:03:00+00)
 [2001-12-30 00:10:00+00, 2001-12-30 00:11:00+00]
 [2001-10-22 07:12:00+00, 2001-10-22 07:13:00+00)
 (2001-02-07 01:29:00+00, 2001-02-07 01:30:00+00]
 (2001-11-23 01:26:00+00, 2001-11-23 01:34:00+00]
 (2001-05-17 00:56:00+00, 2001-05-17 01:03:00+00]
 [2001-12-26 01:49:00+00, 2001-12-26 01:51:00+00]
 [2001-12-03 10:54:00+00, 2001-12-03 10:56:00+00]
 [2001-08-24 00:12:00+00, 2001-08-24 00:13:00+00)
 (2001-12-14 00:52:00+00, 2001-12-14 00:54:00+00)
 [2001-05-05 21:17:00+00, 2001-05-05 21:17:00+00]
 [2001-09-20 15:54:00+00, 2001-09-20 15:56:00+00]
 [2001-09-07 15:30:00+00, 2001-09-07 15:36:00+00)
 [2001-05-20 22:17:00+00, 2001-05-20 22:17:00+00]
 (2001-03-20 04:59:00+00, 2001-03-20 05:01:00+00]
 [2001-10-31 18:41:00+00, 2001-10-31 18:49:00+00)
 [2001-01-10 04:16:00+00, 2001-01-10 04:24:00+00)
 (2001-12-22 01:38:00+00, 2001-12-22 01:40:00+00)
 [2001-12-01 10:45:00+00, 2001-12-01 10:52:00+00)
 (2001-05-14 07:05:00+00, 2001-05-14 07:06:00+00)
 [2001-02-24 21:37:00+00, 2001-02-24 21:38:00+00)
 [2001-11-13 16:53:00+00, 2001-11-13 16:58:00+00]
 [2001-11-01 23:08:00+00, 2001-11-01 23:09:00+00]
 [2001-10-03 20:22:00+00, 2001-10-03 20:28:00+00]
 [2001-09-04 21:16:00+00, 2001-09-04 21:24:00+00)
 [2001-05-01 02:14:00+00, 2001-05-01 02:21:00+00)
 [2001-09-06 03:19:00+00, 2001-09-06 03:26:00+00)
(100 rows)

select count(*) from tbl_period t1, tbl_period t2 where period_cmp(t1.p, t2.p) = -1;
 count 
-------
  4950
(1 row)

select count(*) from tbl_period t1, tbl_period t2 where t1.p < t2.p;
 count 
-------
  4950
(1 row)

select count(*) from tbl_period t1, tbl_period t2 where t1.p <= t2.p;
 count 
-------
  5050
(1 row)

select count(*) from tbl_period t1, tbl_period t2 where t1.p > t2.p;
 count 
-------
  4950
(1 row)

select count(*) from tbl_period t1, tbl_period t2 where t1.p >= t2.p;
 count 
-------
  5050
(1 row)

