SELECT timestamptz '2000-01-01' + timestamptz '2000-01-01';
         ?column?         
--------------------------
 {2000-01-01 00:00:00+00}
(1 row)

SELECT timestamptz '2000-01-01' + timestamptz '2000-01-02';
                     ?column?                     
--------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00}
(1 row)

SELECT timestamptz '2000-01-01' + timestampset '{2000-01-02, 2000-01-03, 2000-01-05}';
                                             ?column?                                             
--------------------------------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestamptz '2000-01-01' + timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                 ?column?                                 
--------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestamptz '2000-01-05' + timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                 ?column?                                 
--------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestamptz '2000-01-06' + timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                             ?column?                                             
--------------------------------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00}
(1 row)

SELECT timestamptz '2000-01-01' + period '[2000-01-02, 2000-01-03]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00], [2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-01' + period '[2000-01-01, 2000-01-03]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-01' + period '(2000-01-01, 2000-01-03]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-02' + period '[2000-01-01, 2000-01-03]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-03' + period '[2000-01-01, 2000-01-03]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-03' + period '[2000-01-01, 2000-01-03)';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-05' + period '[2000-01-01, 2000-01-03]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-01' + periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-01' + periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                                                        ?column?                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00], [2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-03' + periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-04' + periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-04' + periodset '{[2000-01-02, 2000-01-03],[2000-01-05, 2000-01-05]}';
                                                                        ?column?                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-05' + periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-06' + periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                                                        ?column?                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00], [2000-01-06 00:00:00+00, 2000-01-06 00:00:00+00]}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' + timestamptz '2000-01-01';
                                 ?column?                                 
--------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' + timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                 ?column?                                 
--------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' + timestampset '{2000-01-03, 2000-01-05, 2000-01-07}';
                                             ?column?                                             
--------------------------------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00, 2000-01-07 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' + period '[2000-01-01, 2000-01-03]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' + periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' + timestamptz '2000-01-01';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' + timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT period '(2000-01-01, 2000-01-03]' + timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-03)' + timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' + period '[2000-01-01, 2000-01-03]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' + period '(2000-01-03, 2000-01-05]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' + periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' + timestamptz '2000-01-01';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' + timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' + period '[2000-01-01, 2000-01-03]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' + periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}' + period '[2000-01-01,2000-01-02]';
                                                                        ?column?                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00], [2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}' + period '[2000-01-05,2000-01-06]';
                                                                        ?column?                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}' + period '[2000-01-09,2000-01-10]';
                                                                        ?column?                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00], [2000-01-09 00:00:00+00, 2000-01-10 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}' + period '[2000-01-01,2000-01-03)';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}' + period '[2000-01-05,2000-01-07)';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}' + period '(2000-01-08,2000-01-10]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-10 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}' + period '[2000-01-01,2000-01-03]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}' + period '[2000-01-05,2000-01-07]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}' + period '[2000-01-08,2000-01-10]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-10 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01,2000-01-02],[2000-01-04,2000-01-05],[2000-01-07,2000-01-08]}' + period '[2000-01-03,2000-01-06]';
                                                                        ?column?                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00], [2000-01-03 00:00:00+00, 2000-01-06 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01,2000-01-02],[2000-01-04,2000-01-05],[2000-01-07,2000-01-08]}' + period '[2000-01-04,2000-01-06]';
                                                                        ?column?                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-06 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01,2000-01-02],[2000-01-04,2000-01-05],[2000-01-07,2000-01-08]}' + period '[2000-01-03,2000-01-05]';
                                                                        ?column?                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00], [2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-04,2000-01-05],[2000-01-07,2000-01-08]}' + period '[2000-01-01,2000-01-09]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-09 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-04,2000-01-05],[2000-01-07,2000-01-08]}' + period '[2000-01-01,2000-01-06]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-06 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-04,2000-01-05],[2000-01-07,2000-01-08]}' + period '[2000-01-06,2000-01-09]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00], [2000-01-06 00:00:00+00, 2000-01-09 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01,2000-01-02],[2000-01-05,2000-01-06]}' + periodset '{[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}';
                                                                                                 ?column?                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00], [2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01,2000-01-02],[2000-01-05,2000-01-06]}' + periodset '{[2000-01-01,2000-01-02],[2000-01-03,2000-01-04],[2000-01-07,2000-01-08]}';
                                                                                                 ?column?                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00], [2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-02],[2000-01-03, 2000-01-04], [2000-01-06, 2000-01-07]}' + periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-05 00:00:00+00], [2000-01-06 00:00:00+00, 2000-01-07 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}' + periodset '{[2000-01-01, 2000-01-02],[2000-01-03, 2000-01-04], [2000-01-06, 2000-01-07]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-05 00:00:00+00], [2000-01-06 00:00:00+00, 2000-01-07 00:00:00+00]}
(1 row)

SELECT temporal_minus(timestamptz '2000-01-01', timestamptz '2000-01-01');
 temporal_minus 
----------------
 
(1 row)

SELECT temporal_minus(timestamptz '2000-01-01', timestamptz '2000-01-02');
     temporal_minus     
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-01' - timestampset '{2000-01-02, 2000-01-03, 2000-01-05}';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-01' - timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-05' - timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-06' - timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
        ?column?        
------------------------
 2000-01-06 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-01' - period '[2000-01-02, 2000-01-03]';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-01' - period '[2000-01-01, 2000-01-03]';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-01' - period '(2000-01-01, 2000-01-03]';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-02' - period '[2000-01-01, 2000-01-03]';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-03' - period '[2000-01-01, 2000-01-03]';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-03' - period '[2000-01-01, 2000-01-03)';
        ?column?        
------------------------
 2000-01-03 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-05' - period '[2000-01-01, 2000-01-03]';
        ?column?        
------------------------
 2000-01-05 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-01' - periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-01' - periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-03' - periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-04' - periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-04' - periodset '{[2000-01-02, 2000-01-03],[2000-01-05, 2000-01-05]}';
        ?column?        
------------------------
 2000-01-04 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-05' - periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-06' - periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
        ?column?        
------------------------
 2000-01-06 00:00:00+00
(1 row)

SELECT timestampset '{2000-01-01}' - timestamptz '2000-01-01';
 ?column? 
----------
 
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' - timestamptz '2000-01-01';
                     ?column?                     
--------------------------------------------------
 {2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' - timestamptz '2000-01-02';
                                 ?column?                                 
--------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' - timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
 ?column? 
----------
 
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' - timestampset '{2000-01-03, 2000-01-05, 2000-01-07}';
         ?column?         
--------------------------
 {2000-01-01 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' - period '[2000-01-01, 2000-01-03]';
         ?column?         
--------------------------
 {2000-01-05 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' - period '[2000-01-01, 2000-01-05]';
 ?column? 
----------
 
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-04}' - periodset '{[2000-01-02, 2000-01-03],[2000-01-05, 2000-01-06]}';
                     ?column?                     
--------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-04 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-04}' - periodset '{[2000-01-02, 2000-01-03]}';
                     ?column?                     
--------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-04 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03}' - periodset '{(2000-01-01, 2000-01-04)}';
         ?column?         
--------------------------
 {2000-01-01 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' - periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT period '[2000-01-01, 2000-01-01]' - timestamptz '2000-01-01';
 ?column? 
----------
 
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' - timestamptz '2000-01-01';
                      ?column?                      
----------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-01]' - timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
 ?column? 
----------
 
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' - timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                      ?column?                      
----------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00)}
(1 row)

SELECT period '(2000-01-01, 2000-01-03]' - timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                      ?column?                      
----------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00)}
(1 row)

SELECT period '[2000-01-01, 2000-01-03)' - timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                      ?column?                      
----------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00)}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' - timestampset '{2000-01-02, 2000-01-04}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00), (2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' - period '[2000-01-01, 2000-01-03]';
 ?column? 
----------
 
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' - period '(2000-01-03, 2000-01-05]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' - periodset '{[2000-01-01, 2000-01-02],[2000-01-04, 2000-01-05]}';
                      ?column?                      
----------------------------------------------------
 {(2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' - periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT period '[2000-01-02, 2000-01-04]' - timestamptz '2000-01-01';
                      ?column?                      
----------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-04 00:00:00+00]}
(1 row)

SELECT period '[2000-01-02, 2000-01-04]' - timestamptz '2000-01-02';
                      ?column?                      
----------------------------------------------------
 {(2000-01-02 00:00:00+00, 2000-01-04 00:00:00+00]}
(1 row)

SELECT period '[2000-01-02, 2000-01-04]' - timestamptz '2000-01-03';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00), (2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00]}
(1 row)

SELECT period '[2000-01-02, 2000-01-04]' - timestamptz '2000-01-04';
                      ?column?                      
----------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

SELECT period '[2000-01-02, 2000-01-04]' - timestamptz '2000-01-05';
                      ?column?                      
----------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-04 00:00:00+00]}
(1 row)

SELECT period '(2000-01-02, 2000-01-04)' - timestamptz '2000-01-01';
                      ?column?                      
----------------------------------------------------
 {(2000-01-02 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

SELECT period '(2000-01-02, 2000-01-04)' - timestamptz '2000-01-02';
                      ?column?                      
----------------------------------------------------
 {(2000-01-02 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

SELECT period '(2000-01-02, 2000-01-04)' - timestamptz '2000-01-03';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {(2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00), (2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

SELECT period '(2000-01-02, 2000-01-04)' - timestamptz '2000-01-04';
                      ?column?                      
----------------------------------------------------
 {(2000-01-02 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

SELECT period '(2000-01-02, 2000-01-04)' - timestamptz '2000-01-05';
                      ?column?                      
----------------------------------------------------
 {(2000-01-02 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-01]}' - timestamptz '2000-01-01';
 ?column? 
----------
 
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' - timestamptz '2000-01-01';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-06],[2000-01-07, 2000-01-08]}' - timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                                                                                 ?column?                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00), [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00), (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00], [2000-01-07 00:00:00+00, 2000-01-08 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-02],[2000-01-03, 2000-01-04]}' - timestampset '{2000-01-01, 2000-01-02}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00), [2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-02],[2000-01-04, 2000-01-05]}' - timestampset '{2000-01-03, 2000-01-06}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-01],[2000-01-02, 2000-01-02]}' - timestampset '{2000-01-01, 2000-01-02, 2000-01-03}';
 ?column? 
----------
 
(1 row)

SELECT periodset '{[2000-01-02, 2000-01-04],[2000-01-06, 2000-01-06]}' - timestampset '{2000-01-01, 2000-01-05}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-02 00:00:00+00, 2000-01-04 00:00:00+00], [2000-01-06 00:00:00+00, 2000-01-06 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-02),[2000-01-03, 2000-01-04)}' - timestampset '{2000-01-02, 2000-01-04, 2000-01-05}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00), [2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-02),[2000-01-03, 2000-01-04]}' - timestampset '{2000-01-02, 2000-01-04, 2000-01-05}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00), [2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' - period '[2000-01-01, 2000-01-03]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03]}' - period '[2000-01-01, 2000-01-03]';
 ?column? 
----------
 
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' - periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' - periodset '{[2000-01-04, 2000-01-05]}';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' - periodset '{[2000-01-01, 2000-01-03]}';
                      ?column?                      
----------------------------------------------------
 {[2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-01' * timestamptz '2000-01-01';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-01' * timestamptz '2000-01-02';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-01' * timestampset '{2000-01-02, 2000-01-03, 2000-01-05}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-01' * timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-05' * timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
        ?column?        
------------------------
 2000-01-05 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-06' * timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-01' * period '[2000-01-02, 2000-01-03]';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-01' * period '[2000-01-01, 2000-01-03]';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-01' * period '(2000-01-01, 2000-01-03]';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-02' * period '[2000-01-01, 2000-01-03]';
        ?column?        
------------------------
 2000-01-02 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-03' * period '[2000-01-01, 2000-01-03]';
        ?column?        
------------------------
 2000-01-03 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-03' * period '[2000-01-01, 2000-01-03)';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-05' * period '[2000-01-01, 2000-01-03]';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-01' * periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-01' * periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-03' * periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
        ?column?        
------------------------
 2000-01-03 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-04' * periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
        ?column?        
------------------------
 2000-01-04 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-04' * periodset '{[2000-01-02, 2000-01-03],[2000-01-05, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT timestamptz '2000-01-05' * periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
        ?column?        
------------------------
 2000-01-05 00:00:00+00
(1 row)

SELECT timestamptz '2000-01-06' * periodset '{[2000-01-02, 2000-01-03],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' * timestamptz '2000-01-01';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' * timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                 ?column?                                 
--------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' * timestampset '{2000-01-03, 2000-01-05, 2000-01-07}';
                     ?column?                     
--------------------------------------------------
 {2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03}' * timestampset '{2000-01-02, 2000-01-04}';
 ?column? 
----------
 
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' * period '[2000-01-01, 2000-01-03]';
                     ?column?                     
--------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-03, 2000-01-05}' * periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                 ?column?                                 
--------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-04, 2000-01-07}' * periodset '{[2000-01-02, 2000-01-03],[2000-01-05, 2000-01-06]}';
 ?column? 
----------
 
(1 row)

SELECT timestampset '{2000-01-01,2000-01-03}' * periodset '{[2000-01-01,2000-01-02],[2000-01-04,2000-01-05]}';
         ?column?         
--------------------------
 {2000-01-01 00:00:00+00}
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-04, 2000-01-07}' * periodset '{[2000-01-02, 2000-01-03],[2000-01-05, 2000-01-06]}';
 ?column? 
----------
 
(1 row)

SELECT timestampset '{2000-01-03, 2000-01-06}' * periodset '{[2000-01-01, 2000-01-02],[2000-01-04, 2000-01-05]}';
 ?column? 
----------
 
(1 row)

SELECT timestampset '{2000-01-01, 2000-01-04}' * periodset '{(2000-01-01, 2000-01-03]}';
 ?column? 
----------
 
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' * timestamptz '2000-01-01';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' * timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                     ?column?                     
--------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00}
(1 row)

SELECT period '(2000-01-01, 2000-01-03]' * timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
         ?column?         
--------------------------
 {2000-01-03 00:00:00+00}
(1 row)

SELECT period '[2000-01-01, 2000-01-03)' * timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
         ?column?         
--------------------------
 {2000-01-01 00:00:00+00}
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' * period '[2000-01-01, 2000-01-03]';
                     ?column?                     
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' * period '(2000-01-03, 2000-01-05]';
 ?column? 
----------
 
(1 row)

SELECT period '[2000-01-01, 2000-01-03]' * periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT period '[2000-01-03, 2000-01-04]' * periodset '{[2000-01-01, 2000-01-02],[2000-01-05, 2000-01-06]}';
 ?column? 
----------
 
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' * timestamptz '2000-01-01';
        ?column?        
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' * timestampset '{2000-01-01, 2000-01-03, 2000-01-05}';
                                 ?column?                                 
--------------------------------------------------------------------------
 {2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00, 2000-01-05 00:00:00+00}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' * period '[2000-01-01, 2000-01-03]';
                      ?column?                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-02],[2000-01-03, 2000-01-04]}' * period '[2000-01-01, 2000-01-04]';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00], [2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}' * periodset '{[2000-01-01, 2000-01-03],[2000-01-04, 2000-01-05]}';
                                               ?column?                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}
(1 row)

SELECT periodset '{[2000-01-03, 2000-01-04],[2000-01-07, 2000-01-08]}' * periodset '{[2000-01-01, 2000-01-02],[2000-01-05, 2000-01-06]}';
 ?column? 
----------
 
(1 row)

