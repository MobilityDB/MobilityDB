select memSize(periodset '{[2000-01-01,2000-01-01]}');
 memsize 
---------
      72
(1 row)

select memSize(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 memsize 
---------
     136
(1 row)

select memSize(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 memsize 
---------
     136
(1 row)

select memSize(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 memsize 
---------
     136
(1 row)

select memSize(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 memsize 
---------
     136
(1 row)

select memSize(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 memsize 
---------
     136
(1 row)

select timespan(periodset '{[2000-01-01,2000-01-01]}');
                     timespan                     
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]
(1 row)

select timespan(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                     timespan                     
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-04 00:00:00+00)
(1 row)

select timespan(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                     timespan                     
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

select timespan(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                     timespan                     
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

select timespan(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                     timespan                     
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-06 00:00:00+00]
(1 row)

select timespan(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                     timespan                     
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-06 00:00:00+00]
(1 row)

select duration(periodset '{[2000-01-01,2000-01-01]}');
 duration 
----------
 00:00:00
(1 row)

select duration(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 duration 
----------
 3 days
(1 row)

select duration(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 duration 
----------
 3 days
(1 row)

select duration(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 duration 
----------
 3 days
(1 row)

select duration(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 duration 
----------
 3 days
(1 row)

select duration(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 duration 
----------
 3 days
(1 row)

select numPeriods(periodset '{[2000-01-01,2000-01-01]}');
 numperiods 
------------
          1
(1 row)

select numPeriods(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 numperiods 
------------
          3
(1 row)

select numPeriods(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numperiods 
------------
          3
(1 row)

select numPeriods(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numperiods 
------------
          3
(1 row)

select numPeriods(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numperiods 
------------
          3
(1 row)

select numPeriods(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numperiods 
------------
          3
(1 row)

select startPeriod(periodset '{[2000-01-01,2000-01-01]}');
                   startperiod                    
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]
(1 row)

select startPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                   startperiod                    
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

select startPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                   startperiod                    
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

select startPeriod(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                   startperiod                    
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

select startPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                   startperiod                    
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

select startPeriod(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                   startperiod                    
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

select endPeriod(periodset '{[2000-01-01,2000-01-01]}');
                    endperiod                     
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]
(1 row)

select endPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                    endperiod                     
--------------------------------------------------
 (2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)
(1 row)

select endPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                    endperiod                     
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

select endPeriod(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                    endperiod                     
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

select endPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                    endperiod                     
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00]
(1 row)

select endPeriod(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                    endperiod                     
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00]
(1 row)

select periodN(periodset '{[2000-01-01,2000-01-01]}', 1);
                     periodn                      
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]
(1 row)

select periodN(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', 1);
                     periodn                      
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

select periodN(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 2);
                     periodn                      
--------------------------------------------------
 (2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)
(1 row)

select periodN(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 3);
                     periodn                      
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

select periodN(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 4);
 periodn 
---------
 
(1 row)

select periodN(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 0);
 periodn 
---------
 
(1 row)

select periods(periodset '{[2000-01-01,2000-01-01]}');
                       periods                        
------------------------------------------------------
 {"[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]"}
(1 row)

select periods(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"(2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)"}
(1 row)

select periods(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"(2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)","(2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)"}
(1 row)

select periods(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)","(2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)"}
(1 row)

select periods(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"(2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)","(2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00]"}
(1 row)

select periods(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)","(2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00]"}
(1 row)

select numTimestamps(periodset '{[2000-01-01,2000-01-01]}');
 numtimestamps 
---------------
             1
(1 row)

select numTimestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 numtimestamps 
---------------
             4
(1 row)

select numTimestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numtimestamps 
---------------
             6
(1 row)

select numTimestamps(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numtimestamps 
---------------
             6
(1 row)

select numTimestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numtimestamps 
---------------
             6
(1 row)

select numTimestamps(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numtimestamps 
---------------
             6
(1 row)

select startTimestamp(periodset '{[2000-01-01,2000-01-01]}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

select startTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

select startTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

select startTimestamp(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

select startTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

select startTimestamp(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

select endTimestamp(periodset '{[2000-01-01,2000-01-01]}');
      endtimestamp      
------------------------
 2000-01-01 00:00:00+00
(1 row)

select endTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
      endtimestamp      
------------------------
 2000-01-04 00:00:00+00
(1 row)

select endTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
      endtimestamp      
------------------------
 2000-01-06 00:00:00+00
(1 row)

select endTimestamp(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
      endtimestamp      
------------------------
 2000-01-06 00:00:00+00
(1 row)

select endTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
      endtimestamp      
------------------------
 2000-01-06 00:00:00+00
(1 row)

select endTimestamp(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
      endtimestamp      
------------------------
 2000-01-06 00:00:00+00
(1 row)

select timestampN(periodset '{[2000-01-01,2000-01-01]}', 1);
       timestampn       
------------------------
 2000-01-01 00:00:00+00
(1 row)

select timestampN(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', 1);
       timestampn       
------------------------
 2000-01-01 00:00:00+00
(1 row)

select timestampN(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 2);
       timestampn       
------------------------
 2000-01-02 00:00:00+00
(1 row)

select timestampN(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 3);
       timestampn       
------------------------
 2000-01-03 00:00:00+00
(1 row)

select timestampN(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 4);
       timestampn       
------------------------
 2000-01-04 00:00:00+00
(1 row)

select timestampN(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 0);
 timestampn 
------------
 
(1 row)

select timestamps(periodset '{[2000-01-01,2000-01-01]}');
         timestamps         
----------------------------
 {"2000-01-01 00:00:00+00"}
(1 row)

select timestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                                              timestamps                                               
-------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00"}
(1 row)

select timestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                       timestamps                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00","2000-01-05 00:00:00+00","2000-01-06 00:00:00+00"}
(1 row)

select timestamps(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                       timestamps                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00","2000-01-05 00:00:00+00","2000-01-06 00:00:00+00"}
(1 row)

select timestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                       timestamps                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00","2000-01-05 00:00:00+00","2000-01-06 00:00:00+00"}
(1 row)

select timestamps(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                       timestamps                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00","2000-01-05 00:00:00+00","2000-01-06 00:00:00+00"}
(1 row)

select shift(periodset '{[2000-01-01,2000-01-01]}', '5 min');
                       shift                        
----------------------------------------------------
 {[2000-01-01 00:05:00+00, 2000-01-01 00:05:00+00]}
(1 row)

select shift(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-02 00:05:00+00, 2000-01-03 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00)}
(1 row)

select shift(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00), (2000-01-05 00:05:00+00, 2000-01-06 00:05:00+00)}
(1 row)

select shift(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00), (2000-01-05 00:05:00+00, 2000-01-06 00:05:00+00)}
(1 row)

select shift(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00), (2000-01-05 00:05:00+00, 2000-01-06 00:05:00+00]}
(1 row)

select shift(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00), (2000-01-05 00:05:00+00, 2000-01-06 00:05:00+00]}
(1 row)

select periodset_cmp(periodset '{[2000-01-01,2000-01-01]}', periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 periodset_cmp 
---------------
            -1
(1 row)

select periodset '{[2000-01-01,2000-01-01]}' = periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 f
(1 row)

select periodset '{[2000-01-01,2000-01-01]}' <> periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 t
(1 row)

select periodset '{[2000-01-01,2000-01-01]}' < periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 t
(1 row)

select periodset '{[2000-01-01,2000-01-01]}' <= periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 t
(1 row)

select periodset '{[2000-01-01,2000-01-01]}' > periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 f
(1 row)

select periodset '{[2000-01-01,2000-01-01]}' >= periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 f
(1 row)

