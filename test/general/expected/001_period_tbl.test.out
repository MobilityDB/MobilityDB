COPY tbl_period TO '/tmp/tbl_period' (FORMAT BINARY);
COPY 100
DROP TABLE IF EXISTS tbl_period_tmp;
NOTICE:  table "tbl_period_tmp" does not exist, skipping
DROP TABLE
CREATE TABLE tbl_period_tmp AS TABLE tbl_period WITH NO DATA;
CREATE TABLE AS
COPY tbl_period_tmp FROM '/tmp/tbl_period' (FORMAT BINARY);
COPY 100
SELECT COUNT(*) FROM tbl_period t1, tbl_period_tmp t2 WHERE t1.k = t2.k AND t1.p <> t2.p;
 count 
-------
     0
(1 row)

DROP TABLE tbl_period_tmp;
DROP TABLE
SELECT MAX(duration(period(t, t + i))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT MAX(duration(period(t, t + i, true, true))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT MAX(duration(period(t, t + i, true, false))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT MAX(duration(period(t, t + i, false, true))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT MAX(duration(period(t, t + i, false, false))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT tstzrange(p) FROM tbl_period;
                      tstzrange                      
-----------------------------------------------------
 ("2001-04-26 07:11:00+00","2001-04-26 07:18:00+00"]
 ("2001-03-14 19:43:00+00","2001-03-14 19:51:00+00"]
 ["2001-06-10 20:47:00+00","2001-06-10 20:55:00+00")
 ("2001-05-24 14:46:00+00","2001-05-24 14:49:00+00"]
 ["2001-07-11 22:02:00+00","2001-07-11 22:06:00+00")
 ("2001-04-27 19:39:00+00","2001-04-27 19:41:00+00")
 ["2001-03-25 14:48:00+00","2001-03-25 14:49:00+00")
 ["2001-02-15 07:56:00+00","2001-02-15 07:58:00+00")
 ("2001-01-10 13:55:00+00","2001-01-10 13:59:00+00")
 ("2001-09-26 08:57:00+00","2001-09-26 09:06:00+00"]
 ["2001-06-11 20:32:00+00","2001-06-11 20:41:00+00")
 ("2001-10-28 01:53:00+00","2001-10-28 02:02:00+00")
 ["2001-02-23 05:50:00+00","2001-02-23 05:54:00+00")
 ["2001-12-12 23:42:00+00","2001-12-12 23:44:00+00")
 ["2001-06-06 16:00:00+00","2001-06-06 16:08:00+00")
 ("2001-06-28 04:16:00+00","2001-06-28 04:17:00+00")
 ["2001-12-08 16:37:00+00","2001-12-08 16:42:00+00")
 ("2001-10-17 01:24:00+00","2001-10-17 01:26:00+00"]
 ["2001-09-04 04:23:00+00","2001-09-04 04:27:00+00"]
 ["2001-05-16 17:56:00+00","2001-05-16 18:01:00+00")
 
 ["2001-05-26 04:17:00+00","2001-05-26 04:24:00+00")
 ("2001-08-16 16:19:00+00","2001-08-16 16:27:00+00")
 ("2001-01-15 03:35:00+00","2001-01-15 03:44:00+00"]
 ("2001-04-13 06:25:00+00","2001-04-13 06:27:00+00"]
 ["2001-07-15 07:04:00+00","2001-07-15 07:08:00+00")
 ["2001-08-13 12:50:00+00","2001-08-13 12:50:00+00"]
 ("2001-03-18 20:55:00+00","2001-03-18 21:03:00+00"]
 ["2001-06-29 19:08:00+00","2001-06-29 19:15:00+00")
 ("2001-08-30 05:21:00+00","2001-08-30 05:23:00+00")
 ("2001-09-17 08:55:00+00","2001-09-17 09:00:00+00")
 ("2001-08-08 07:51:00+00","2001-08-08 07:57:00+00")
 ("2001-05-02 16:54:00+00","2001-05-02 17:01:00+00"]
 ["2001-10-05 13:37:00+00","2001-10-05 13:41:00+00")
 ("2001-03-30 22:10:00+00","2001-03-30 22:13:00+00"]
 ("2001-12-07 04:42:00+00","2001-12-07 04:50:00+00"]
 ["2001-07-25 15:02:00+00","2001-07-25 15:05:00+00")
 ["2001-05-27 09:34:00+00","2001-05-27 09:34:00+00"]
 ["2001-03-06 19:10:00+00","2001-03-06 19:17:00+00"]
 ("2001-07-15 21:52:00+00","2001-07-15 21:54:00+00")
 ["2001-03-19 09:54:00+00","2001-03-19 09:54:00+00"]
 ["2001-04-26 13:46:00+00","2001-04-26 13:53:00+00")
 ("2001-01-23 09:23:00+00","2001-01-23 09:31:00+00")
 ("2001-05-17 09:27:00+00","2001-05-17 09:35:00+00"]
 ["2001-08-25 14:58:00+00","2001-08-25 15:00:00+00"]
 ("2001-04-03 03:50:00+00","2001-04-03 03:53:00+00")
 ("2001-04-04 03:38:00+00","2001-04-04 03:47:00+00")
 ("2001-03-11 15:48:00+00","2001-03-11 15:57:00+00")
 ["2001-04-26 01:52:00+00","2001-04-26 01:56:00+00"]
 ["2001-01-22 18:30:00+00","2001-01-22 18:31:00+00"]
 ["2001-01-20 02:40:00+00","2001-01-20 02:49:00+00")
 ("2001-11-13 18:05:00+00","2001-11-13 18:06:00+00"]
 ["2001-05-02 19:40:00+00","2001-05-02 19:47:00+00"]
 ["2001-01-30 19:10:00+00","2001-01-30 19:17:00+00"]
 ("2001-01-18 19:13:00+00","2001-01-18 19:20:00+00")
 ["2001-05-31 02:34:00+00","2001-05-31 02:41:00+00")
 ["2001-07-19 07:42:00+00","2001-07-19 07:45:00+00"]
 ("2001-11-10 12:08:00+00","2001-11-10 12:14:00+00")
 ["2001-07-13 01:15:00+00","2001-07-13 01:16:00+00"]
 ["2001-05-15 15:56:00+00","2001-05-15 15:56:00+00"]
 ["2001-08-16 15:44:00+00","2001-08-16 15:44:00+00"]
 ["2001-03-29 15:35:00+00","2001-03-29 15:41:00+00")
 ["2001-02-17 22:58:00+00","2001-02-17 23:06:00+00"]
 ["2001-03-08 15:44:00+00","2001-03-08 15:46:00+00"]
 ["2001-04-09 21:21:00+00","2001-04-09 21:30:00+00"]
 ["2001-09-07 12:41:00+00","2001-09-07 12:48:00+00")
 ("2001-06-21 13:54:00+00","2001-06-21 13:59:00+00")
 ("2001-12-07 19:29:00+00","2001-12-07 19:34:00+00"]
 ["2001-02-25 19:28:00+00","2001-02-25 19:35:00+00"]
 ["2001-01-21 13:52:00+00","2001-01-21 14:01:00+00"]
 ["2001-06-03 05:42:00+00","2001-06-03 05:47:00+00"]
 ["2001-11-19 14:46:00+00","2001-11-19 14:50:00+00")
 ["2001-09-17 22:13:00+00","2001-09-17 22:13:00+00"]
 ["2001-10-21 10:13:00+00","2001-10-21 10:13:00+00"]
 ["2001-12-26 11:34:00+00","2001-12-26 11:41:00+00"]
 ("2001-05-17 09:48:00+00","2001-05-17 09:55:00+00")
 ["2001-12-10 21:57:00+00","2001-12-10 22:05:00+00")
 ("2001-06-21 11:10:00+00","2001-06-21 11:12:00+00"]
 ("2001-04-23 21:56:00+00","2001-04-23 22:01:00+00"]
 ["2001-05-01 14:55:00+00","2001-05-01 15:03:00+00"]
 ("2001-06-12 04:42:00+00","2001-06-12 04:44:00+00")
 ("2001-11-02 14:13:00+00","2001-11-02 14:22:00+00")
 ["2001-12-29 20:53:00+00","2001-12-29 21:00:00+00"]
 ("2001-11-13 19:17:00+00","2001-11-13 19:26:00+00")
 ["2001-08-15 22:54:00+00","2001-08-15 23:02:00+00")
 ["2001-07-26 17:00:00+00","2001-07-26 17:08:00+00")
 ("2001-01-20 18:40:00+00","2001-01-20 18:48:00+00"]
 ["2001-04-30 10:04:00+00","2001-04-30 10:04:00+00"]
 ["2001-03-02 09:39:00+00","2001-03-02 09:39:00+00"]
 ("2001-08-31 21:52:00+00","2001-08-31 21:58:00+00"]
 ["2001-07-26 17:32:00+00","2001-07-26 17:34:00+00"]
 ["2001-11-20 23:14:00+00","2001-11-20 23:15:00+00"]
 ("2001-11-19 06:06:00+00","2001-11-19 06:11:00+00")
 ("2001-08-29 07:16:00+00","2001-08-29 07:18:00+00")
 ["2001-08-07 12:24:00+00","2001-08-07 12:33:00+00")
 ["2001-08-29 02:53:00+00","2001-08-29 02:54:00+00"]
 ("2001-07-02 23:14:00+00","2001-07-02 23:20:00+00"]
 ("2001-11-24 03:07:00+00","2001-11-24 03:14:00+00"]
 ("2001-06-17 08:09:00+00","2001-06-17 08:11:00+00"]
 ["2001-11-01 15:13:00+00","2001-11-01 15:21:00+00")
(100 rows)

SELECT period(r) FROM tbl_tstzrange;
                      period                      
--------------------------------------------------
 (2001-03-21 00:35:00+00, 2001-03-21 00:39:00+00]
 (2001-10-30 11:39:00+00, 2001-10-30 11:42:00+00]
 (2001-11-15 15:55:00+00, 2001-11-15 15:59:00+00)
 (2001-01-26 14:16:00+00, 2001-01-26 14:23:00+00]
 [2001-03-13 21:49:00+00, 2001-03-13 21:56:00+00]
 [2001-12-09 23:57:00+00, 2001-12-10 00:02:00+00)
 [2001-11-11 12:28:00+00, 2001-11-11 12:36:00+00)
 [2001-01-01 02:06:00+00, 2001-01-01 02:15:00+00]
 [2001-08-09 15:56:00+00, 2001-08-09 15:59:00+00)
 [2001-08-18 08:25:00+00, 2001-08-18 08:30:00+00)
 [2001-10-11 18:18:00+00, 2001-10-11 18:19:00+00)
 (2001-07-16 22:47:00+00, 2001-07-16 22:48:00+00]
 
 (2001-06-05 22:09:00+00, 2001-06-05 22:10:00+00)
 (2001-07-30 10:39:00+00, 2001-07-30 10:42:00+00]
 (2001-07-22 20:42:00+00, 2001-07-22 20:51:00+00]
 [2001-05-16 04:09:00+00, 2001-05-16 04:16:00+00)
 (2001-11-19 03:57:00+00, 2001-11-19 04:00:00+00]
 [2001-07-12 16:27:00+00, 2001-07-12 16:34:00+00)
 (2001-11-03 08:35:00+00, 2001-11-03 08:41:00+00]
 (2001-02-14 13:15:00+00, 2001-02-14 13:19:00+00)
 [2001-05-21 17:35:00+00, 2001-05-21 17:41:00+00)
 (2001-08-25 05:19:00+00, 2001-08-25 05:26:00+00)
 (2001-02-04 08:27:00+00, 2001-02-04 08:33:00+00)
 [2001-01-19 23:45:00+00, 2001-01-19 23:50:00+00)
 [2001-11-26 16:39:00+00, 2001-11-26 16:47:00+00]
 (2001-02-03 05:50:00+00, 2001-02-03 05:51:00+00]
 [2001-09-22 20:40:00+00, 2001-09-22 20:40:00+00]
 (2001-06-01 02:31:00+00, 2001-06-01 02:32:00+00]
 [2001-10-22 05:33:00+00, 2001-10-22 05:41:00+00]
 (2001-03-31 00:49:00+00, 2001-03-31 00:57:00+00]
 (2001-11-12 06:58:00+00, 2001-11-12 07:05:00+00)
 (2001-01-29 09:40:00+00, 2001-01-29 09:47:00+00)
 [2001-08-02 17:36:00+00, 2001-08-02 17:45:00+00)
 (2001-09-11 20:22:00+00, 2001-09-11 20:26:00+00]
 [2001-06-01 11:06:00+00, 2001-06-01 11:06:00+00]
 [2001-04-30 14:20:00+00, 2001-04-30 14:22:00+00]
 [2001-02-15 09:11:00+00, 2001-02-15 09:11:00+00]
 [2001-06-30 23:07:00+00, 2001-06-30 23:11:00+00)
 [2001-03-05 19:27:00+00, 2001-03-05 19:34:00+00]
 [2001-07-09 11:59:00+00, 2001-07-09 12:07:00+00]
 [2001-10-16 17:05:00+00, 2001-10-16 17:09:00+00)
 [2001-02-10 19:35:00+00, 2001-02-10 19:40:00+00]
 [2001-09-30 11:40:00+00, 2001-09-30 11:48:00+00)
 [2001-06-15 20:59:00+00, 2001-06-15 21:00:00+00]
 (2001-01-17 04:14:00+00, 2001-01-17 04:18:00+00]
 (2001-08-26 03:54:00+00, 2001-08-26 03:59:00+00)
 (2001-05-25 17:15:00+00, 2001-05-25 17:20:00+00)
 [2001-05-07 05:28:00+00, 2001-05-07 05:36:00+00]
 [2001-08-31 22:19:00+00, 2001-08-31 22:24:00+00]
 [2001-02-01 21:21:00+00, 2001-02-01 21:29:00+00]
 [2001-02-01 03:54:00+00, 2001-02-01 03:59:00+00)
 (2001-03-11 23:17:00+00, 2001-03-11 23:19:00+00)
 (2001-05-14 17:47:00+00, 2001-05-14 17:56:00+00)
 [2001-05-02 09:25:00+00, 2001-05-02 09:27:00+00)
 (2001-01-01 13:22:00+00, 2001-01-01 13:26:00+00)
 [2001-04-12 23:36:00+00, 2001-04-12 23:36:00+00]
 [2001-11-02 16:25:00+00, 2001-11-02 16:32:00+00]
 (2001-08-19 10:57:00+00, 2001-08-19 11:01:00+00)
 (2001-08-31 12:36:00+00, 2001-08-31 12:40:00+00)
 (2001-08-08 05:11:00+00, 2001-08-08 05:14:00+00]
 (2001-07-29 16:25:00+00, 2001-07-29 16:34:00+00)
 [2001-07-08 19:52:00+00, 2001-07-08 19:55:00+00]
 (2001-06-29 10:06:00+00, 2001-06-29 10:11:00+00)
 [2001-09-27 09:57:00+00, 2001-09-27 10:01:00+00]
 [2001-01-25 16:16:00+00, 2001-01-25 16:22:00+00)
 [2001-09-28 01:20:00+00, 2001-09-28 01:22:00+00]
 (2001-04-28 17:11:00+00, 2001-04-28 17:15:00+00)
 [2001-12-14 21:49:00+00, 2001-12-14 21:52:00+00]
 (2001-11-05 23:35:00+00, 2001-11-05 23:43:00+00]
 (2001-11-22 05:57:00+00, 2001-11-22 06:00:00+00]
 [2001-07-10 06:08:00+00, 2001-07-10 06:08:00+00]
 [2001-09-01 06:29:00+00, 2001-09-01 06:37:00+00)
 [2001-07-02 21:02:00+00, 2001-07-02 21:03:00+00]
 (2001-12-16 00:54:00+00, 2001-12-16 01:02:00+00]
 [2001-03-01 18:15:00+00, 2001-03-01 18:18:00+00)
 (2001-07-24 23:11:00+00, 2001-07-24 23:20:00+00]
 [2001-12-19 15:07:00+00, 2001-12-19 15:10:00+00]
 [2001-02-20 04:03:00+00, 2001-02-20 04:11:00+00)
 (2001-09-03 08:36:00+00, 2001-09-03 08:42:00+00]
 [2001-07-12 20:05:00+00, 2001-07-12 20:13:00+00)
 (2001-03-14 01:48:00+00, 2001-03-14 01:49:00+00]
 (2001-05-14 17:21:00+00, 2001-05-14 17:26:00+00)
 [2001-12-06 23:12:00+00, 2001-12-06 23:13:00+00]
 [2001-06-07 14:00:00+00, 2001-06-07 14:00:00+00]
 (2001-12-08 06:34:00+00, 2001-12-08 06:36:00+00)
 (2001-03-27 01:54:00+00, 2001-03-27 01:59:00+00]
 (2001-12-25 04:27:00+00, 2001-12-25 04:31:00+00]
 [2001-08-25 19:13:00+00, 2001-08-25 19:15:00+00]
 [2001-09-13 08:05:00+00, 2001-09-13 08:14:00+00)
 [2001-09-05 08:21:00+00, 2001-09-05 08:29:00+00)
 (2001-11-20 15:18:00+00, 2001-11-20 15:21:00+00]
 [2001-02-16 12:19:00+00, 2001-02-16 12:26:00+00)
 [2001-11-03 05:27:00+00, 2001-11-03 05:34:00+00]
 [2001-11-06 17:52:00+00, 2001-11-06 17:58:00+00)
 [2001-06-21 13:57:00+00, 2001-06-21 13:59:00+00]
 [2001-03-23 18:19:00+00, 2001-03-23 18:19:00+00]
 (2001-07-16 15:12:00+00, 2001-07-16 15:15:00+00]
 [2001-05-20 06:10:00+00, 2001-05-20 06:13:00+00]
 [2001-12-25 09:23:00+00, 2001-12-25 09:28:00+00)
(100 rows)

SELECT t::period FROM tbl_timestamptz;
                        t                         
--------------------------------------------------
 [2001-12-09 11:25:00+00, 2001-12-09 11:25:00+00]
 [2001-04-03 18:30:00+00, 2001-04-03 18:30:00+00]
 [2001-06-14 01:06:00+00, 2001-06-14 01:06:00+00]
 [2001-07-07 01:12:00+00, 2001-07-07 01:12:00+00]
 [2001-09-28 16:00:00+00, 2001-09-28 16:00:00+00]
 [2001-05-11 07:00:00+00, 2001-05-11 07:00:00+00]
 [2001-07-11 01:31:00+00, 2001-07-11 01:31:00+00]
 [2001-03-25 05:01:00+00, 2001-03-25 05:01:00+00]
 [2001-10-06 23:08:00+00, 2001-10-06 23:08:00+00]
 [2001-01-28 07:16:00+00, 2001-01-28 07:16:00+00]
 [2001-05-27 12:02:00+00, 2001-05-27 12:02:00+00]
 
 [2001-10-07 06:53:00+00, 2001-10-07 06:53:00+00]
 [2001-09-11 03:59:00+00, 2001-09-11 03:59:00+00]
 [2001-04-04 19:12:00+00, 2001-04-04 19:12:00+00]
 [2001-11-09 06:18:00+00, 2001-11-09 06:18:00+00]
 [2001-06-02 01:17:00+00, 2001-06-02 01:17:00+00]
 [2001-07-08 15:55:00+00, 2001-07-08 15:55:00+00]
 [2001-08-12 03:30:00+00, 2001-08-12 03:30:00+00]
 [2001-05-11 13:42:00+00, 2001-05-11 13:42:00+00]
 [2001-06-19 00:14:00+00, 2001-06-19 00:14:00+00]
 [2001-11-18 17:34:00+00, 2001-11-18 17:34:00+00]
 [2001-05-30 14:33:00+00, 2001-05-30 14:33:00+00]
 [2001-09-07 00:03:00+00, 2001-09-07 00:03:00+00]
 [2001-01-18 12:26:00+00, 2001-01-18 12:26:00+00]
 [2001-10-03 06:36:00+00, 2001-10-03 06:36:00+00]
 [2001-01-09 15:47:00+00, 2001-01-09 15:47:00+00]
 [2001-06-12 18:35:00+00, 2001-06-12 18:35:00+00]
 [2001-10-06 17:19:00+00, 2001-10-06 17:19:00+00]
 [2001-05-19 14:07:00+00, 2001-05-19 14:07:00+00]
 [2001-06-14 21:11:00+00, 2001-06-14 21:11:00+00]
 [2001-06-12 02:20:00+00, 2001-06-12 02:20:00+00]
 [2001-03-05 17:58:00+00, 2001-03-05 17:58:00+00]
 [2001-09-12 15:59:00+00, 2001-09-12 15:59:00+00]
 [2001-12-03 14:30:00+00, 2001-12-03 14:30:00+00]
 [2001-09-17 10:51:00+00, 2001-09-17 10:51:00+00]
 [2001-03-29 08:39:00+00, 2001-03-29 08:39:00+00]
 [2001-01-01 02:36:00+00, 2001-01-01 02:36:00+00]
 [2001-09-19 04:35:00+00, 2001-09-19 04:35:00+00]
 [2001-04-29 01:53:00+00, 2001-04-29 01:53:00+00]
 [2001-04-01 00:47:00+00, 2001-04-01 00:47:00+00]
 [2001-07-26 05:21:00+00, 2001-07-26 05:21:00+00]
 [2001-10-15 04:07:00+00, 2001-10-15 04:07:00+00]
 [2001-03-01 09:14:00+00, 2001-03-01 09:14:00+00]
 [2001-03-29 05:03:00+00, 2001-03-29 05:03:00+00]
 [2001-04-25 08:03:00+00, 2001-04-25 08:03:00+00]
 [2001-10-24 06:45:00+00, 2001-10-24 06:45:00+00]
 [2001-01-27 12:34:00+00, 2001-01-27 12:34:00+00]
 [2001-04-18 19:25:00+00, 2001-04-18 19:25:00+00]
 [2001-05-01 18:28:00+00, 2001-05-01 18:28:00+00]
 [2001-09-16 18:15:00+00, 2001-09-16 18:15:00+00]
 [2001-05-29 18:10:00+00, 2001-05-29 18:10:00+00]
 [2001-08-06 20:45:00+00, 2001-08-06 20:45:00+00]
 [2001-10-01 18:34:00+00, 2001-10-01 18:34:00+00]
 [2001-06-16 04:51:00+00, 2001-06-16 04:51:00+00]
 [2001-07-21 06:55:00+00, 2001-07-21 06:55:00+00]
 [2001-12-26 07:12:00+00, 2001-12-26 07:12:00+00]
 [2001-06-17 11:16:00+00, 2001-06-17 11:16:00+00]
 [2001-04-08 01:29:00+00, 2001-04-08 01:29:00+00]
 [2001-11-08 10:14:00+00, 2001-11-08 10:14:00+00]
 [2001-06-21 12:58:00+00, 2001-06-21 12:58:00+00]
 [2001-04-19 16:38:00+00, 2001-04-19 16:38:00+00]
 [2001-01-16 05:55:00+00, 2001-01-16 05:55:00+00]
 [2001-12-08 20:23:00+00, 2001-12-08 20:23:00+00]
 [2001-07-22 23:46:00+00, 2001-07-22 23:46:00+00]
 [2001-10-11 02:54:00+00, 2001-10-11 02:54:00+00]
 [2001-09-20 02:42:00+00, 2001-09-20 02:42:00+00]
 [2001-04-18 15:55:00+00, 2001-04-18 15:55:00+00]
 [2001-08-08 07:05:00+00, 2001-08-08 07:05:00+00]
 [2001-08-15 07:04:00+00, 2001-08-15 07:04:00+00]
 [2001-01-25 05:37:00+00, 2001-01-25 05:37:00+00]
 [2001-12-18 11:40:00+00, 2001-12-18 11:40:00+00]
 [2001-05-19 12:35:00+00, 2001-05-19 12:35:00+00]
 [2001-07-17 22:14:00+00, 2001-07-17 22:14:00+00]
 [2001-10-14 05:47:00+00, 2001-10-14 05:47:00+00]
 [2001-02-18 09:31:00+00, 2001-02-18 09:31:00+00]
 [2001-04-01 17:37:00+00, 2001-04-01 17:37:00+00]
 [2001-11-02 08:25:00+00, 2001-11-02 08:25:00+00]
 [2001-09-05 14:44:00+00, 2001-09-05 14:44:00+00]
 [2001-01-29 04:33:00+00, 2001-01-29 04:33:00+00]
 [2001-08-05 21:55:00+00, 2001-08-05 21:55:00+00]
 [2001-07-05 03:49:00+00, 2001-07-05 03:49:00+00]
 [2001-10-26 15:19:00+00, 2001-10-26 15:19:00+00]
 [2001-05-14 20:47:00+00, 2001-05-14 20:47:00+00]
 [2001-01-03 15:29:00+00, 2001-01-03 15:29:00+00]
 [2001-09-17 19:38:00+00, 2001-09-17 19:38:00+00]
 [2001-07-28 05:08:00+00, 2001-07-28 05:08:00+00]
 [2001-05-22 15:57:00+00, 2001-05-22 15:57:00+00]
 [2001-05-11 20:09:00+00, 2001-05-11 20:09:00+00]
 [2001-04-21 08:24:00+00, 2001-04-21 08:24:00+00]
 [2001-09-14 12:47:00+00, 2001-09-14 12:47:00+00]
 [2001-09-20 19:17:00+00, 2001-09-20 19:17:00+00]
 [2001-02-20 14:04:00+00, 2001-02-20 14:04:00+00]
 [2001-09-13 12:12:00+00, 2001-09-13 12:12:00+00]
 [2001-03-31 04:25:00+00, 2001-03-31 04:25:00+00]
 [2001-01-26 18:18:00+00, 2001-01-26 18:18:00+00]
 [2001-09-18 02:03:00+00, 2001-09-18 02:03:00+00]
 [2001-06-22 06:11:00+00, 2001-06-22 06:11:00+00]
 [2001-06-27 19:59:00+00, 2001-06-27 19:59:00+00]
 [2001-07-18 01:57:00+00, 2001-07-18 01:57:00+00]
(100 rows)

SELECT lower(p) FROM tbl_period;
         lower          
------------------------
 2001-04-26 07:11:00+00
 2001-03-14 19:43:00+00
 2001-06-10 20:47:00+00
 2001-05-24 14:46:00+00
 2001-07-11 22:02:00+00
 2001-04-27 19:39:00+00
 2001-03-25 14:48:00+00
 2001-02-15 07:56:00+00
 2001-01-10 13:55:00+00
 2001-09-26 08:57:00+00
 2001-06-11 20:32:00+00
 2001-10-28 01:53:00+00
 2001-02-23 05:50:00+00
 2001-12-12 23:42:00+00
 2001-06-06 16:00:00+00
 2001-06-28 04:16:00+00
 2001-12-08 16:37:00+00
 2001-10-17 01:24:00+00
 2001-09-04 04:23:00+00
 2001-05-16 17:56:00+00
 
 2001-05-26 04:17:00+00
 2001-08-16 16:19:00+00
 2001-01-15 03:35:00+00
 2001-04-13 06:25:00+00
 2001-07-15 07:04:00+00
 2001-08-13 12:50:00+00
 2001-03-18 20:55:00+00
 2001-06-29 19:08:00+00
 2001-08-30 05:21:00+00
 2001-09-17 08:55:00+00
 2001-08-08 07:51:00+00
 2001-05-02 16:54:00+00
 2001-10-05 13:37:00+00
 2001-03-30 22:10:00+00
 2001-12-07 04:42:00+00
 2001-07-25 15:02:00+00
 2001-05-27 09:34:00+00
 2001-03-06 19:10:00+00
 2001-07-15 21:52:00+00
 2001-03-19 09:54:00+00
 2001-04-26 13:46:00+00
 2001-01-23 09:23:00+00
 2001-05-17 09:27:00+00
 2001-08-25 14:58:00+00
 2001-04-03 03:50:00+00
 2001-04-04 03:38:00+00
 2001-03-11 15:48:00+00
 2001-04-26 01:52:00+00
 2001-01-22 18:30:00+00
 2001-01-20 02:40:00+00
 2001-11-13 18:05:00+00
 2001-05-02 19:40:00+00
 2001-01-30 19:10:00+00
 2001-01-18 19:13:00+00
 2001-05-31 02:34:00+00
 2001-07-19 07:42:00+00
 2001-11-10 12:08:00+00
 2001-07-13 01:15:00+00
 2001-05-15 15:56:00+00
 2001-08-16 15:44:00+00
 2001-03-29 15:35:00+00
 2001-02-17 22:58:00+00
 2001-03-08 15:44:00+00
 2001-04-09 21:21:00+00
 2001-09-07 12:41:00+00
 2001-06-21 13:54:00+00
 2001-12-07 19:29:00+00
 2001-02-25 19:28:00+00
 2001-01-21 13:52:00+00
 2001-06-03 05:42:00+00
 2001-11-19 14:46:00+00
 2001-09-17 22:13:00+00
 2001-10-21 10:13:00+00
 2001-12-26 11:34:00+00
 2001-05-17 09:48:00+00
 2001-12-10 21:57:00+00
 2001-06-21 11:10:00+00
 2001-04-23 21:56:00+00
 2001-05-01 14:55:00+00
 2001-06-12 04:42:00+00
 2001-11-02 14:13:00+00
 2001-12-29 20:53:00+00
 2001-11-13 19:17:00+00
 2001-08-15 22:54:00+00
 2001-07-26 17:00:00+00
 2001-01-20 18:40:00+00
 2001-04-30 10:04:00+00
 2001-03-02 09:39:00+00
 2001-08-31 21:52:00+00
 2001-07-26 17:32:00+00
 2001-11-20 23:14:00+00
 2001-11-19 06:06:00+00
 2001-08-29 07:16:00+00
 2001-08-07 12:24:00+00
 2001-08-29 02:53:00+00
 2001-07-02 23:14:00+00
 2001-11-24 03:07:00+00
 2001-06-17 08:09:00+00
 2001-11-01 15:13:00+00
(100 rows)

SELECT upper(p) FROM tbl_period;
         upper          
------------------------
 2001-04-26 07:18:00+00
 2001-03-14 19:51:00+00
 2001-06-10 20:55:00+00
 2001-05-24 14:49:00+00
 2001-07-11 22:06:00+00
 2001-04-27 19:41:00+00
 2001-03-25 14:49:00+00
 2001-02-15 07:58:00+00
 2001-01-10 13:59:00+00
 2001-09-26 09:06:00+00
 2001-06-11 20:41:00+00
 2001-10-28 02:02:00+00
 2001-02-23 05:54:00+00
 2001-12-12 23:44:00+00
 2001-06-06 16:08:00+00
 2001-06-28 04:17:00+00
 2001-12-08 16:42:00+00
 2001-10-17 01:26:00+00
 2001-09-04 04:27:00+00
 2001-05-16 18:01:00+00
 
 2001-05-26 04:24:00+00
 2001-08-16 16:27:00+00
 2001-01-15 03:44:00+00
 2001-04-13 06:27:00+00
 2001-07-15 07:08:00+00
 2001-08-13 12:50:00+00
 2001-03-18 21:03:00+00
 2001-06-29 19:15:00+00
 2001-08-30 05:23:00+00
 2001-09-17 09:00:00+00
 2001-08-08 07:57:00+00
 2001-05-02 17:01:00+00
 2001-10-05 13:41:00+00
 2001-03-30 22:13:00+00
 2001-12-07 04:50:00+00
 2001-07-25 15:05:00+00
 2001-05-27 09:34:00+00
 2001-03-06 19:17:00+00
 2001-07-15 21:54:00+00
 2001-03-19 09:54:00+00
 2001-04-26 13:53:00+00
 2001-01-23 09:31:00+00
 2001-05-17 09:35:00+00
 2001-08-25 15:00:00+00
 2001-04-03 03:53:00+00
 2001-04-04 03:47:00+00
 2001-03-11 15:57:00+00
 2001-04-26 01:56:00+00
 2001-01-22 18:31:00+00
 2001-01-20 02:49:00+00
 2001-11-13 18:06:00+00
 2001-05-02 19:47:00+00
 2001-01-30 19:17:00+00
 2001-01-18 19:20:00+00
 2001-05-31 02:41:00+00
 2001-07-19 07:45:00+00
 2001-11-10 12:14:00+00
 2001-07-13 01:16:00+00
 2001-05-15 15:56:00+00
 2001-08-16 15:44:00+00
 2001-03-29 15:41:00+00
 2001-02-17 23:06:00+00
 2001-03-08 15:46:00+00
 2001-04-09 21:30:00+00
 2001-09-07 12:48:00+00
 2001-06-21 13:59:00+00
 2001-12-07 19:34:00+00
 2001-02-25 19:35:00+00
 2001-01-21 14:01:00+00
 2001-06-03 05:47:00+00
 2001-11-19 14:50:00+00
 2001-09-17 22:13:00+00
 2001-10-21 10:13:00+00
 2001-12-26 11:41:00+00
 2001-05-17 09:55:00+00
 2001-12-10 22:05:00+00
 2001-06-21 11:12:00+00
 2001-04-23 22:01:00+00
 2001-05-01 15:03:00+00
 2001-06-12 04:44:00+00
 2001-11-02 14:22:00+00
 2001-12-29 21:00:00+00
 2001-11-13 19:26:00+00
 2001-08-15 23:02:00+00
 2001-07-26 17:08:00+00
 2001-01-20 18:48:00+00
 2001-04-30 10:04:00+00
 2001-03-02 09:39:00+00
 2001-08-31 21:58:00+00
 2001-07-26 17:34:00+00
 2001-11-20 23:15:00+00
 2001-11-19 06:11:00+00
 2001-08-29 07:18:00+00
 2001-08-07 12:33:00+00
 2001-08-29 02:54:00+00
 2001-07-02 23:20:00+00
 2001-11-24 03:14:00+00
 2001-06-17 08:11:00+00
 2001-11-01 15:21:00+00
(100 rows)

SELECT lower_inc(p) FROM tbl_period;
 lower_inc 
-----------
 f
 f
 t
 f
 t
 f
 t
 t
 f
 f
 t
 f
 t
 t
 t
 f
 t
 f
 t
 t
 
 t
 f
 f
 f
 t
 t
 f
 t
 f
 f
 f
 f
 t
 f
 f
 t
 t
 t
 f
 t
 t
 f
 f
 t
 f
 f
 f
 t
 t
 t
 f
 t
 t
 f
 t
 t
 f
 t
 t
 t
 t
 t
 t
 t
 t
 f
 f
 t
 t
 t
 t
 t
 t
 t
 f
 t
 f
 f
 t
 f
 f
 t
 f
 t
 t
 f
 t
 t
 f
 t
 t
 f
 f
 t
 t
 f
 f
 f
 t
(100 rows)

SELECT upper_inc(p) FROM tbl_period;
 upper_inc 
-----------
 t
 t
 f
 t
 f
 f
 f
 f
 f
 t
 f
 f
 f
 f
 f
 f
 f
 t
 t
 f
 
 f
 f
 t
 t
 f
 t
 t
 f
 f
 f
 f
 t
 f
 t
 t
 f
 t
 t
 f
 t
 f
 f
 t
 t
 f
 f
 f
 t
 t
 f
 t
 t
 t
 f
 f
 t
 f
 t
 t
 t
 f
 t
 t
 t
 f
 f
 t
 t
 t
 t
 f
 t
 t
 t
 f
 f
 t
 t
 t
 f
 f
 t
 f
 f
 f
 t
 t
 t
 t
 t
 t
 f
 f
 f
 t
 t
 t
 t
 f
(100 rows)

SELECT duration(p) FROM tbl_period;
 duration 
----------
 00:07:00
 00:08:00
 00:08:00
 00:03:00
 00:04:00
 00:02:00
 00:01:00
 00:02:00
 00:04:00
 00:09:00
 00:09:00
 00:09:00
 00:04:00
 00:02:00
 00:08:00
 00:01:00
 00:05:00
 00:02:00
 00:04:00
 00:05:00
 
 00:07:00
 00:08:00
 00:09:00
 00:02:00
 00:04:00
 00:00:00
 00:08:00
 00:07:00
 00:02:00
 00:05:00
 00:06:00
 00:07:00
 00:04:00
 00:03:00
 00:08:00
 00:03:00
 00:00:00
 00:07:00
 00:02:00
 00:00:00
 00:07:00
 00:08:00
 00:08:00
 00:02:00
 00:03:00
 00:09:00
 00:09:00
 00:04:00
 00:01:00
 00:09:00
 00:01:00
 00:07:00
 00:07:00
 00:07:00
 00:07:00
 00:03:00
 00:06:00
 00:01:00
 00:00:00
 00:00:00
 00:06:00
 00:08:00
 00:02:00
 00:09:00
 00:07:00
 00:05:00
 00:05:00
 00:07:00
 00:09:00
 00:05:00
 00:04:00
 00:00:00
 00:00:00
 00:07:00
 00:07:00
 00:08:00
 00:02:00
 00:05:00
 00:08:00
 00:02:00
 00:09:00
 00:07:00
 00:09:00
 00:08:00
 00:08:00
 00:08:00
 00:00:00
 00:00:00
 00:06:00
 00:02:00
 00:01:00
 00:05:00
 00:02:00
 00:09:00
 00:01:00
 00:06:00
 00:07:00
 00:02:00
 00:08:00
(100 rows)

SELECT shift(p, '5 min') FROM tbl_period;
                      shift                       
--------------------------------------------------
 (2001-04-26 07:16:00+00, 2001-04-26 07:23:00+00]
 (2001-03-14 19:48:00+00, 2001-03-14 19:56:00+00]
 [2001-06-10 20:52:00+00, 2001-06-10 21:00:00+00)
 (2001-05-24 14:51:00+00, 2001-05-24 14:54:00+00]
 [2001-07-11 22:07:00+00, 2001-07-11 22:11:00+00)
 (2001-04-27 19:44:00+00, 2001-04-27 19:46:00+00)
 [2001-03-25 14:53:00+00, 2001-03-25 14:54:00+00)
 [2001-02-15 08:01:00+00, 2001-02-15 08:03:00+00)
 (2001-01-10 14:00:00+00, 2001-01-10 14:04:00+00)
 (2001-09-26 09:02:00+00, 2001-09-26 09:11:00+00]
 [2001-06-11 20:37:00+00, 2001-06-11 20:46:00+00)
 (2001-10-28 01:58:00+00, 2001-10-28 02:07:00+00)
 [2001-02-23 05:55:00+00, 2001-02-23 05:59:00+00)
 [2001-12-12 23:47:00+00, 2001-12-12 23:49:00+00)
 [2001-06-06 16:05:00+00, 2001-06-06 16:13:00+00)
 (2001-06-28 04:21:00+00, 2001-06-28 04:22:00+00)
 [2001-12-08 16:42:00+00, 2001-12-08 16:47:00+00)
 (2001-10-17 01:29:00+00, 2001-10-17 01:31:00+00]
 [2001-09-04 04:28:00+00, 2001-09-04 04:32:00+00]
 [2001-05-16 18:01:00+00, 2001-05-16 18:06:00+00)
 
 [2001-05-26 04:22:00+00, 2001-05-26 04:29:00+00)
 (2001-08-16 16:24:00+00, 2001-08-16 16:32:00+00)
 (2001-01-15 03:40:00+00, 2001-01-15 03:49:00+00]
 (2001-04-13 06:30:00+00, 2001-04-13 06:32:00+00]
 [2001-07-15 07:09:00+00, 2001-07-15 07:13:00+00)
 [2001-08-13 12:55:00+00, 2001-08-13 12:55:00+00]
 (2001-03-18 21:00:00+00, 2001-03-18 21:08:00+00]
 [2001-06-29 19:13:00+00, 2001-06-29 19:20:00+00)
 (2001-08-30 05:26:00+00, 2001-08-30 05:28:00+00)
 (2001-09-17 09:00:00+00, 2001-09-17 09:05:00+00)
 (2001-08-08 07:56:00+00, 2001-08-08 08:02:00+00)
 (2001-05-02 16:59:00+00, 2001-05-02 17:06:00+00]
 [2001-10-05 13:42:00+00, 2001-10-05 13:46:00+00)
 (2001-03-30 22:15:00+00, 2001-03-30 22:18:00+00]
 (2001-12-07 04:47:00+00, 2001-12-07 04:55:00+00]
 [2001-07-25 15:07:00+00, 2001-07-25 15:10:00+00)
 [2001-05-27 09:39:00+00, 2001-05-27 09:39:00+00]
 [2001-03-06 19:15:00+00, 2001-03-06 19:22:00+00]
 (2001-07-15 21:57:00+00, 2001-07-15 21:59:00+00)
 [2001-03-19 09:59:00+00, 2001-03-19 09:59:00+00]
 [2001-04-26 13:51:00+00, 2001-04-26 13:58:00+00)
 (2001-01-23 09:28:00+00, 2001-01-23 09:36:00+00)
 (2001-05-17 09:32:00+00, 2001-05-17 09:40:00+00]
 [2001-08-25 15:03:00+00, 2001-08-25 15:05:00+00]
 (2001-04-03 03:55:00+00, 2001-04-03 03:58:00+00)
 (2001-04-04 03:43:00+00, 2001-04-04 03:52:00+00)
 (2001-03-11 15:53:00+00, 2001-03-11 16:02:00+00)
 [2001-04-26 01:57:00+00, 2001-04-26 02:01:00+00]
 [2001-01-22 18:35:00+00, 2001-01-22 18:36:00+00]
 [2001-01-20 02:45:00+00, 2001-01-20 02:54:00+00)
 (2001-11-13 18:10:00+00, 2001-11-13 18:11:00+00]
 [2001-05-02 19:45:00+00, 2001-05-02 19:52:00+00]
 [2001-01-30 19:15:00+00, 2001-01-30 19:22:00+00]
 (2001-01-18 19:18:00+00, 2001-01-18 19:25:00+00)
 [2001-05-31 02:39:00+00, 2001-05-31 02:46:00+00)
 [2001-07-19 07:47:00+00, 2001-07-19 07:50:00+00]
 (2001-11-10 12:13:00+00, 2001-11-10 12:19:00+00)
 [2001-07-13 01:20:00+00, 2001-07-13 01:21:00+00]
 [2001-05-15 16:01:00+00, 2001-05-15 16:01:00+00]
 [2001-08-16 15:49:00+00, 2001-08-16 15:49:00+00]
 [2001-03-29 15:40:00+00, 2001-03-29 15:46:00+00)
 [2001-02-17 23:03:00+00, 2001-02-17 23:11:00+00]
 [2001-03-08 15:49:00+00, 2001-03-08 15:51:00+00]
 [2001-04-09 21:26:00+00, 2001-04-09 21:35:00+00]
 [2001-09-07 12:46:00+00, 2001-09-07 12:53:00+00)
 (2001-06-21 13:59:00+00, 2001-06-21 14:04:00+00)
 (2001-12-07 19:34:00+00, 2001-12-07 19:39:00+00]
 [2001-02-25 19:33:00+00, 2001-02-25 19:40:00+00]
 [2001-01-21 13:57:00+00, 2001-01-21 14:06:00+00]
 [2001-06-03 05:47:00+00, 2001-06-03 05:52:00+00]
 [2001-11-19 14:51:00+00, 2001-11-19 14:55:00+00)
 [2001-09-17 22:18:00+00, 2001-09-17 22:18:00+00]
 [2001-10-21 10:18:00+00, 2001-10-21 10:18:00+00]
 [2001-12-26 11:39:00+00, 2001-12-26 11:46:00+00]
 (2001-05-17 09:53:00+00, 2001-05-17 10:00:00+00)
 [2001-12-10 22:02:00+00, 2001-12-10 22:10:00+00)
 (2001-06-21 11:15:00+00, 2001-06-21 11:17:00+00]
 (2001-04-23 22:01:00+00, 2001-04-23 22:06:00+00]
 [2001-05-01 15:00:00+00, 2001-05-01 15:08:00+00]
 (2001-06-12 04:47:00+00, 2001-06-12 04:49:00+00)
 (2001-11-02 14:18:00+00, 2001-11-02 14:27:00+00)
 [2001-12-29 20:58:00+00, 2001-12-29 21:05:00+00]
 (2001-11-13 19:22:00+00, 2001-11-13 19:31:00+00)
 [2001-08-15 22:59:00+00, 2001-08-15 23:07:00+00)
 [2001-07-26 17:05:00+00, 2001-07-26 17:13:00+00)
 (2001-01-20 18:45:00+00, 2001-01-20 18:53:00+00]
 [2001-04-30 10:09:00+00, 2001-04-30 10:09:00+00]
 [2001-03-02 09:44:00+00, 2001-03-02 09:44:00+00]
 (2001-08-31 21:57:00+00, 2001-08-31 22:03:00+00]
 [2001-07-26 17:37:00+00, 2001-07-26 17:39:00+00]
 [2001-11-20 23:19:00+00, 2001-11-20 23:20:00+00]
 (2001-11-19 06:11:00+00, 2001-11-19 06:16:00+00)
 (2001-08-29 07:21:00+00, 2001-08-29 07:23:00+00)
 [2001-08-07 12:29:00+00, 2001-08-07 12:38:00+00)
 [2001-08-29 02:58:00+00, 2001-08-29 02:59:00+00]
 (2001-07-02 23:19:00+00, 2001-07-02 23:25:00+00]
 (2001-11-24 03:12:00+00, 2001-11-24 03:19:00+00]
 (2001-06-17 08:14:00+00, 2001-06-17 08:16:00+00]
 [2001-11-01 15:18:00+00, 2001-11-01 15:26:00+00)
(100 rows)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE period_cmp(t1.p, t2.p) = -1;
 count 
-------
  4851
(1 row)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE t1.p < t2.p;
 count 
-------
  4851
(1 row)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE t1.p <= t2.p;
 count 
-------
  4950
(1 row)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE t1.p > t2.p;
 count 
-------
  4851
(1 row)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE t1.p >= t2.p;
 count 
-------
  4950
(1 row)

SELECT MAX(period_hash(p)) FROM tbl_period;
    max     
------------
 2061847155
(1 row)

SELECT MAX(period_hash_extended(p, 1)) FROM tbl_period;
         max         
---------------------
 8610851091865939261
(1 row)

