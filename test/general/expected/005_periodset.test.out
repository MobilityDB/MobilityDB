SELECT periodset '{[2000-01-01, 2000-01-02), [2000-01-03, 2000-01-04)}';
                                              periodset                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00), [2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

SELECT periodset '{[2000-01-01, 2000-01-02), [2000-01-02, 2000-01-03), [2000-01-03, 2000-01-04)}';
                     periodset                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-04 00:00:00+00)}
(1 row)

/* Errors */
SELECT periodset '2000-01-01, 2000-01-02';
ERROR:  Could not parse period set
LINE 2: SELECT periodset '2000-01-01, 2000-01-02';
                         ^
SELECT periodset '{[2000-01-01, 2000-01-02]';
ERROR:  Could not parse period set
LINE 1: SELECT periodset '{[2000-01-01, 2000-01-02]';
                         ^
SELECT periodset(ARRAY [period '[2000-01-01, 2000-01-02]', '[2000-01-03,2000-01-04]']);
                                              periodset                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00], [2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00]}
(1 row)

/* Errors */
SELECT periodset(ARRAY [period '[2000-01-01, 2000-01-03]', '[2000-01-02,2000-01-04]']);
ERROR:  Invalid value for period set
SELECT periodset('{}'::period[]);
ERROR:  The input array cannot be empty
SELECT periodset(timestamptz '2000-01-01');
                     periodset                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]}
(1 row)

SELECT periodset(timestampset '{2000-01-01,2000-01-02}');
                                              periodset                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00], [2000-01-02 00:00:00+00, 2000-01-02 00:00:00+00]}
(1 row)

SELECT periodset(period '[2000-01-01,2000-01-02]');
                     periodset                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00]}
(1 row)

SELECT timestamptz '2000-01-01'::periodset;
                     periodset                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]}
(1 row)

SELECT timestampset '{2000-01-01,2000-01-02}'::periodset;
                                              periodset                                               
------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00], [2000-01-02 00:00:00+00, 2000-01-02 00:00:00+00]}
(1 row)

SELECT period '[2000-01-01,2000-01-02]'::periodset;
                     periodset                      
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00]}
(1 row)

SELECT memSize(periodset '{[2000-01-01,2000-01-01]}');
 memsize 
---------
      56
(1 row)

SELECT memSize(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 memsize 
---------
     104
(1 row)

SELECT memSize(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 memsize 
---------
     104
(1 row)

SELECT memSize(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 memsize 
---------
     104
(1 row)

SELECT memSize(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 memsize 
---------
     104
(1 row)

SELECT memSize(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 memsize 
---------
     104
(1 row)

SELECT period(periodset '{[2000-01-01,2000-01-01]}');
                      period                      
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]
(1 row)

SELECT period(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                      period                      
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-04 00:00:00+00)
(1 row)

SELECT period(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                      period                      
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

SELECT period(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                      period                      
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

SELECT period(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                      period                      
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-06 00:00:00+00]
(1 row)

SELECT period(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                      period                      
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-06 00:00:00+00]
(1 row)

SELECT timespan(periodset '{[2000-01-01,2000-01-01]}');
 timespan 
----------
 00:00:00
(1 row)

SELECT timespan(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 timespan 
----------
 3 days
(1 row)

SELECT timespan(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 timespan 
----------
 5 days
(1 row)

SELECT timespan(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 timespan 
----------
 5 days
(1 row)

SELECT timespan(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 timespan 
----------
 5 days
(1 row)

SELECT timespan(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 timespan 
----------
 5 days
(1 row)

SELECT duration(periodset '{[2000-01-01,2000-01-01]}');
 duration 
----------
 00:00:00
(1 row)

SELECT duration(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 duration 
----------
 3 days
(1 row)

SELECT duration(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 duration 
----------
 3 days
(1 row)

SELECT duration(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 duration 
----------
 3 days
(1 row)

SELECT duration(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 duration 
----------
 3 days
(1 row)

SELECT duration(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 duration 
----------
 3 days
(1 row)

SELECT numPeriods(periodset '{[2000-01-01,2000-01-01]}');
 numperiods 
------------
          1
(1 row)

SELECT numPeriods(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 numperiods 
------------
          3
(1 row)

SELECT numPeriods(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numperiods 
------------
          3
(1 row)

SELECT numPeriods(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numperiods 
------------
          3
(1 row)

SELECT numPeriods(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numperiods 
------------
          3
(1 row)

SELECT numPeriods(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numperiods 
------------
          3
(1 row)

SELECT startPeriod(periodset '{[2000-01-01,2000-01-01]}');
                   startperiod                    
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]
(1 row)

SELECT startPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                   startperiod                    
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

SELECT startPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                   startperiod                    
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

SELECT startPeriod(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                   startperiod                    
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

SELECT startPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                   startperiod                    
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

SELECT startPeriod(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                   startperiod                    
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

SELECT endPeriod(periodset '{[2000-01-01,2000-01-01]}');
                    endperiod                     
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]
(1 row)

SELECT endPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                    endperiod                     
--------------------------------------------------
 (2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)
(1 row)

SELECT endPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                    endperiod                     
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

SELECT endPeriod(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                    endperiod                     
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

SELECT endPeriod(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                    endperiod                     
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00]
(1 row)

SELECT endPeriod(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                    endperiod                     
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00]
(1 row)

SELECT periodN(periodset '{[2000-01-01,2000-01-01]}', 1);
                     periodn                      
--------------------------------------------------
 [2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]
(1 row)

SELECT periodN(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', 1);
                     periodn                      
--------------------------------------------------
 (2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)
(1 row)

SELECT periodN(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 2);
                     periodn                      
--------------------------------------------------
 (2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)
(1 row)

SELECT periodN(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 3);
                     periodn                      
--------------------------------------------------
 (2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)
(1 row)

SELECT periodN(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 4);
 periodn 
---------
 
(1 row)

SELECT periodN(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 0);
 periodn 
---------
 
(1 row)

SELECT periods(periodset '{[2000-01-01,2000-01-01]}');
                       periods                        
------------------------------------------------------
 {"[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]"}
(1 row)

SELECT periods(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"(2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-02 00:00:00+00, 2000-01-03 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)"}
(1 row)

SELECT periods(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"(2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)","(2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)"}
(1 row)

SELECT periods(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)","(2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00)"}
(1 row)

SELECT periods(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"(2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)","(2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00]"}
(1 row)

SELECT periods(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                          periods                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[2000-01-01 00:00:00+00, 2000-01-02 00:00:00+00)","(2000-01-03 00:00:00+00, 2000-01-04 00:00:00+00)","(2000-01-05 00:00:00+00, 2000-01-06 00:00:00+00]"}
(1 row)

SELECT numTimestamps(periodset '{[2000-01-01,2000-01-01]}');
 numtimestamps 
---------------
             1
(1 row)

SELECT numTimestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 numtimestamps 
---------------
             4
(1 row)

SELECT numTimestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numtimestamps 
---------------
             6
(1 row)

SELECT numTimestamps(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numtimestamps 
---------------
             6
(1 row)

SELECT numTimestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numtimestamps 
---------------
             6
(1 row)

SELECT numTimestamps(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numtimestamps 
---------------
             6
(1 row)

SELECT startTimestamp(periodset '{[2000-01-01,2000-01-01]}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT startTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT startTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT startTimestamp(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT startTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT startTimestamp(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
     starttimestamp     
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT endTimestamp(periodset '{[2000-01-01,2000-01-01]}');
      endtimestamp      
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT endTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
      endtimestamp      
------------------------
 2000-01-04 00:00:00+00
(1 row)

SELECT endTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
      endtimestamp      
------------------------
 2000-01-06 00:00:00+00
(1 row)

SELECT endTimestamp(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
      endtimestamp      
------------------------
 2000-01-06 00:00:00+00
(1 row)

SELECT endTimestamp(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
      endtimestamp      
------------------------
 2000-01-06 00:00:00+00
(1 row)

SELECT endTimestamp(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
      endtimestamp      
------------------------
 2000-01-06 00:00:00+00
(1 row)

SELECT timestampN(periodset '{[2000-01-01,2000-01-01]}', 1);
       timestampn       
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestampN(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', 1);
       timestampn       
------------------------
 2000-01-01 00:00:00+00
(1 row)

SELECT timestampN(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 2);
       timestampn       
------------------------
 2000-01-02 00:00:00+00
(1 row)

SELECT timestampN(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 3);
       timestampn       
------------------------
 2000-01-03 00:00:00+00
(1 row)

SELECT timestampN(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 4);
       timestampn       
------------------------
 2000-01-04 00:00:00+00
(1 row)

SELECT timestampN(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 0);
 timestampn 
------------
 
(1 row)

SELECT timestampN(periodset '{[2000-01-01,2000-01-01],[2000-01-02,2000-01-02]}',3);
 timestampn 
------------
 
(1 row)

SELECT timestamps(periodset '{[2000-01-01,2000-01-01]}');
         timestamps         
----------------------------
 {"2000-01-01 00:00:00+00"}
(1 row)

SELECT timestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                                              timestamps                                               
-------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00"}
(1 row)

SELECT timestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                       timestamps                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00","2000-01-05 00:00:00+00","2000-01-06 00:00:00+00"}
(1 row)

SELECT timestamps(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                       timestamps                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00","2000-01-05 00:00:00+00","2000-01-06 00:00:00+00"}
(1 row)

SELECT timestamps(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                       timestamps                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00","2000-01-05 00:00:00+00","2000-01-06 00:00:00+00"}
(1 row)

SELECT timestamps(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                       timestamps                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 {"2000-01-01 00:00:00+00","2000-01-02 00:00:00+00","2000-01-03 00:00:00+00","2000-01-04 00:00:00+00","2000-01-05 00:00:00+00","2000-01-06 00:00:00+00"}
(1 row)

SELECT shift(periodset '{[2000-01-01,2000-01-01]}', '5 min');
                       shift                        
----------------------------------------------------
 {[2000-01-01 00:05:00+00, 2000-01-01 00:05:00+00]}
(1 row)

SELECT shift(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-02 00:05:00+00, 2000-01-03 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00)}
(1 row)

SELECT shift(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00), (2000-01-05 00:05:00+00, 2000-01-06 00:05:00+00)}
(1 row)

SELECT shift(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00), (2000-01-05 00:05:00+00, 2000-01-06 00:05:00+00)}
(1 row)

SELECT shift(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00), (2000-01-05 00:05:00+00, 2000-01-06 00:05:00+00]}
(1 row)

SELECT shift(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min');
                                                                         shift                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:05:00+00, 2000-01-02 00:05:00+00), (2000-01-03 00:05:00+00, 2000-01-04 00:05:00+00), (2000-01-05 00:05:00+00, 2000-01-06 00:05:00+00]}
(1 row)

SELECT tscale(periodset '{[2000-01-01,2000-01-01]}', '1 hour');
                       tscale                       
----------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]}
(1 row)

SELECT tscale(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', '1 hour');
                                                                         tscale                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-01 00:20:00+00), (2000-01-01 00:20:00+00, 2000-01-01 00:40:00+00), (2000-01-01 00:40:00+00, 2000-01-01 01:00:00+00)}
(1 row)

SELECT tscale(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '1 hour');
                                                                         tscale                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-01 00:12:00+00), (2000-01-01 00:24:00+00, 2000-01-01 00:36:00+00), (2000-01-01 00:48:00+00, 2000-01-01 01:00:00+00)}
(1 row)

SELECT tscale(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '1 hour');
                                                                         tscale                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-01 00:12:00+00), (2000-01-01 00:24:00+00, 2000-01-01 00:36:00+00), (2000-01-01 00:48:00+00, 2000-01-01 01:00:00+00)}
(1 row)

SELECT tscale(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '1 hour');
                                                                         tscale                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:00:00+00, 2000-01-01 00:12:00+00), (2000-01-01 00:24:00+00, 2000-01-01 00:36:00+00), (2000-01-01 00:48:00+00, 2000-01-01 01:00:00+00]}
(1 row)

SELECT tscale(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '1 hour');
                                                                         tscale                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:00:00+00, 2000-01-01 00:12:00+00), (2000-01-01 00:24:00+00, 2000-01-01 00:36:00+00), (2000-01-01 00:48:00+00, 2000-01-01 01:00:00+00]}
(1 row)

SELECT shiftTscale(periodset '{[2000-01-01,2000-01-01]}', '5 min', '1 hour');
                    shifttscale                     
----------------------------------------------------
 {[2000-01-01 00:05:00+00, 2000-01-01 00:05:00+00]}
(1 row)

SELECT shiftTscale(periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', '5 min', '1 hour');
                                                                      shifttscale                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:05:00+00, 2000-01-01 00:25:00+00), (2000-01-01 00:25:00+00, 2000-01-01 00:45:00+00), (2000-01-01 00:45:00+00, 2000-01-01 01:05:00+00)}
(1 row)

SELECT shiftTscale(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min', '1 hour');
                                                                      shifttscale                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:05:00+00, 2000-01-01 00:17:00+00), (2000-01-01 00:29:00+00, 2000-01-01 00:41:00+00), (2000-01-01 00:53:00+00, 2000-01-01 01:05:00+00)}
(1 row)

SELECT shiftTscale(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min', '1 hour');
                                                                      shifttscale                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:05:00+00, 2000-01-01 00:17:00+00), (2000-01-01 00:29:00+00, 2000-01-01 00:41:00+00), (2000-01-01 00:53:00+00, 2000-01-01 01:05:00+00)}
(1 row)

SELECT shiftTscale(periodset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min', '1 hour');
                                                                      shifttscale                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {(2000-01-01 00:05:00+00, 2000-01-01 00:17:00+00), (2000-01-01 00:29:00+00, 2000-01-01 00:41:00+00), (2000-01-01 00:53:00+00, 2000-01-01 01:05:00+00]}
(1 row)

SELECT shiftTscale(periodset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min', '1 hour');
                                                                      shifttscale                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------
 {[2000-01-01 00:05:00+00, 2000-01-01 00:17:00+00), (2000-01-01 00:29:00+00, 2000-01-01 00:41:00+00), (2000-01-01 00:53:00+00, 2000-01-01 01:05:00+00]}
(1 row)

SELECT periodset_cmp(periodset '{[2000-01-01,2000-01-01]}', periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 periodset_cmp 
---------------
            -1
(1 row)

SELECT periodset '{[2000-01-01,2000-01-01]}' = periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 f
(1 row)

SELECT periodset '{[2000-01-01,2000-01-01]}' <> periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 t
(1 row)

SELECT periodset '{[2000-01-01,2000-01-01]}' < periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 t
(1 row)

SELECT periodset '{[2000-01-01,2000-01-02]}' < periodset '{[2000-01-01,2000-01-02],[2000-01-03,2000-01-04]}';
 ?column? 
----------
 t
(1 row)

SELECT periodset '{[2000-01-01,2000-01-02],[2000-01-03,2000-01-04]}' < periodset '{[2000-01-01,2000-01-02]}';
 ?column? 
----------
 f
(1 row)

SELECT periodset '{[2000-01-01,2000-01-01]}' <= periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 t
(1 row)

SELECT periodset '{[2000-01-01,2000-01-01]}' > periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 f
(1 row)

SELECT periodset '{[2000-01-01,2000-01-01]}' >= periodset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 f
(1 row)

SELECT periodset_hash('{[2000-01-01,2000-01-02]}') = periodset_hash('{[2000-01-01,2000-01-02]}');
 ?column? 
----------
 t
(1 row)

SELECT periodset_hash('{[2000-01-01,2000-01-02]}') <> periodset_hash('{[2000-01-02,2000-01-02]}');
 ?column? 
----------
 t
(1 row)

SELECT periodset_hash_extended('{[2000-01-01,2000-01-02]}', 1) = periodset_hash_extended('{[2000-01-01,2000-01-02]}', 1);
 ?column? 
----------
 t
(1 row)

SELECT periodset_hash_extended('{[2000-01-01,2000-01-02]}', 1) <> periodset_hash_extended('{[2000-01-02,2000-01-02]}', 1);
 ?column? 
----------
 t
(1 row)

