-------------------------------------------------------------------------------

select tbool ' { true@2001-01-01 08:00:00 , false@2001-01-01 08:05:00 , true@2001-01-01 08:06:00 } ';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}';

select tint ' { 1@2001-01-01 08:00:00 , 2@2001-01-01 08:05:00 , 3@2001-01-01 08:06:00 } ';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';

select tfloat ' { 1@2001-01-01 08:00:00 , 2@2001-01-01 08:05:00 , 3@2001-01-01 08:06:00 } ';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';

/*
-- Incorrect input format

select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:05:00}';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,empty@2001-01-01 08:06:00}';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@empty}';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00, 'abc'}';

select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:05:00}';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:04:00}';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,empty@2001-01-01 08:06:00}';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@empty}';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00, 'abc'}';

select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:05:00}';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:04:00}';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,empty@2001-01-01 08:06:00}';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@empty}';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00, 'abc'}';
*/
-- Constructors

select tbooli(ARRAY[ tboolinst 'true@2001-01-01 08:00:00', 'false@2001-01-01 08:05:00', 'true@2001-01-01 08:06:00']);
select tinti(ARRAY[ tintinst '1@2001-01-01 08:00:00', '2@2001-01-01 08:05:00', '3@2001-01-01 08:06:00']);
select tfloati(ARRAY[ tfloatinst '1@2001-01-01 08:00:00', '2@2001-01-01 08:05:00', '3@2001-01-01 08:06:00']);
select ttexti(ARRAY[
	ttextinst('AAA', '2001-01-01 08:00:00'),
	ttextinst('BBBB', '2001-01-04 08:00:00')
]);
-- Functions

select numInstants(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select numInstants(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select numInstants(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select startInstant(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select startInstant(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select startInstant(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select endInstant(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select endInstant(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select endInstant(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select instantN(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 0);
select instantN(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 0);
select instantN(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 0);

select instantN(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 2);
select instantN(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 2);
select instantN(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 2);

select instantN(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 4);
select instantN(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);
select instantN(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);

select instants(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select instants(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select instants(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select numTimestamps(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select numTimestamps(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select numTimestamps(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select startTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select startTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select startTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select endTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select endTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select endTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select timestampN(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 0);
select timestampN(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 0);
select timestampN(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 0);

select timestampN(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 2);
select timestampN(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 2);
select timestampN(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 2);

select timestampN(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 4);
select timestampN(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);
select timestampN(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);

select timestamps(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select timestamps(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select timestamps(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select getValues(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select getValues(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select getValues(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select minValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select minValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select maxValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select maxValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select startValue(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select startValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select startValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select endValue(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select endValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select endValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

select getTime(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}');
select getTime(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select getTime(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');

-- true
select everEquals(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', true);
select everEquals(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select everEquals(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
-- false
select everEquals(tbool '{true@2001-01-01 08:00:00,true@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', false);
select everEquals(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);
select everEquals(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);

select shift(tbool '{true@2001-01-01 08:00:00,
false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', interval '5 min');
select shift(tint '{1@2001-01-01 08:00:00,
2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', interval '5 min');
select shift(tfloat '{1@2001-01-01 08:00:00,
2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', interval '5 min');
select shift(ttext '{A@2001-01-01 08:00:00,
B@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', interval '5 min');

-- One
select atValue(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', false);
select atValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
select atValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 1);
-- Several
select atValue(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', true);
select atValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,1@2001-01-01 08:06:00}', 1);
select atValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,1@2001-01-01 08:06:00}', 1);
-- NULL
select atValue(tbool '{true@2001-01-01 08:00:00,true@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', false);
select atValue(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);
select atValue(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 4);

select atValues(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,1@2001-01-01 08:06:00}', 
	ARRAY[1,2,1]);
select atValues(tfloati(ARRAY[
tfloatinst(1, '2000-01-01 08:00'),
tfloatinst(3, '2000-01-01 08:10'),
tfloatinst(2, '2000-01-01 08:20'),
tfloatinst(2, '2000-01-01 08:30')
]),ARRAY[2,3]);

select atRange(
tfloati(ARRAY[
tfloatinst(1, '2000-01-01 08:00'),
tfloatinst(3, '2000-01-01 08:10'),
tfloatinst(2, '2000-01-01 08:20'),
tfloatinst(2, '2000-01-01 08:30')
]),
floatrange(1.5,2.1));

select minusRange(
tfloati(ARRAY[
tfloatinst(1, '2000-01-01 08:00'),
tfloatinst(3, '2000-01-01 08:10'),
tfloatinst(2, '2000-01-01 08:20'),
tfloatinst(2, '2000-01-01 08:30'),
tfloatinst(3, '2000-01-01 08:40')
]),
floatrange(1.5,2.1));


select atRanges(
tfloati(ARRAY[
tfloatinst(1, '2000-01-01 08:00'),
tfloatinst(3, '2000-01-01 08:10'),
tfloatinst(2, '2000-01-01 08:20'),
tfloatinst(2, '2000-01-01 08:30')
]),
ARRAY[floatrange(1.5,2.1),floatrange(1.5,2.1)]);

select minusRanges(
tfloati(ARRAY[
tfloatinst(1, '2000-01-01 08:00'),
tfloatinst(3, '2000-01-01 08:10'),
tfloatinst(2, '2000-01-01 08:20'),
tfloatinst(2, '2000-01-01 08:30')
]),
ARRAY[floatrange(1.5,2.1),floatrange(1.5,2.1)]);


-- One
select atMin(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select atMin(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
-- Several
select atMin(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,1@2001-01-01 08:06:00}');
select atMin(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,1@2001-01-01 08:06:00}');

-- One
select atMax(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
select atMax(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}');
-- Several
select atMax(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,2@2001-01-01 08:06:00}');
select atMax(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,2@2001-01-01 08:06:00}');

-- Values
select atTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '2001-01-01 08:05:00');
select atTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2001-01-01 08:05:00');
select atTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2001-01-01 08:05:00');
-- NULL
select atTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', '2001-01-01 08:15:00');
select atTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2001-01-01 08:15:00');
select atTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', '2001-01-01 08:15:00');

-- Values
select atTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:05:00', '2001-01-01 08:06:00', '2001-01-01 08:15:00']));
select atTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:05:00', '2001-01-01 08:06:00', '2001-01-01 08:15:00']));
select atTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:05:00', '2001-01-01 08:06:00', '2001-01-01 08:15:00']));
-- NULL
select atTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:10:00', '2001-01-01 08:15:00']));
select atTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:10:00', '2001-01-01 08:15:00']));
select atTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:10:00', '2001-01-01 08:15:00']));

select atTimestampSet(tfloati(ARRAY[
	tfloatinst(1, '2001-01-01 08:00:00'),
	tfloatinst(1, '2001-01-01 08:05:00'),
	tfloatinst(1, '2001-01-01 08:10:00')
	]),
	timestampset(ARRAY[timestamp '2001-01-01 08:10:00', '2001-01-01 08:05:00', '2001-01-01 08:08:00', '2001-01-01 08:05:00']));
select atTimestampSet(tfloati(ARRAY[
tfloatinst(1, '2000-01-01 08:00'),
tfloatinst(3, '2000-01-01 08:10'),
tfloatinst(2, '2000-01-01 08:20'),
tfloatinst(2, '2000-01-01 08:30')
]),
timestampset(ARRAY[timestamp '2000-01-01 08:10', '2000-01-01 08:20', '2000-01-01 08:10'])
);
	
-- Values
select atPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	period '[2001-01-01 08:00:00, 2001-01-01 08:05:00]');
select atPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	period '[2001-01-01 08:00:00, 2001-01-01 08:05:00]');
select atPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 	
	period '[2001-01-01 08:00:00, 2001-01-01 08:05:00]');
-- NULL
select atPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	period '[2001-01-01 08:10:00, 2001-01-01 08:15:00]');
select atPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	period '[2001-01-01 08:10:00, 2001-01-01 08:15:00]');
select atPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 	
	period '[2001-01-01 08:10:00, 2001-01-01 08:15:00]');

select minusPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}',
	period '[2001-01-01 08:00:00, 2001-01-01 08:06:00]');
select minusPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	period '[2001-01-01 08:00:00, 2001-01-01 08:05:00]');
select minusPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	period '[2001-01-01 08:00:00, 2001-01-01 08:05:00]');
select minusPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}',
	period '[2001-01-01 08:10:00, 2001-01-01 08:15:00]');
select minusPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	period '[2001-01-01 08:10:00, 2001-01-01 08:15:00]');
select minusPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	period '[2001-01-01 08:10:00, 2001-01-01 08:15:00]');

select atPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:00:00, 2001-01-01 08:03:00), (2001-01-01 08:04:00, 2001-01-01 08:05:00)}');
select atPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:00:00, 2001-01-01 08:03:00), (2001-01-01 08:04:00, 2001-01-01 08:05:00)}');
select atPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:00:00, 2001-01-01 08:03:00), (2001-01-01 08:04:00, 2001-01-01 08:05:00)}');

select atPeriodSet(tfloati(ARRAY[
tfloatinst(1, '2000-01-01 08:00'),
tfloatinst(3, '2000-01-01 08:10'),
tfloatinst(2, '2000-01-01 08:20'),
tfloatinst(2, '2000-01-01 08:30')
]),
periodSet '{(2000-01-01 08:12, 2000-01-01 08:25),(2000-01-01 08:05, 2000-01-01 08:15)}'
);
-- Invalid value for period set
select atPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:02:00, 2001-01-01 08:03:00), (2001-01-01 08:07:00, 2001-01-01 08:10:00)}');
select atPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:02:00, 2001-01-01 08:03:00), (2001-01-01 08:07:00, 2001-01-01 08:10:00)}');
select atPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:02:00, 2001-01-01 08:03:00), (2001-01-01 08:07:00, 2001-01-01 08:10:00)}');

select minusPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:00:00, 2001-01-01 08:03:00), (2001-01-01 08:04:00, 2001-01-01 08:05:00)}');
select minusPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:00:00, 2001-01-01 08:03:00), (2001-01-01 08:04:00, 2001-01-01 08:05:00)}');
select minusPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:00:00, 2001-01-01 08:03:00), (2001-01-01 08:04:00, 2001-01-01 08:05:00)}');

select minusPeriodSet(tfloati(ARRAY[
tfloatinst(1, '2000-01-01 08:00'),
tfloatinst(3, '2000-01-01 08:10'),
tfloatinst(2, '2000-01-01 08:20'),
tfloatinst(2, '2000-01-01 08:30')
]),
periodSet '{(2000-01-01 08:12, 2000-01-01 08:25),(2000-01-01 08:05, 2000-01-01 08:15)}'
);
-- Invalid value for period set
select minusPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:02:00, 2001-01-01 08:03:00), (2001-01-01 08:07:00, 2001-01-01 08:10:00)}');
select minusPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:02:00, 2001-01-01 08:03:00), (2001-01-01 08:07:00, 2001-01-01 08:10:00)}');
select minusPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}',
	periodSet '{(2001-01-01 08:02:00, 2001-01-01 08:03:00), (2001-01-01 08:07:00, 2001-01-01 08:10:00)}');

-- true
select intersectsTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	timestamp '2001-01-01 08:05:00');
select intersectsTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestamp '2001-01-01 08:05:00');
select intersectsTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestamp '2001-01-01 08:05:00');
-- false
select intersectsTimestamp(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	timestamp '2001-01-01 08:10:00');
select intersectsTimestamp(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestamp '2001-01-01 08:10:00');
select intersectsTimestamp(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestamp '2001-01-01 08:10:00');

-- true
select intersectsTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:05:00', '2001-01-01 08:15:00']));
select intersectsTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:05:00', '2001-01-01 08:15:00']));
select intersectsTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:05:00', '2001-01-01 08:15:00']));
-- false
select intersectsTimestampSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:10:00', '2001-01-01 08:15:00']));
select intersectsTimestampSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:10:00', '2001-01-01 08:15:00']));
select intersectsTimestampSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	timestampset(ARRAY[timestamp '2001-01-01 08:10:00', '2001-01-01 08:15:00']));

-- true
select intersectsPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	period '[2001-01-01 08:05:00, 2001-01-01 08:15:00]');
select intersectsPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	period '[2001-01-01 08:05:00, 2001-01-01 08:15:00]');
select intersectsPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	period '[2001-01-01 08:05:00, 2001-01-01 08:15:00]');
-- false
select intersectsPeriod(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	period '[2001-01-01 08:10:00, 2001-01-01 08:15:00]');
select intersectsPeriod(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	period '[2001-01-01 08:10:00, 2001-01-01 08:15:00]');
select intersectsPeriod(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	period '[2001-01-01 08:10:00, 2001-01-01 08:15:00]');

-- true
select intersectsPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	periodset(ARRAY[period '[2001-01-01 08:05:00, 2001-01-01 08:07:00]', '[2001-01-01 08:13:00, 2001-01-01 08:15:00]']));
select intersectsPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	periodset(ARRAY[period '[2001-01-01 08:05:00, 2001-01-01 08:07:00]', '[2001-01-01 08:13:00, 2001-01-01 08:15:00]']));
select intersectsPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	periodset(ARRAY[period '[2001-01-01 08:05:00, 2001-01-01 08:07:00]', '[2001-01-01 08:13:00, 2001-01-01 08:15:00]']));
-- false
select intersectsPeriodSet(tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}', 
	periodset(ARRAY[period '[2001-01-01 08:10:00, 2001-01-01 08:12:00]', '[2001-01-01 08:13:00, 2001-01-01 08:15:00]']));
select intersectsPeriodSet(tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	periodset(ARRAY[period '[2001-01-01 08:10:00, 2001-01-01 08:12:00]', '[2001-01-01 08:13:00, 2001-01-01 08:15:00]']));
select intersectsPeriodSet(tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}', 
	periodset(ARRAY[period '[2001-01-01 08:10:00, 2001-01-01 08:12:00]', '[2001-01-01 08:13:00, 2001-01-01 08:15:00]']));

-- Scalar comparisons

select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}' =
	tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}' !=
	tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}' <
	tbool '{false@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}' <=
	tbool '{false@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}' >
	tbool '{false@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}';
select tbool '{true@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}' >=
	tbool '{false@2001-01-01 08:00:00,false@2001-01-01 08:05:00,true@2001-01-01 08:06:00}';
	
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' =
	tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' !=
	tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' <
	tint '{2@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' <=
	tint '{2@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' >
	tint '{2@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tint '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' >=
	tint '{2@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';

select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' =
	tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' !=
	tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' <
	tfloat '{2@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' <=
	tfloat '{2@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' >
	tfloat '{2@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
select tfloat '{1@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}' >=
	tfloat '{2@2001-01-01 08:00:00,2@2001-01-01 08:05:00,3@2001-01-01 08:06:00}';
	
select ttexti(ARRAY[
	ttextinst('AAA', '2001-01-01 08:00:00'),
	ttextinst('BBBB', '2001-01-04 08:00:00')]) = 
ttexti(ARRAY[
	ttextinst('AAA', '2001-01-01 08:00:00'),
	ttextinst('BBBB', '2001-01-04 08:00:00')]);

select ttexti(ARRAY[
	ttextinst('AAA', '2001-01-01 08:00:00'),
	ttextinst('BBBB', '2001-01-04 08:00:00')]) <
ttexti(ARRAY[
	ttextinst('AAA', '2001-01-01 08:00:00'),
	ttextinst('BBBB', '2001-01-04 08:00:00')]);
	
-------------------------------------------------------------------------------
