<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Transformations</title><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="MobilityDB 1.3 User's Manual"><link rel="up" href="ch02.html" title="Chapter 2. Set and Span Types"><link rel="prev" href="ch02s04.html" title="Accessors"><link rel="next" href="ch02s06.html" title="Spatial Reference System"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Transformations</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02s04.html">Prev</a> </td><th width="60%" align="center">Chapter 2. Set and Span Types</th><td width="20%" align="right"> <a accesskey="n" href="ch02s06.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm1028"></a>Transformations</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="setspan_shift"></a><a class="indexterm" name="idm1032"></a><p>Shift by a value or interval</p><p><code class="varname">shift(numbers,base) → numbers</code></p><p><code class="varname">shift(dates,integer) → dates</code></p><p><code class="varname">shift(times,interval) → times</code></p><pre class="programlisting">
SELECT shift(dateset '{2001-01-01, 2001-01-03, 2001-01-05}', 1);
-- {2001-01-02, 2001-01-04, 2001-01-06}
SELECT shift(intspan '[1, 4)', -1);
-- [0, 3)
SELECT shift(tstzspan '[2001-01-01, 2001-01-03]', interval '1 day');
-- [2001-01-02, 2001-01-04]
SELECT shift(floatspanset '{[1, 2], [3, 4]}', -1);
-- {[0, 1], [2, 3]}
SELECT shift(tstzspanset '{[2001-01-01, 2001-01-03], [2001-01-04, 2001-01-05]}',
  interval '1 day');
-- {[2001-01-02, 2001-01-04], [2001-01-05, 2001-01-06]}
</pre></li><li class="listitem"><a name="setspan_scale"></a><a class="indexterm" name="idm1044"></a><p>Scale by a value or interval</p><p><code class="varname">scale(numbers,base) → numbers</code></p><p><code class="varname">scale(dates,integer) → dates</code></p><p><code class="varname">scale(times,interval) → times</code></p><p>If the width or time span of the input value is zero (for example, for a singleton timestamp set), the result is the input value. The given value or interval must be strictly greater than zero.</p><pre class="programlisting">
SELECT scale(tstzset '{2001-01-01}', '1 day');
-- {2001-01-01}
SELECT scale(tstzset '{2001-01-01, 2001-01-03, 2001-01-05}', '2 days');
-- {2001-01-01, 2001-01-02, 2001-01-03}
SELECT scale(intspan '[1, 4)', 4);
-- [1, 6)
SELECT scale(datespan '[2001-01-01, 2001-01-04)', 4);
-- [2001-01-01, 2001-01-06)
SELECT scale(tstzspan '[2001-01-01, 2001-01-03]', '1 day');
-- [2001-01-01, 2001-01-02]
SELECT scale(floatspanset '{[1, 2], [3, 4]}', 6);
-- {[1, 3], [5, 7]}
SELECT scale(tstzspanset '{[2001-01-01, 2001-01-03], [2001-01-04, 2001-01-05]}', '1 day');
/* {[2001-01-01 00:00:00, 2001-01-01 12:00:00],
   [2001-01-01 18:00:00, 2001-01-02 00:00:00]} */
SELECT scale(tstzset '{2001-01-01}', '-1 day');
-- ERROR:  The duration must be a positive interval: -1 days
</pre></li><li class="listitem"><a name="setspan_shiftScale"></a><a class="indexterm" name="idm1057"></a><p>Shift and scale by the values or intervals</p><p><code class="varname">shiftScale(numbers,base,base) → numbers</code></p><p><code class="varname">shiftScale(dates,integer,integer) → dates</code></p><p><code class="varname">shiftScale(times,interval,interval) → times</code></p><p>This function combines the functions <a class="link" href="ch02s05.html#setspan_shift"><code class="varname">shift</code></a> and <a class="link" href="ch02s05.html#setspan_scale"><code class="varname">scale</code></a>.</p><pre class="programlisting">
SELECT shiftScale(tstzset '{2001-01-01}', '1 day', '1 day');
-- {2001-01-02}
SELECT shiftScale(tstzset '{2001-01-01, 2001-01-03, 2001-01-05}', '1 day','2 days');
-- {2001-01-02, 2001-01-03, 2001-01-04}
SELECT shiftScale(intspan '[1, 4)', -1, 4);
-- [0, 5)
SELECT shiftScale(datespan '[2001-01-01, 2001-01-04)', -1, 4);
-- [2001-12-31, 2001-01-05)
SELECT shiftScale(tstzspan '[2001-01-01, 2001-01-03]', '1 day', '1 day');
-- [2001-01-02, 2001-01-03]
SELECT shiftScale(floatspanset '{[1, 2], [3, 4]}', -1, 6);
-- {[0, 2], [4, 6]}
SELECT shiftScale(tstzspanset '{[2001-01-01, 2001-01-03], [2001-01-04, 2001-01-05]}',
  '1 day', '1 day');
/* {[2001-01-02 00:00:00, 2001-01-02 12:00:00],
   [2001-01-02 18:00:00, 2001-01-03 00:00:00]} */
</pre></li><li class="listitem"><a name="floatsetspan_floor"></a><a class="indexterm" name="idm1074"></a><a class="indexterm" name="idm1077"></a><p>Round down or up to the nearest integer</p><p><code class="varname">floor({floatset,floatspans}) → {floatset,floatspans}</code></p><p><code class="varname">ceil({floatset,floatspans}) → {floatset,floatspans}</code></p><pre class="programlisting">
SELECT floor(floatset '{1.5,2.5}');
-- {1, 2}
SELECT ceil(floatspan '[1.5,2.5)');
-- [2, 3)
SELECT floor(floatspan '(1.5, 1.6)');
-- [1, 1]
SELECT ceil(floatspanset '{[1.5, 2.5],[3.5,4.5]}');
-- {[2, 3], [4, 5]}
</pre></li><li class="listitem"><a name="floatsetspan_round"></a><a class="indexterm" name="idm1087"></a><p>Round to a number of decimal places</p><p><code class="varname">round({floatset,floatspans},integer=0) → {floatset,floatspans}</code></p><pre class="programlisting">
SELECT round(floatset '{1.123456789,2.123456789}', 3);
-- {1.123, 2.123}
SELECT round(floatspan '[1.123456789,2.123456789)', 3);
-- [1.123,2.123)
SELECT round(floatspan '[1.123456789, inf)', 3);
-- [1.123,Infinity)
SELECT round(floatspanset '{[1.123456789, 2.123456789],[3.123456789,4.123456789]}', 3);
-- {[1.123, 2.123], [3.123, 4.123]}
</pre></li><li class="listitem"><a name="floatset_degrees"></a><a class="indexterm" name="idm1095"></a><a class="indexterm" name="idm1098"></a><p>Convert to degrees or radians</p><p><code class="varname">degrees(floatset, normalize=false) → floatset</code></p><p><code class="varname">radians(floatset) → floatset</code></p><p>The additional parameter in the <code class="varname">degrees</code> function can be used to normalize the values between 0 and 360 degrees.</p><pre class="programlisting">
SELECT round(degrees(floatset '{0, 0.5, 0.7, 1.0}', true), 3);
-- {0, 28.648, 40.107, 57.296}
SELECT round(radians(floatset '{0, 45, 90}'), 3);
-- {0, 0.785, 1.571}
</pre></li><li class="listitem"><a name="textset_lower"></a><a class="indexterm" name="idm1110"></a><a class="indexterm" name="idm1113"></a><a class="indexterm" name="idm1116"></a><p>Transform to lowercase, uppercase, or initcap</p><p><code class="varname">lower(textset) → textset</code></p><p><code class="varname">upper(textset) → textset</code></p><p><code class="varname">initcap(textset) → textset</code></p><pre class="programlisting">
SELECT lower(textset '{"AAA", "BBB", "CCC"}');
-- {"aaa", "bbb", "ccc"}
SELECT upper(textset '{"aaa", "bbb", "ccc"}');
-- {"AAA", "BBB", "CCC"}
SELECT initcap(textset '{"aaa", "bbb", "ccc"}');
-- {"Aaa", "Bbb", "Ccc"}
</pre></li><li class="listitem"><a name="textset_concat"></a><a class="indexterm" name="idm1128"></a><p>Text concatenation</p><p><code class="varname">{text,textset} || {text,textset} → textset</code></p><pre class="programlisting">
SELECT textset '{aaa, bbb}' || text 'XX';
-- {"aaaXX", "bbbXX"}
SELECT text 'XX' || textset '{aaa, bbb}';
-- {"XXaaa", "XXbbb"}
</pre></li><li class="listitem"><a name="time_tprecision"></a><a class="indexterm" name="idm1136"></a><p>Set the temporal precision of the time value to the interval with respect to the origin</p><p><code class="varname">tprecision(times,interval,origin timestamptz=’2000-01-03’) → times</code></p><p>If the origin is not specified, it is set by default to Monday, January 3, 2000</p><pre class="programlisting">
SELECT tprecision(timestamptz '2001-12-03', '30 days');
-- 2001-11-23
SELECT tprecision(timestamptz '2001-12-03', '30 days', '2001-12-01');
-- 2001-12-01
SELECT tprecision(tstzset '{2001-01-01 08:00, 2001-01-01 08:10, 2001-01-01 09:00,
  2001-01-01 09:10}', '1 hour');
-- {"2001-01-01 08:00:00+01", "2001-01-01 09:00:00+01"}
SELECT tprecision(tstzspan '[2001-12-01 08:00, 2001-12-01 09:00]', '1 day');
-- [2001-12-01, 2001-12-02)
SELECT tprecision(tstzspan '[2001-12-01 08:00, 2001-12-15 09:00]', '1 day');
-- [2001-12-01, 2001-12-16)
SELECT tprecision(tstzspanset '{[2001-12-01 08:00, 2001-12-01 09:00],
  [2001-12-01 10:00, 2001-12-01 11:00]}', '1 day');
-- {[2001-12-01, 2001-12-02)}
SELECT tprecision(tstzspanset '{[2001-12-01 08:00, 2001-12-01 09:00],
  [2001-12-01 10:00, 2001-12-01 11:00]}', '1 day');
-- {[2001-12-01, 2001-12-02)}
</pre></li></ul></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02s04.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch02.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch02s06.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Accessors </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Spatial Reference System</td></tr></table></div></body></html>
