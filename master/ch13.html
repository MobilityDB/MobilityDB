<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 13. Temporal Circular Buffers</title><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="MobilityDB 1.3 User's Manual"><link rel="up" href="index.html" title="MobilityDB 1.3 User's Manual"><link rel="prev" href="ch12s15.html" title="Indexing"><link rel="next" href="ch13s02.html" title="Temporal Circular Buffers"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 13. Temporal Circular Buffers</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch12s15.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch13s02.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="tcbuffer"></a>Chapter 13. Temporal Circular Buffers</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="ch13.html#static_circular_buffers">Static Circular Buffers</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch13.html#cbuffer_constructors">Constructors</a></span></dt><dt><span class="sect2"><a href="ch13.html#cbuffer_conversions">Conversions</a></span></dt><dt><span class="sect2"><a href="ch13.html#cbuffer_accessors">Accessors</a></span></dt><dt><span class="sect2"><a href="ch13.html#cbuffer_transformations">Transformations</a></span></dt><dt><span class="sect2"><a href="ch13.html#cbuffer_spatial_functions">Spatial Operations</a></span></dt><dt><span class="sect2"><a href="ch13.html#cbuffer_static_operators">Comparisons</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch13s02.html">Temporal Circular Buffers</a></span></dt><dt><span class="sect1"><a href="ch13s03.html">Validity of Temporal Circular Buffers</a></span></dt><dt><span class="sect1"><a href="ch13s04.html">Input and Output</a></span></dt><dt><span class="sect1"><a href="ch13s05.html">Constructors</a></span></dt><dt><span class="sect1"><a href="ch13s06.html">Conversions</a></span></dt><dt><span class="sect1"><a href="ch13s07.html">Accessors</a></span></dt><dt><span class="sect1"><a href="ch13s08.html">Transformations</a></span></dt><dt><span class="sect1"><a href="ch13s09.html">Spatial Operations</a></span></dt><dt><span class="sect1"><a href="ch13s10.html">Distance Operations</a></span></dt><dt><span class="sect1"><a href="ch13s11.html">Restrictions</a></span></dt><dt><span class="sect1"><a href="ch13s12.html">Comparisons</a></span></dt><dt><span class="sect1"><a href="ch13s13.html">Bounding Box Operations</a></span></dt><dt><span class="sect1"><a href="ch13s14.html">Spatial Relationships</a></span></dt><dt><span class="sect1"><a href="ch13s15.html">Aggregations</a></span></dt><dt><span class="sect1"><a href="ch13s16.html">Indexing</a></span></dt></dl></div><p>A static circular buffer type <code class="varname">cbuffer</code> represents a 2D point and a radius greater than or equal to 0 around the point. The radius represent the “impact” of the point on its surroundings. This impact could be interpreted as noise, pollution, or similar aspects depending on application requirements.</p><p>The <code class="varname">cbuffer</code> type serves as base type for defining the temporal circular buffer type <code class="varname">tcbuffer</code>. The <code class="varname">tcbuffer</code> type has similar functionality as the temporal point type <code class="varname">tgeompoint</code> with the exception that it only considers two dimensions. Thus, most functions and operators described before for the <code class="varname">tgeompoint</code> type are also applicable for the <code class="varname">tcbuffer</code> type. In addition, there are specific functions defined for the <code class="varname">tcbuffer</code> type.</p><p><a class="xref" href="ch13.html#tgeo_tcbuffer" title="Figure 13.1. Illustration of the use of the tcbuffer type for modelling the circular buffer around the wind swath of tropical storms in 2024.">Figure 13.1, “Illustration of the use of the <code class="varname">tcbuffer</code> type for modelling the circular buffer around the wind swath of tropical storms in 2024.”</a> illustrates the use of the <code class="varname">tcbuffer</code> type for modelling the circular buffer around the wind swath of tropical storms in 2024. The data is obtained from the National Oceanic and Atmospherique Administration (<a class="ulink" href="https://www.nhc.noaa.gov/data/tcr/" target="_top">NOAA</a>). As illustrated in the figure, the types <code class="varname">tgeompoint</code> and <code class="varname">tcbuffer</code> allow <span class="emphasis"><em>linear</em></span> interpolation, while as we have seen in <a class="xref" href="ch07.html#tpoint_tgeo" title="Figure 7.2. Illustration of the use of the tgeompoint (top) and the tgeometry (bottom) types for modelling the trajectory and the wind swath of tropical storms in 2024.">Figure 7.2, “Illustration of the use of the <code class="varname">tgeompoint</code> (top) and the <code class="varname">tgeometry</code> (bottom) types for modelling the trajectory and the wind swath of tropical storms in 2024.”</a>, the type <code class="varname">tgeometry</code> only allows <span class="emphasis"><em>step</em></span> interpolation.</p><div class="figure-float"><div class="figure"><a name="tgeo_tcbuffer"></a><p class="title"><b>Figure 13.1. Illustration of the use of the <code class="varname">tcbuffer</code> type for modelling the circular buffer around the wind swath of tropical storms in 2024.</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/tcbuffer.png" width="162" alt="Illustration of the use of the tcbuffer type for modelling the circular buffer around the wind swath of tropical storms in 2024."></div></div></div><br class="figure-break"></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="static_circular_buffers"></a>Static Circular Buffers</h2></div></div></div><p>A <code class="varname">cbuffer</code> value is a couple of the form <code class="varname">(point,radius)</code> where <code class="varname">point</code> is a geometric point and <code class="varname">radius</code> is a <code class="varname">float</code> value greater than or equal to zero representing a radius around the point expressed using the units of the SRID of the point. Examples of input of circular buffer values are as follows:</p><pre class="programlisting">
SELECT cbuffer 'Cbuffer(Point(1 1), 0.3)';
SELECT cbuffer 'Cbuffer(Point(1 1), 10.0)';
</pre><p>The <code class="varname">cbuffer</code> type corresponds to the result of the PostGIS function <a class="ulink" href="https://postgis.net/docs/ST_MinimumBoundingRadius.html" target="_top">ST_MinimumBoundingRadius</a>.</p><p>Values of the circular buffer type must satisfy several constraints so that they are well defined. Examples of incorrect circular buffer type values are as follows.</p><pre class="programlisting">
-- incorrect point value
SELECT cbuffer 'Cbuffer(Linestring(1 1,2 2), 1.0)';
-- incorrect 3D point
SELECT cbuffer 'Cbuffer(Point Z(1 1 1), 1.0)';
-- incorrect radius value
SELECT cbuffer 'Cbuffer(Point(1 1), -2.0)';
</pre><p>We give next the functions and operators for the circular buffer type.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cbuffer_constructors"></a>Constructors</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="cbuffer"></a><a class="indexterm" name="id9083"></a><p>Constructor for circular buffers</p><p><code class="varname">cbuffer(geompoint,float) → cbuffer</code></p><pre class="programlisting">
SELECT asText(cbuffer(ST_Point(1,1), 0.3));
-- Cbuffer(POINT(1 1),0.3)
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cbuffer_conversions"></a>Conversions</h3></div></div></div><p>Values of the <code class="varname">cbuffer</code> type can be converted to the <code class="varname">geometry</code> type using an explicit <code class="varname">CAST</code> or using the <code class="varname">::</code> notation as shown below. Similarly, a <code class="varname">geometry</code> can be converted to a <code class="varname">cbuffer</code> value using the <a class="ulink" href="https://postgis.net/docs/ST_MinimumBoundingRadius.html" target="_top"><code class="varname">ST_MinimumBoundingRadius</code></a> function in PostGIS.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="cbuffer_geometry"></a><a class="indexterm" name="id9103"></a><p>Convert between a circular buffer and a geometry</p><p><code class="varname">geometry::cbuffer</code></p><p><code class="varname">cbuffer::geometry</code></p><pre class="programlisting">
SELECT ST_AsText(cbuffer(ST_Point(1,1), 1)::geometry);
-- CURVEPOLYGON(CIRCULARSTRING(0 1,2 1,0 1))
SELECT asText(geometry 'SRID=5676;CIRCULARSTRING(0 1,2 1,0 1)'::cbuffer);
-- Cbuffer(POINT(1 1),1)
SELECT asText(geometry 'SRID=5676;LINESTRING(0 0,2 2)'::cbuffer);
-- Cbuffer(POINT(1 1),1.414213562373095)
</pre></li><li class="listitem"><a name="cbuffer_stbox"></a><a class="indexterm" name="id9113"></a><p>Convert a circular buffer and, optionally, a timestamp or a period, to a spatiotemporal box</p><p><code class="varname">stbox(cbuffer) → stbox</code></p><p><code class="varname">stbox(cbuffer,{timestamptz,tstzspan}) → stbox</code></p><pre class="programlisting">
SELECT stbox(cbuffer 'SRID=5676;Cbuffer(Point(1 1),0.3)');
-- SRID=5676;STBOX X((0.7,0.7),(1.3,1.3))
SELECT stbox(cbuffer 'Cbuffer(Point(1 1),0.3)', timestamptz '2001-01-01');
-- STBOX XT(((0.7,0.7),(1.3,1.3)),[2001-01-01, 2001-01-01])
SELECT stbox(cbuffer 'Cbuffer(Point(1 1),0.3)', tstzspan '[2001-01-01,2001-01-02]');
-- STBOX XT(((0.7,0.7),(1.3,1.3)),[2001-01-01, 2001-01-02])
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cbuffer_accessors"></a>Accessors</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="cbuffer_point"></a><a class="indexterm" name="id9126"></a><p>Return the point</p><p><code class="varname">point(cbuffer) → geompoint</code></p><pre class="programlisting">
SELECT ST_AsText(point(cbuffer 'Cbuffer(Point(1 1), 0.3)'));
-- Point(1 1)
</pre></li><li class="listitem"><a name="cbuffer_radius"></a><a class="indexterm" name="id9134"></a><p>Return the radius</p><p><code class="varname">radius(cbuffer) → float</code></p><pre class="programlisting">
SELECT radius(cbuffer 'Cbuffer(Point(1 1), 0.3)');
-- 0.3
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cbuffer_transformations"></a>Transformations</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="cbuffer_round"></a><a class="indexterm" name="id9145"></a><p>Round the point and the radius of the circular buffer to the number of decimal places</p><p><code class="varname">round(cbuffer,integer=0) → cbuffer</code></p><pre class="programlisting">
SELECT asText(round(cbuffer(ST_Point(1.123456789,1.123456789), 0.123456789), 6));
-- Cbuffer(POINT(1.123457 1.123457),0.123457)
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cbuffer_spatial_functions"></a>Spatial Operations</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="cbuffer_SRID"></a><a class="indexterm" name="id9156"></a><a class="indexterm" name="id9159"></a><p>Return or set the spatial reference identifier</p><p><code class="varname">SRID(cbuffer) → integer</code></p><p><code class="varname">setSRID(cbuffer) → cbuffer</code></p><pre class="programlisting">
SELECT SRID(cbuffer 'Cbuffer(SRID=5676;Point(1 1), 0.3)');
-- 5676
SELECT asEWKT(setSRID(cbuffer 'Cbuffer(Point(0 0),1)', 4326));
-- SRID=4326;Cbuffer(POINT(0 0),1)
</pre></li><li class="listitem"><a name="cbuffer_transform"></a><a class="indexterm" name="id9169"></a><a class="indexterm" name="id9172"></a><p>Transform to a spatial reference identifier</p><p><code class="varname">transform(cbuffer,integer) → cbuffer</code></p><p><code class="varname">transformPipeline(cbuffer,pipeline text,to_srid integer,is_forward bool=true) → </code></p><p><code class="varname">  cbuffer</code></p><p>The <code class="varname">transform</code> function specifies the transformation with a target SRID. An error is raised when the input circular buffer has an unknown SRID (represented by 0).</p><p>The <code class="varname">transformPipeline</code> function specifies the transformation with a defined coordinate transformation pipeline represented with the following string format:</p><p><code class="varname">urn:ogc:def:coordinateOperation:AUTHORITY::CODE</code></p><p>The SRID of the input circular buffer is ignored, and the SRID of the output circular buffer will be set to zero unless a value is provided via the optional <code class="varname">to_srid</code> parameter. As stated by the last parameter, the pipeline is executed by default in a forward direction; by setting the parameter to false, the pipeline is executed in the inverse direction.</p><pre class="programlisting">
SELECT asEWKT(transform(cbuffer 'SRID=4326;Cbuffer(Point(4.35 50.85),1)', 3812));
-- SRID=3812;Cbuffer(POINT(648679.0180353033 671067.0556381135),1)
</pre><pre class="programlisting">
WITH test(cbuffer, pipeline) AS (
  SELECT cbuffer 'Cbuffer(SRID=4326;Point(4.3525 50.846667),1)',
    text 'urn:ogc:def:coordinateOperation:EPSG::16031' )
SELECT asEWKT(transformPipeline(transformPipeline(cbuffer, pipeline, 4326), pipeline,
  4326, false), 6)
FROM test;
-- SRID=4326;Cbuffer(POINT(4.3525 50.846667),1)
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cbuffer_static_operators"></a>Comparisons</h3></div></div></div><p>The comparison operators (=, &lt;, and so on) are available for circular buffers. They compare first the points and then the radius of the arguments. Excepted the equality and inequality, the other comparison operators are not useful in the real world but allow B-tree indexes to be constructed on circular buffers.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="cbuffer_comp"></a><a class="indexterm" name="id9197"></a><a class="indexterm" name="id9200"></a><a class="indexterm" name="id9203"></a><a class="indexterm" name="id9206"></a><a class="indexterm" name="id9209"></a><a class="indexterm" name="id9212"></a><p>Traditional comparisons</p><p><code class="varname">cbuffer {=, &lt;&gt;, &lt;, &gt;, &lt;=, &gt;=} cbuffer</code></p><pre class="programlisting">
SELECT cbuffer 'Cbuffer(Point(3 3), 0.5)' = cbuffer 'Cbuffer(Point(3 3), 0.5)';
-- true
SELECT cbuffer 'Cbuffer(Point(3 3), 0.5)' &lt;&gt; cbuffer 'Cbuffer(Point(3 3), 0.6)';
-- true
SELECT cbuffer 'Cbuffer(Point(3 3), 0.5)' &lt; cbuffer 'Cbuffer(Point(3 3), 0.6)';
-- true
SELECT cbuffer 'Cbuffer(Point(3 3), 0.6)' &gt; cbuffer 'Cbuffer(Point(2 2), 0.6)';
-- true
SELECT cbuffer 'Cbuffer(Point(1 1), 0.5)' &lt;= cbuffer 'Cbuffer(Point(2 2), 0.5)';
-- true
SELECT cbuffer 'Cbuffer(Point(1 1), 0.6)' &gt;= cbuffer 'Cbuffer(Point(1 1), 0.5)';
-- true
</pre></li></ul></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch12s15.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch13s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Indexing </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Temporal Circular Buffers</td></tr></table></div></body></html>
