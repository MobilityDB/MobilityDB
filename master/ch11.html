<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Chapter 11. Temporal Poses</title><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="MobilityDB 1.3 User's Manual"><link rel="up" href="index.html" title="MobilityDB 1.3 User's Manual"><link rel="prev" href="ch10s03.html" title="Statistics and Selectivity"><link rel="next" href="ch11s02.html" title="Temporal Poses"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 11. Temporal Poses</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch10s03.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch11s02.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="temporal_poses"></a>Chapter 11. Temporal Poses</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="ch11.html#static_poses">Static Poses</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch11.html#pose_inout">Input and Output</a></span></dt><dt><span class="sect2"><a href="ch11.html#pose_constructors">Constructors</a></span></dt><dt><span class="sect2"><a href="ch11.html#pose_conversions">Conversions</a></span></dt><dt><span class="sect2"><a href="ch11.html#pose_accessors">Accessors</a></span></dt><dt><span class="sect2"><a href="ch11.html#pose_transformations">Transformations</a></span></dt><dt><span class="sect2"><a href="ch11.html#pose_srid">Spatial Reference System</a></span></dt><dt><span class="sect2"><a href="ch11.html#pose_comparison">Comparisons</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch11s02.html">Temporal Poses</a></span></dt><dt><span class="sect1"><a href="ch11s03.html">Validity of Temporal Poses</a></span></dt><dt><span class="sect1"><a href="ch11s04.html">Input and Output</a></span></dt><dt><span class="sect1"><a href="ch11s05.html">Constructors</a></span></dt><dt><span class="sect1"><a href="ch11s06.html">Conversions</a></span></dt><dt><span class="sect1"><a href="ch11s07.html">Accessors</a></span></dt><dt><span class="sect1"><a href="ch11s08.html">Transformations</a></span></dt><dt><span class="sect1"><a href="ch11s09.html">Modifications</a></span></dt><dt><span class="sect1"><a href="ch11s10.html">Restrictions</a></span></dt><dt><span class="sect1"><a href="ch11s11.html">Spatial Reference System</a></span></dt><dt><span class="sect1"><a href="ch11s12.html">Bounding Box Operations</a></span></dt><dt><span class="sect1"><a href="ch11s13.html">Distance Operations</a></span></dt><dt><span class="sect1"><a href="ch11s14.html">Spatial Relationships</a></span></dt><dt><span class="sect1"><a href="ch11s15.html">Comparisons</a></span></dt><dt><span class="sect1"><a href="ch11s16.html">Aggregations</a></span></dt><dt><span class="sect1"><a href="ch11s17.html">Indexing</a></span></dt></dl></div><p>The <code class="varname">pose</code> type is used to represent the <span class="emphasis"><em>location</em></span> and <span class="emphasis"><em>orientation</em></span> of geometric objects within coordinate systems anchored to the earth's surface or within other astronomical coordinate systems. The location is represented by a 2D or 3D point. For 2D poses, the orientation is defined by a rotation angle in (-π, π] expressed in radians. For 3D poses, the orientation is defined by four float values <code class="varname">W</code>, <code class="varname">X</code>, <code class="varname">Y</code>, <code class="varname">Z</code>, representing a unit <a class="ulink" href="https://en.wikipedia.org/wiki/Quaternion" target="_top">quaternion</a>
		<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
		<mrow>
			<mi>Q</mi>
			<mo>=</mo>
			<mo>〈</mo>
			<mi>W</mi>
			<mo>,</mo>
			<mi>X</mi>
			<mo>,</mo>
			<mi>Y</mi>
			<mo>,</mo>
			<mi>Z</mi>
			<mo>〉</mo>
		</mrow>
		</math>
	where
		<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
		<mrow>
			<mo>∥</mo>
			<msup><mi>Q</mi><mi>2</mi></msup>
			<mo>∥</mo>
			<mo>=</mo>
			<msqrt>
				<msup><mi>W</mi><mi>2</mi></msup>
				<mo>+</mo>
				<msup><mi>X</mi><mi>2</mi></msup>
				<mo>+</mo>
				<msup><mi>Y</mi><mi>2</mi></msup>
				<mo>+</mo>
				<msup><mi>Z</mi><mi>2</mi></msup>
			</msqrt>
			<mo>=</mo>
			<mi>1</mi>
		</mrow>
		</math>.
	</p><p>
		The <a class="ulink" href="https://www.ogc.org/publications/standard/geopose/" target="_top">GeoPose Standards Working Group</a> (SWG), working under the auspices of the <a class="ulink" href="https://www.ogc.org/" target="_top">Open Geospatial Consortium</a>, has defined a standard for exchanging pose information across different users, devices, and platforms. More information about the standard can be found in the <a class="ulink" href="https://github.com/opengeospatial/GeoPose" target="_top">GitHub repository</a> of the GeoPose SWG.
	</p><p>The <code class="varname">pose</code> type serves as base type for defining the temporal pose type <code class="varname">tpose</code>. The <code class="varname">tpose</code> type has similar functionality as the temporal point type <code class="varname">tgeompoint</code>. Thus, most functions and operators described before for the <code class="varname">tgeompoint</code> type are also applicable for the <code class="varname">tpose</code> type. In addition, there are specific functions defined for the <code class="varname">tpose</code> type.</p> We cover these functions in this chapter.

	<p>The <code class="varname">tpose</code> type is used for defining the type <code class="varname">trgeometry</code> (that is, temporal rigid geometry) defined in the next chapter. The implementation of the these types in MobilityDB has been studied in the following PhD thesis.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
			Maxime Schoemans, <a class="ulink" href="https://docs.mobilitydb.com/pub/maxime_schoemans_thesis.pdf" target="_top"><span class="emphasis"><em>Managing Rigid Temporal Geometries in Moving Object Databases</em></span></a>, PhD thesis, Université libre de Bruxelles, 2025.
		</li></ul></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="static_poses"></a>Static Poses</h2></div></div></div><p>A 2D <code class="varname">pose</code> is a couple of the form <code class="varname">(point2D,radius)</code> where <code class="varname">point2D</code> is a 2D geometric point and <code class="varname">radius</code> is a <code class="varname">float</code> value representing a rotation angle in (-π, π] expressed in radians. A 3D <code class="varname">pose</code> is a tuple of the form <code class="varname">(point3D,W,Y,X,Z)</code> where <code class="varname">point3D</code> is a 3D geometric point, and <code class="varname">W</code>, and <code class="varname">X</code>, <code class="varname">Y</code>, and <code class="varname">Z</code> are four <code class="varname">floats</code> representing a <span class="emphasis"><em>unit</em></span> quaternion.  Examples of input of pose values are as follows:</p><pre class="programlisting">
SELECT pose 'Pose(Point(1 1), 0.5)';
SELECT pose 'Pose(Point Z(1 1 1), 0.5, 0.5, 0.5, 0.5)';
</pre><p>An SRID can be specified for a pose either at the begining of the pose literal or before the point literal as shown below.</p><pre class="programlisting">
SELECT pose 'SRID=3812;Pose(Point(1 1), 0.5)';
SELECT pose 'Pose(SRID=5676;Point Z(1 1 1), 0.5, 0.5, 0.5, 0.5)';
</pre><p>Values of the pose type must satisfy several constraints so that they are well defined. Examples of incorrect pose type values are as follows.</p><pre class="programlisting">
-- Empty point
select pose 'Pose(Point empty, 0.5)';
-- Incorrect point value
SELECT pose 'Pose(Linestring(1 1,2 2), 1.0)';
-- Incorrect radius value
SELECT pose 'Pose(Point(1 1), -10.0)';
-- Incorrect 3D point
SELECT pose 'Pose(Point Z(1 1), 1.0)';
-- Incomplete 3D orientation
SELECT pose 'Pose(Point Z(1 1 1), 1.0)';
</pre><p>We give next the functions and operators for the pose type.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="pose_inout"></a>Input and Output</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="pose_asText"></a><a class="indexterm" name="id7629"></a><a class="indexterm" name="id7632"></a><p>Return the Well-Known Text (WKT) or the Extended Well-Known Text (EWKT) representation</p><p><code class="varname">asText({pose,pose[]}) → {text,text[]}</code></p><p><code class="varname">asEWKT({pose,pose[]}) → {text,text[]}</code></p><pre class="programlisting">
SELECT asText(pose 'SRID=4326;Pose(Point(0 0),1)');
-- Pose(POINT(0 0),1)
SELECT asText(ARRAY[pose 'Pose(Point(0 0),1)', 'Pose(Point(1 1),2)']);
-- {"Pose(POINT(0 0),1)","Pose(POINT(1 1),2)"}
SELECT asEWKT(pose 'SRID=4326;Pose(Point(0 0),1)');
-- SRID=4326;Pose(Point(0 0),1)
SELECT asEWKT(ARRAY[pose 'Pose(SRID=5676;Point(0 0),1)', 'Pose(SRID=5676;Point(1 1),2)']);
-- {"Pose(SRID=5676;POINT(0 0),1)","Pose(SRID=5676;POINT(1 1),2))"}
</pre></li><li class="listitem"><a name="pose_asBinary"></a><a class="indexterm" name="id7642"></a><a class="indexterm" name="id7645"></a><a class="indexterm" name="id7648"></a><p>Return the Well-Known Binary (WKB), the Extended Well-Known Binary (EWKB), or the Hexadecimal Extended Well-Known Binary (HexEWKB) representation</p><p><code class="varname">asBinary(pose,endian text='') → bytea</code></p><p><code class="varname">asEWKB(pose,endian text='') → bytea</code></p><p><code class="varname">asHexEWKB(pose,endian text='') → text</code></p><p>The result is encoded using either the little-endian (NDR) or the big-endian (XDR) encoding. If no encoding is specified, then the encoding of the machine is used.</p><pre class="programlisting">
SELECT asBinary(pose 'Pose(Point(1 2),1)');
-- \x0101000000000000f03f0000000000000040000000000000f03f
SELECT asEWKB(pose 'SRID=7844;Pose(Point(1 2),1)');
-- \x0141a41e0000000000000000f03f0000000000000040000000000000f03f
SELECT asHexEWKB(pose 'SRID=3812;Pose(Point(1 2),1)');
-- 0141E40E0000000000000000F03F0000000000000040000000000000F03F
</pre></li><li class="listitem"><a name="poseFromText"></a><a class="indexterm" name="id7661"></a><a class="indexterm" name="id7664"></a><p>Input from the Well-Known Text (WKT) or from the Extended Well-Known Text (EWKT) representation</p><p><code class="varname">poseFromText(text) → pose</code></p><p><code class="varname">poseFromEWKT(text) → pose</code></p><pre class="programlisting">
SELECT asEWKT(poseFromText(text 'Pose(Point(1 2),1)'));
-- Pose(POINT(1 2),1)
SELECT asEWKT(poseFromEWKT(text 'SRID=3812;Pose(Point(1 2),1)'));
-- SRID=3812;Pose(Point(1 2),1)
</pre></li><li class="listitem"><a name="poseFromBinary"></a><a class="indexterm" name="id7674"></a><a class="indexterm" name="id7677"></a><a class="indexterm" name="id7680"></a><p>Input from the Well-Known Binary (WKB), from the Extended Well-Known Binary (EWKB), or from the Hexadecimal Extended Well-Known Binary (HexEWKB) representation</p><p><code class="varname">poseFromBinary(bytea) → pose</code></p><p><code class="varname">poseFromEWKB(bytea) → pose</code></p><p><code class="varname">poseFromHexEWKB(text) → pose</code></p><pre class="programlisting">
SELECT asEWKT(poseFromBinary(
  '\x0101000000000000f03f0000000000000040000000000000f03f'));
-- Pose(POINT(1 2),1)
SELECT asEWKT(poseFromEWKB(
  '\x0141a41e0000000000000000f03f0000000000000040000000000000f03f'));
-- SRID=7844;Pose(Point(1 2),1)
SELECT asEWKT(poseFromHexEWKB(
  '0141E40E0000000000000000F03F0000000000000040000000000000F03F'));
-- SRID=3812;Pose(POINT(1 2),1)
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="pose_constructors"></a>Constructors</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="pose"></a><a class="indexterm" name="id7695"></a><p>Constructor for poses</p><p><code class="varname">pose(geompoint2D,float) → pose</code></p><p><code class="varname">pose(geompoint3D,float,float,float,float) → pose</code></p><pre class="programlisting">
SELECT asText(pose(ST_Point(1,1), radians(45)), 6);
-- Pose(POINT(1 1),0.785398)
SELECT asEWKT(pose(ST_Point(1,1,3812), radians(45)), 6);
-- SRID=3812;Pose(POINT(1 1),0.785398)
SELECT asText(pose(ST_PointZ(1,1,1), 1, 0, 0, 0));
-- Pose(POINT Z (1 1 1),1,0,0,0)
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="pose_conversions"></a>Conversions</h3></div></div></div><p>Values of the <code class="varname">pose</code> type can be converted to the <code class="varname">geometry</code> point type using an explicit <code class="varname">CAST</code> or using the <code class="varname">::</code> notation as shown below.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="pose_stbox"></a><a class="indexterm" name="id7713"></a><a class="indexterm" name="id7716"></a><p>Convert a pose and, optionally, a timestamp or a period, into a spatiotemporal box</p><p><code class="varname">pose::stbox</code></p><p><code class="varname">stbox(pose) → stbox</code></p><p><code class="varname">stbox(pose,{timestamptz,tstzspan}) → stbox</code></p><pre class="programlisting">
SELECT stbox(pose 'SRID=5676;Pose(Point(1 1),0.3)');
-- SRID=5676;STBOX X((1,1),(1,1))
SELECT stbox(pose 'Pose(Point(1 1),0.3)', timestamptz '2001-01-01');
-- STBOX XT(((1,1),(1.3,1.3)),[2001-01-01, 2001-01-01])
SELECT stbox(pose 'Pose(Point(1 1),0.3)', tstzspan '[2001-01-01,2001-01-02]');
-- STBOX XT(((1,1),(1.3,1.3)),[2001-01-01, 2001-01-02])
</pre></li><li class="listitem"><a name="pose_geometry"></a><a class="indexterm" name="id7728"></a><p>Convert a pose into geometry point</p><p><code class="varname">pose::geompoint</code></p><pre class="programlisting">
SELECT ST_AsText(pose(ST_Point(1, 1), 1)::geometry);
-- Point(1 1)
SELECT ST_AsEWKT(pose(ST_PointZ(1, 1, 1, 5676), 1, 0, 0, 0)::geometry);
-- SRID=5676;POINT(1 1 1)
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="pose_accessors"></a>Accessors</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="pose_point"></a><a class="indexterm" name="id7739"></a><p>Return the point</p><p><code class="varname">point(pose) → geompoint</code></p><pre class="programlisting">
SELECT ST_AsText(point(pose 'Pose(Point(1 1), 0.3)'));
-- Point(1 1)
</pre></li><li class="listitem"><a name="pose_rotation"></a><a class="indexterm" name="id7747"></a><p>Return the rotation</p><p><code class="varname">rotation(pose2D) → float</code></p><pre class="programlisting">
SELECT rotation(pose 'Pose(Point(1 1), 0.3)');
-- 0.3
</pre></li><li class="listitem"><a name="pose_orientation"></a><a class="indexterm" name="id7755"></a><p>Return the orientation</p><p><code class="varname">orientation(pose3D) → (X,W,Z,T)</code></p><pre class="programlisting">
SELECT orientation(pose 'Pose(Point Z(1 1 1), 0, 0, 0, 1)');
-- (0, 0, 0, 1)
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="pose_transformations"></a>Transformations</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="pose_round"></a><a class="indexterm" name="id7766"></a><p>Round the point and the orientation of the pose to the number of decimal places</p><p><code class="varname">round(pose,integer=0) → pose</code></p><pre class="programlisting">
SELECT asText(round(pose(ST_Point(1.123456789,1.123456789), 0.123456789), 6));
-- Pose(POINT(1.123457 1.123457),0.123457)
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="pose_srid"></a>Spatial Reference System</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="pose_SRID"></a><a class="indexterm" name="id7777"></a><a class="indexterm" name="id7780"></a><p>Return or set the spatial reference identifier</p><p><code class="varname">srid(pose) → integer</code></p><p><code class="varname">setSRID(pose) → pose</code></p><pre class="programlisting">
SELECT SRID(pose 'Pose(SRID=5676;Point(1 1), 0.3)');
-- 5676
SELECT asEWKT(setSRID(pose 'Pose(Point(0 0),1)', 4326));
-- SRID=4326;Pose(POINT(0 0),1)
</pre></li><li class="listitem"><a name="pose_transform"></a><a class="indexterm" name="id7790"></a><a class="indexterm" name="id7793"></a><p>Transform to a spatial reference identifier</p><p><code class="varname">transform(pose,integer) → pose</code></p><p><code class="varname">transformPipeline(pose,pipeline text,to_srid integer,is_forward bool=true) → pose</code></p><p>The <code class="varname">transform</code> function specifies the transformation with a target SRID. An error is raised when the input pose has an unknown SRID (represented by 0).</p><p>The <code class="varname">transformPipeline</code> function specifies the transformation with a defined coordinate transformation pipeline represented with the following string format:</p><p><code class="varname">urn:ogc:def:coordinateOperation:AUTHORITY::CODE</code></p><p>The SRID of the input pose is ignored, and the SRID of the output pose will be set to zero unless a value is provided via the optional <code class="varname">to_srid</code> parameter. As stated by the last parameter, the pipeline is executed by default in a forward direction; by setting the parameter to false, the pipeline is executed in the inverse direction.</p><pre class="programlisting">
SELECT asEWKT(transform(pose 'SRID=4326;Pose(Point(4.35 50.85),1)', 3812), 6);
-- SRID=4326;Pose(POINT(648679.018035 671067.055638),1)
</pre><pre class="programlisting">
WITH test(pose, pipeline) AS (
  SELECT pose 'Pose(SRID=4326;Point(4.3525 50.846667),1)',
    text 'urn:ogc:def:coordinateOperation:EPSG::16031' )
SELECT asEWKT(transformPipeline(transformPipeline(pose, pipeline, 4326), pipeline,
  4326, false), 6)
FROM test;
-- SRID=4326;Pose(POINT(4.3525 50.846667),1)
</pre></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="pose_comparison"></a>Comparisons</h3></div></div></div><p>The comparison operators (=, &lt;, and so on) are available for poses. Excepted the equality and inequality, the other comparison operators are not useful in the real world but allow B-tree indexes to be constructed on poses.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="pose_comp"></a><a class="indexterm" name="id7816"></a><a class="indexterm" name="id7819"></a><a class="indexterm" name="id7822"></a><a class="indexterm" name="id7825"></a><a class="indexterm" name="id7828"></a><a class="indexterm" name="id7831"></a><p>Traditional comparisons</p><p><code class="varname">pose {=, &lt;&gt;, &lt;, &gt;, &lt;=, &gt;=} pose</code></p><pre class="programlisting">
SELECT pose 'Pose(Point(3 3), 0.5)' = pose 'Pose(Point(3 3), 0.5)';
-- true
SELECT pose 'Pose(Point(3 3), 0.5)' &lt;&gt; pose 'Pose(Point(3 3), 0.6)';
-- true
SELECT pose 'Pose(Point(3 3), 0.5)' &lt; pose 'Pose(Point(3 3), 0.6)';
-- true
SELECT pose 'Pose(Point(3 3), 0.6)' &gt; pose 'Pose(Point(2 2), 0.6)';
-- true
SELECT pose 'Pose(Point Z(1 1 1), 0.5, 0.5, 0.5, 0.5)' &lt;= pose 'Pose(Point Z(2 2 2), 0.5, 0.5, 0.5, 0.5)';
-- true
SELECT pose 'Pose(Point(1 1), 0.6)' &gt;= pose 'Pose(Point(1 1), 0.5)';
-- true
</pre></li><li class="listitem"><a name="pose_same"></a><a class="indexterm" name="id7839"></a><p>Are the poses approximately equal with respect to an epsilon value?</p><p><code class="varname">pose ~= pose → boolean</code></p><pre class="programlisting">
SELECT pose 'Pose(SRID=5676;Point(1 1), 0.3)' ~= 
  pose 'Pose(SRID=5676;Point(1 1.0000001), 0.30000001)';
-- true
</pre></li></ul></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch10s03.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch11s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Statistics and Selectivity </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Temporal Poses</td></tr></table></div></body></html>
