<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Estadísticas y selectividad</title><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="MobilityDB 1.1 Manual de usuario"><link rel="up" href="ch10.html" title="Capítulo 10. Tipos temporales: Agregación e indexación"><link rel="prev" href="ch10s02.html" title="Indexación"><link rel="next" href="ch11.html" title="Capítulo 11. Puntos de red temporales"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Estadísticas y selectividad</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch10s02.html">Anterior</a> </td><th width="60%" align="center">Capítulo 10. Tipos temporales: Agregación e indexación</th><td width="20%" align="right"> <a accesskey="n" href="ch11.html">Siguiente</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="temporal_types_statistics"></a>Estadísticas y selectividad</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm5876"></a>Colecta de estadísticas</h3></div></div></div><p>El planificador de PostgreSQL se basa en información estadística sobre el contenido de las tablas para generar el plan de ejecución más eficiente para las consultas. Estas estadísticas incluyen una lista de algunos de los valores más comunes en cada columna y un histograma que muestra la distribución aproximada de datos en cada columna. Para tablas grandes, se toma una muestra aleatoria del contenido de la tabla, en lugar de examinar cada fila. Esto permite analizar tablas grandes en poco tiempo. La información estadística es recopilada por el comando <code class="varname">ANALYZE</code> y es almacenada en la tabla de catálogo <code class="varname">pg_statistic</code>. Dado que diferentes tipos de estadísticas pueden ser apropiados para diferentes tipos de datos, la tabla sólo almacena estadísticas muy generales (como el número de valores nulos) en columnas dedicadas. Todo lo demás se almacena en cinco “slots”, que son pares de columnas de matriz que almacenan las estadísticas de una columna de un tipo arbitrario.</p><p>Las estadísticas recopiladas para tipos de tiempo y tipos temporales se basan en las recopiladas por PostgreSQL para tipos escalares y tipos de rango. Para tipos escalares, como <code class="varname">float</code>, se recopilan las siguientes estadísticas:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>fracción de valores nulos,</p></li><li class="listitem"><p>ancho promedio, en bytes, de valores no nulos,</p></li><li class="listitem"><p>número de diferentes valores no nulos,</p></li><li class="listitem"><p>matriz de los valores más comunes y matriz de sus frecuencias,</p></li><li class="listitem"><p>histograma de valores, donde se excluyen los valores más comunes,</p></li><li class="listitem"><p>correlación entre el orden de filas físico y lógico.</p></li></ol></div><p>
			</p><p>Para los tipos de rango, como <code class="varname">tstzspan</code>, se recopilan tres histogramas adicionales:
				</p><div class="orderedlist"><ol class="orderedlist" start="7" type="1"><li class="listitem"><p>histograma de longitud de rangos no vacíos,</p></li><li class="listitem"><p>histogramas de límites superior e inferior.</p></li></ol></div><p>
			</p><p>Para geometrías, además de (1)–(3), se recopilan las siguientes estadísticas:
				</p><div class="orderedlist"><ol class="orderedlist" start="9" type="1"><li class="listitem"><p>número de dimensiones de los valores, cuadro delimitador N-dimensional, número de filas en la tabla, número de filas en la muestra, número de valores no nulos,</p></li><li class="listitem"><p>Histograma N-dimensional que divide el cuadro delimitador en varias celdas y mantiene la proporción de valores que se cruzan con cada celda.</p></li></ol></div><p>
			</p><p>Las estadísticas recopiladas para columnas de los tipos de tiempo y de rango <code class="varname">tstzset</code>, <code class="varname">tstzspan</code>, <code class="varname">tstzspanset</code>, <code class="varname">intspan</code> y <code class="varname">floatspan</code> replican las recopiladas por PostgreSQL para <code class="varname">tstzrange</code>. Esto es claro para los tipos de rango en MobilityDB, que son versiones más eficientes de los tipos de rango en PostgreSQL. Para los tipos <code class="varname">tstzset</code> y <code class="varname">tstzspanset</code>, un valor se convierte en su período delimitador y luego se recopilan las estadísticas del tipo <code class="varname">tstzspan</code>.</p><p>Las estadísticas recopiladas para columnas de los tipos temporales dependen del subtipo temporal y del tipo base. Además de las estadísticas (1)–(3) que se recopilan para todos los tipos temporales, las estadísticas se recopilan para la dimensiónes de tiempo y de valor de forma independiente. Más precisamente, se recopilan las siguientes estadísticas para la dimensión de tiempo:
				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Para columnas de subtipo instante, las estadísticas (4)–(6) se recopilan para las marcas de tiempo.</p></li><li class="listitem"><p>Para columnas de otro subtipo, las estadísticas (7)–(8) se recopilan para los períodos delimitadores.</p></li></ul></div><p>
			</p><p>Las siguientes estadísticas se recopilan para la dimensión de valores:
				</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Para columnas de tipos temporales con interpolación escalonada (es decir, <code class="varname">tbool</code>, <code class="varname">ttext</code> o <code class="varname">tint</code>):
							</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Para el subtipo instante, las estadísticas (4)–(6) se recopilan para los valores.</p></li><li class="listitem"><p>Para todas los demás subtipos, las estadísticas (7)–(8) se recopilan para los valores.</p></li></ul></div><p>
						</p></li><li class="listitem"><p>Para columnas de tipos temporales flotantes (es decir, <code class="varname">tfloat</code>):
							</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Para el subtipo instante, las estadísticas (4)–(6) se recopilan para los valores.</p></li><li class="listitem"><p>Para todas los demás subtipos, las estadísticas (7)–(8) se recopilan por los rangos delimitadores de valores.</p></li></ul></div><p>
						</p></li><li class="listitem"><p>Para columnas de tipos de puntos temporales (es decir, <code class="varname">tgeompoint</code> y <code class="varname">tgeogpoint</code>) las estadísticas (9)–(10) se compilan para los puntos.</p></li></ul></div><p>
			</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm5949"></a>Estimación de la selectividad</h3></div></div></div><p>Los operadores booleanos en PostgreSQL se pueden asociar con dos funciones de selectividad, que calculan la probabilidad de que un valor de un tipo dado coincida con un criterio dado. Estas funciones de selectividad se basan en las estadísticas recopiladas. Hay dos tipos de funciones de selectividad. Las funciones de selectividad de <span class="emphasis"><em>restricción</em></span> intentan estimar el porcentaje de filas en una tabla que satisfacen una condición en la cláusula <code class="varname">WHERE</code> de la forma <code class="varname">column OP constant</code>. Por otro lado, las funciones de selectividad de <span class="emphasis"><em>unión</em></span> intentan estimar el porcentaje de filas en una tabla que satisfacen una condición en la cláusula <code class="varname">WHERE</code> de la forma <code class="varname">table1.column1 OP table2.column2</code>.</p><p>MobilityDB define 23 clases de operadores booleanos (como<code class="varname">=</code>, <code class="varname">&lt;</code>, <code class="varname">&amp;&amp;</code>, <code class="varname">&lt;&lt;</code>, etc.), cada uno de los cuales puede tener como argumentos izquierdo o derecho un tipo PostgreSQL (como <code class="varname">integer</code>, <code class="varname">timestamptz</code>, etc.) o un tipo MobilityDB (como <code class="varname">tstzspan</code>, <code class="varname">tint</code>, etc.). Como consecuencia, existe un número muy elevado de operadores con diferentes argumentos a considerar para las funciones de selectividad. El enfoque adoptado fue agrupar estas combinaciones en clases correspondientes a las dimensiones de valor o de tiempo. Las clases corresponden al tipo de estadísticas recopiladas como se explica en la sección anterior.</p><p>MobilityDB estima la selectividad de restricción y de combinación para tipos de tiempo, de rango y temporales.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch10s02.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="ch10.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="ch11.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Indexación </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Capítulo 11. Puntos de red temporales</td></tr></table></div></body></html>
