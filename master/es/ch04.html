<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Capítulo 4. Tipos temporales</title><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="MobilityDB 1.3 Manual de usuario"><link rel="up" href="index.html" title="MobilityDB 1.3 Manual de usuario"><link rel="prev" href="ch03s12.html" title="Indexación"><link rel="next" href="ch04s02.html" title="Ejemplos de tipos temporales"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Capítulo 4. Tipos temporales</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch03s12.html">Anterior</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch04s02.html">Siguiente</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="temporal_types"></a>Capítulo 4. Tipos temporales</h1></div></div></div><div class="toc"><p><b>Tabla de contenidos</b></p><dl class="toc"><dt><span class="sect1"><a href="ch04.html#temporal_types_introduction">Introduction</a></span></dt><dt><span class="sect1"><a href="ch04s02.html">Ejemplos de tipos temporales</a></span></dt><dt><span class="sect1"><a href="ch04s03.html">Validez de los tipos temporales</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="temporal_types_introduction"></a>Introduction</h2></div></div></div><p>
			MobilityDB proporciona seis tipos temporales nativos, a saber, <code class="varname">tbool</code>, <code class="varname">tint</code>, <code class="varname">tfloat</code>, <code class="varname">ttext</code>, <code class="varname">tgeompoint</code> y <code class="varname">tgeogpoint</code>, que se basan, respectivamente, en los tipos de base <code class="varname">bool</code>, <code class="varname">integer</code>, <code class="varname">float</code>, <code class="varname">text</code>, <code class="varname">geometry</code> y <code class="varname">geography</code> (los dos últimos tipos restringidos a puntos 2D o 3D con dimensión Z).
		</p><p>
			La <span class="emphasis"><em>interpolación</em></span> de un valor temporal establece cómo evoluciona el valor entre instantes sucesivos. La interpolación es <span class="emphasis"><em>discreta</em></span> cuando se desconoce el valor entre dos instantes sucesivos. Pueden representar, por ejemplo, entradas/salidas cuando se utiliza un lector de tarjetas RFID para entrar o salir de un edificio. La interpolación es <span class="emphasis"><em>escalonada</em></span> cuando el valor permanece constante entre dos instantes sucesivos. Por ejemplo, la marcha que utiliza un automóvil en movimiento puede representarse con un número entero temporal, lo que indica que su valor es constante entre dos instantes de tiempo. Por otro lado, la interpolación es <span class="emphasis"><em>lineal</em></span> cuando el valor evoluciona linealmente entre dos instantes sucesivos. Por ejemplo, la velocidad de un automóvil puede representarse con un flotante temporal, lo que indica que los valores se conocen en los instantes de tiempo pero evolucionan continuamente entre ellos. De manera similar, la ubicación de un vehículo se puede representar mediante un punto temporal en el que la ubicación entre dos lecturas GPS consecutivas se obtiene mediante interpolación lineal. Los tipos temporales basados en tipos base discretos, es decir <code class="varname">tbool</code>, <code class="varname">tint</code> o <code class="varname">ttext</code> evolucionan necesariamente de manera escalonada. Por otro lado, los tipos temporales basados en tipos base continuos, es decir <code class="varname">tfloat</code>, <code class="varname">tgeompoint</code> o <code class="varname">tgeogpoint</code> pueden evolucionar de manera lineal o escalonada.
		</p><p>
			El <span class="emphasis"><em>subtipo</em></span> de un valor temporal establece la extensión temporal en la que se registra la evolución de los valores. Los valores temporales vienen en tres subtipos, explicados a continuación.
		</p><p>
			Un valor temporal de subtipo <span class="emphasis"><em>instante</em></span> (brevemente, un <span class="emphasis"><em>valor de instante</em></span>) representa el valor en un instante de tiempo, por ejemplo
		</p><pre class="programlisting">
SELECT tfloat '17@2018-01-01 08:00:00';
</pre><p>
		Un valor temporal de subtipo <span class="emphasis"><em>secuencia</em></span> (brevemente, un <span class="emphasis"><em>valor de secuencia</em></span>) representa la evolución del valor durante una secuencia de instantes de tiempo, donde los valores entre estos instantes se interpolan usando una función discreta, escalonada, o lineal (ver arriba). Un ejemplo es el siguiente:
	</p><pre class="programlisting">
-- Interpolación discreta
SELECT tfloat '{17@2018-01-01 08:00:00, 17.5@2018-01-01 08:05:00, 18@2018-01-01 08:10:00}';
-- Interpolación escalonada
SELECT tfloat 'Interp=Step;(10@2018-01-01 08:00:00, 20@2018-01-01 08:05:00,
  15@2018-01-01 08:10:00]';
-- Interpolación lineal
SELECT tfloat '(10@2018-01-01 08:00:00, 20@2018-01-01 08:05:00, 15@2018-01-01 08:10:00]';
</pre><p>
		Como puede verse, un valor de secuencia tiene un límite superior e inferior que pueden ser inclusivos (representados por ‘<code class="varname">[</code>’ y ‘<code class="varname">]</code>’) o exclusivos (representados por ‘<code class="varname">(</code>' y ‘<code class="varname">)</code>'). Por definición, ambos límites deben ser inclusivos cuando la interpolación es discreta o cuando la secuencia tiene un solo instante (que se llama <span class="emphasis"><em>secuencia instantánea</em></span>), como el ejemplo suiguiente.
	</p><pre class="programlisting">
SELECT tint '[10@2018-01-01 08:00:00]';
</pre><p>
			Los valores de secuencia deben ser <span class="emphasis"><em>uniformes</em></span>, es decir, deben construirse a partir de valores de instante del mismo tipo de base. Los valores de secuencia con interpolación escalonada o lineal se denominan <span class="emphasis"><em>secuencias continuas</em></span>.
		</p><p>
			El valor de una secuencia temporal se interpreta asumiendo que el período de tiempo definido por cada par de valores consecutivos <code class="varname">v1@t1</code> y <code class="varname">v2@t2</code> es inferior inclusivo y superior exclusivo, a menos que sean el primer o el último instantes de la secuencia y, en ese caso, se aplican los límites de toda la secuencia. Además, el valor que toma la secuencia temporal entre dos instantes consecutivos depende de si la interpolación es escalonada o lineal. Por ejemplo, la secuencia temporal anterior representa que el valor es <code class="varname">10</code> durante<code class="varname">(2018-01-01 08:00:00, 2018-01-01 08:05:00)</code>, <code class="varname">20</code> durante <code class="varname">[2018-01-01 08:05:00, 2018-01-01 08:10:00)</code> y <code class="varname">15</code> en el instante final <code class="varname">2018-01-01 08:10:00</code>. Por otro lado, la siguiente secuencia temporal
		</p><pre class="programlisting">
SELECT tfloat '(10@2018-01-01 08:00:00, 20@2018-01-01 08:05:00, 15@2018-01-01 08:10:00]';
</pre><p>
			representa que el valor evoluciona linealmente de <code class="varname">10</code> a <code class="varname">20</code> durante <code class="varname">(2018-01-01 08:00:00, 2018-01-01 08:05:00)</code> y evoluciona de <code class="varname">20</code> a <code class="varname">15</code> durante <code class="varname">[2018-01-01 08:05:00, 2018-01-01 08:10:00]</code>.
		</p><p>
			Finalmente, un valor temporal de subtipo <span class="emphasis"><em>conjunto de secuencias</em></span> (brevemente, un <span class="emphasis"><em>valor de conjunto de secuencias</em></span>) representa la evolución del valor en un conjunto de secuencias, donde se desconocen los valores entre estas secuencias. Un ejemplo es el siguiente:
		</p><pre class="programlisting">
SELECT tfloat '{[17@2018-01-01 08:00:00, 17.5@2018-01-01 08:05:00],
  [18@2018-01-01 08:10:00, 18@2018-01-01 08:15:00]}';
</pre><p>
			Como se muestra en los ejemplos anteriores, los valores de conjunto de secuencias solo pueden ser de interpolación escalonada o lineal. Además, todas las secuencias que componen un valor de conjunto de secuencias deben ser del mismo tipo de base y de la misma interpolación.
		</p><p>
			Los valores de secuencia continuos se convierten en <span class="emphasis"><em>forma normal</em></span> de modo que los valores equivalentes tengan representaciones idénticas. Para ello, los valores de instante consecutivos se fusionan cuando es posible. Para la interpolación escalonada, tres valores instantáneos consecutivos se pueden fusionar en dos si tienen el mismo valor. Para la interpolación lineal, tres valores instantáneos consecutivos se pueden fusionar en dos si las funciones lineales que definen la evolución de los valores son las mismas. Ejemplos de transformación en forma normal son los siguientes.
		</p><pre class="programlisting">
SELECT tint '[1@2001-01-01, 2@2001-01-03, 2@2001-01-04, 2@2001-01-05)';
-- [1@2001-01-01 00:00:00+00, 2@2001-01-03 00:00:00+00, 2@2001-01-05 00:00:00+00)
SELECT asText(tgeompoint '[Point(1 1)@2001-01-01 08:00:00, Point(1 1)@2001-01-01 08:05:00,
  Point(1 1)@2001-01-01 08:10:00)');
-- [Point(1 1)@2001-01-01 08:00:00, Point(1 1)@2001-01-01 08:10:00)
SELECT tfloat '[1@2001-01-01, 2@2001-01-03, 3@2001-01-05]';
-- [1@2001-01-01 00:00:00+00, 3@2001-01-05 00:00:00+00]
SELECT asText(tgeompoint '[Point(1 1)@2001-01-01 08:00:00, Point(2 2)@2001-01-01 08:05:00,
  Point(3 3)@2001-01-01 08:10:00]');
-- [Point(1 1)@2001-01-01 08:00:00, Point(3 3)@2001-01-01 08:10:00]
</pre><p>
			De manera similar, los valores del conjunto de secuencias temporales se convierten en forma normal. Para ello, los valores de secuencia consecutivos se fusionan cuando es posible. Ejemplos de transformación en forma normal son los siguientes.
		</p><pre class="programlisting">
SELECT tint '{[1@2001-01-01, 1@2001-01-03), [2@2001-01-03, 2@2001-01-05)}';
-- '{[1@2001-01-01 00:00:00+00, 2@2001-01-03 00:00:00+00, 2@2001-01-05 00:00:00+00)}'
SELECT tfloat '{[1@2001-01-01, 2@2001-01-03), [2@2001-01-03, 3@2001-01-05]}';
-- '{[1@2001-01-01 00:00:00+00, 3@2001-01-05 00:00:00+00]}'
SELECT tfloat '{[1@2001-01-01, 3@2001-01-05), [3@2001-01-05]}';
-- '{[1@2001-01-01 00:00:00+00, 3@2001-01-05 00:00:00+00]}'
SELECT asText(tgeompoint '{[Point(0 0)@2001-01-01 08:00:00,
  Point(1 1)@2001-01-01 08:05:00, Point(1 1)@2001-01-01 08:10:00),
  [Point(1 1)@2001-01-01 08:10:00, Point(1 1)@2001-01-01 08:15:00)}');
/* {[[Point(0 0)@2001-01-01 08:00:00, Point(1 1)@2001-01-01 08:05:00,
   Point(1 1)@2001-01-01 08:15:00)} */
SELECT asText(tgeompoint '{[Point(1 1)@2001-01-01 08:00:00,Point(2 2)@2001-01-01 08:05:00),
  [Point(2 2)@2001-01-01 08:05:00, Point(3 3)@2001-01-01 08:10:00]}');
-- {[Point(1 1)@2001-01-01 08:00:00, Point(3 3)@2001-01-01 08:10:00]}
SELECT asText(tgeompoint '{[Point(1 1)@2001-01-01 08:00:00,Point(3 3)@2001-01-01 08:10:00),
  [Point(3 3)@2001-01-01 08:10:00]}');
-- {[Point(1 1)@2001-01-01 08:00:00, Point(3 3)@2001-01-01 08:10:00]}
</pre><p>
		Los tipos temporales soportan <span class="emphasis"><em>modificadores de typo</em></span> (o <code class="varname">typmod</code> en terminología de PostgreSQL), que especifican información adicional para la definición de una columna. Por ejemplo, en la siguiente definición de tabla:
	</p><pre class="programlisting">
CREATE TABLE Department(DeptNo integer, DeptName varchar(25), NoEmps tint(Sequence));
</pre><p>
			el modificador de tipo para el tipo <code class="varname">varchar</code> es el valor 25, que indica la longitud máxima de los valores de la columna, mientras que el modificador de tipo para el tipo <code class="varname">tint</code> es la cadena de caracteres <code class="varname">Sequence</code>, que restringe el subtipo de los valores de la columna para que sean secuencias. En el caso de tipos alfanuméricos temporales (es decir, <code class="varname">tbool</code>, <code class="varname">tint</code>, <code class="varname">tfloat</code> y <code class="varname">ttext</code>), los valores posibles para el modificador de tipo son <code class="varname">Instant</code>, <code class="varname">Sequence</code> y <code class="varname">SequenceSet</code>. Si no se especifica ningún modificador de tipo para una columna, se permiten valores de cualquier subtipo.
		</p><p>
			Por otro lado, en el caso de tipos de puntos temporales (es decir, <code class="varname">tgeompoint</code> o <code class="varname">tgeogpoint</code>) el modificador de tipo se puede utilizar para especificar el subtipo, la dimensionalidad y/o el identificador de referencia espacial (SRID). Por ejemplo, en la siguiente definición de tabla:
		</p><pre class="programlisting">
CREATE TABLE Flight(FlightNo integer, Route tgeogpoint(Sequence, PointZ, 4326));
</pre><p>
			el modificador de typo para el tipo <code class="varname">tgeogpoint</code> se compone de tres valores, el primero indica el subtipo como arriba, el segundo el tipo espacial de las geografías que componen el punto temporal y el último el SRID de las geografías que componen. Para los puntos temporales, los valores posibles para el primer argumento del modificador de tipo son los anteriores, los del segundo argumento son <code class="varname">Point</code> o <code class="varname">PointZ</code> y los del tercer argumento son SRID válidos. Los tres argumentos son opcionales y si alguno de ellos no se especifica para una columna, se permiten valores de cualquier subtipo, dimensionalidad y/o SRID.
		</p><p>
			Cada tipo temporal está asociado a otro tipo, conocido como su <span class="emphasis"><em>cuadro delimitador</em></span>, que representan su extensión en la dimensión de valor y/o tiempo. El cuadro delimitador de los distintos tipos temporales es el siguiente:
		</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>El tipo <code class="varname">tstzspan</code> para los tipos <code class="varname">tbool</code> y <code class="varname">ttext</code>, donde solo se considera la extensión temporal.</p></li><li class="listitem"><p>El tipo <code class="varname">tbox</code> (temporal box) par los tipos <code class="varname">tint</code> y <code class="varname">tfloat</code>, donde la extensión del valor y de tiempo se define, respectivamente, por un rango numérico y un rango de tiempo.</p></li><li class="listitem"><p>El tipo <code class="varname">stbox</code> (spatiotemporal box) para los tipos <code class="varname">tgeompoint</code> y <code class="varname">tgeogpoint</code>, donde la extensión espacial se define en las dimensiones X, Y y Z y la extensión de timpo se define en un rango de tiempo.</p></li></ul></div><p>
			Un amplio conjunto de funciones y operadores son disponibles para realizar varias operaciones en los tipos temporales. Estos se explican a continuación y en los próximos capítulos. Algunas de estas operaciones, en particular las relacionadas con índices, manipulan cuadros delimitadores por razones de eficiencia.
		</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03s12.html">Anterior</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch04s02.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Indexación </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Ejemplos de tipos temporales</td></tr></table></div></body></html>
