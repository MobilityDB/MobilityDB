<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Capítulo 10. Tipos temporales: Agregación e indexación</title><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="MobilityDB 1.3 Manual de usuario"><link rel="up" href="index.html" title="MobilityDB 1.3 Manual de usuario"><link rel="prev" href="ch09s05.html" title="Mosaicos multidimensionales"><link rel="next" href="ch10s02.html" title="Indexación"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Capítulo 10. Tipos temporales: Agregación e indexación</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch09s05.html">Anterior</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch10s02.html">Siguiente</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="temporal_types_aggregation"></a>Capítulo 10. Tipos temporales: Agregación e indexación</h1></div></div></div><div class="toc"><p><b>Tabla de contenidos</b></p><dl class="toc"><dt><span class="sect1"><a href="ch10.html#temporal_types_aggregations">Agregación</a></span></dt><dt><span class="sect1"><a href="ch10s02.html">Indexación</a></span></dt><dt><span class="sect1"><a href="ch10s03.html">Estadísticas y selectividad</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch10s03.html#idm6218">Colecta de estadísticas</a></span></dt><dt><span class="sect2"><a href="ch10s03.html#idm6291">Estimación de la selectividad</a></span></dt></dl></dd></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="temporal_types_aggregations"></a>Agregación</h2></div></div></div><p>Las funciones agregadas temporales generalizan las funciones agregadas tradicionales. Su semántica es que calculan el valor de la función en cada instante de la <span class="emphasis"><em>unión</em></span> de las extensiones temporales de los valores a agregar. En contraste, recuerde que todas las otras funciones que manipulan tipos temporales calculan el valor de la función en cada instante de la <span class="emphasis"><em>intersección</em></span> de las extensiones temporales de los argumentos.</p><p>Las funciones agregadas temporales son las siguientes:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Para todos los tipos temporales, la función <code class="varname">tCount</code> generaliza la función traditional <code class="varname">count</code>. El conteo temporal se puede utilizar para calcular en cada momento el número de objetos disponibles (por ejemplo, el número de coches en un área).</p></li><li class="listitem"><p>Para todos los tipos temporales, la función <code class="varname">extent</code> devuelve un cuadro delimitador que engloba un conjunto de valores temporales. Dependiendo del tipo de base, el resultado de esta función puede ser un <code class="varname">tstzspan</code>, un <code class="varname">tbox</code> o un <code class="varname">stbox</code>.</p></li><li class="listitem"><p>Para el tipo booleano temporal, las funciones <code class="varname">tAnd</code> y <code class="varname">tOr</code> generalizan las funciones traditionales <code class="varname">and</code> y <code class="varname">or</code>.</p></li><li class="listitem"><p>Para los tipos numéricos temporales hay dos tipos de funciones agregadas temporales. Las funciones <code class="varname">tmin</code>, <code class="varname">tMax</code>, <code class="varname">tSum</code> y <code class="varname">tAvg</code> generalizan las funciones traditionales <code class="varname">min</code>, <code class="varname">max</code>, <code class="varname">sum</code> y <code class="varname">avg</code>. Además, las funciones <code class="varname">wMin</code>, <code class="varname">wMax</code>, <code class="varname">wCount</code>, <code class="varname">wSum</code> y <code class="varname">wAvg</code> son versiones de ventana (o acumulativas) de las funciones tradicionales que, dado un intervalo de tiempo w, calculan el valor de la función en un instante t considerando los valores durante el intervalo [t-w, t]. Todas las funciones agregadas de ventana están disponibles para enteros temporales, mientras que para flotantes temporales sólo son significativos el mínimo y el máximo de ventana.</p></li><li class="listitem"><p>Para el tipo texto temporal, las funciones <code class="varname">tMin</code> y <code class="varname">tMax</code> generalizan las funciones traditionales <code class="varname">min</code> y <code class="varname">max</code>.</p></li><li class="listitem"><p>Finalmente, para puntos temporales, la función <code class="varname">tCentroid</code> generaliza la función <code class="varname">ST_Centroid</code> proporcionada por PostGIS. Por ejemplo, dado un conjunto de objetos que se mueven juntos (es decir, un convoy o una bandada), el centroide temporal producirá un punto temporal que representa en cada instante el centro geométrico (o el centro de masa) de todos los objetos en movimiento.</p></li></ul></div><p>En los ejemplos que siguen, suponemos que las tablas <code class="varname">Department</code> y <code class="varname">Trip</code> contienen las dos tuplas introducidas en la <a class="xref" href="ch04s02.html" title="Ejemplos de tipos temporales">“Ejemplos de tipos temporales”</a>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="tCount"></a><a class="indexterm" name="idm6025"></a><p>Conteo temporal</p><p><code class="varname">tCount(ttype) → {tintSeq,tintSeqSet}</code></p><pre class="programlisting">
SELECT tCount(NoEmps) FROM Department;
-- {[1@2001-01-01, 2@2001-02-01, 1@2001-08-01, 1@2001-10-01)}
</pre></li><li class="listitem"><a name="extent"></a><a class="indexterm" name="idm6033"></a><p>Extensión del cuadro delimitador</p><p><code class="varname">extent(temp) → {tstzspan,tbox,stbox}</code></p><pre class="programlisting">
SELECT extent(noEmps) FROM Department;
-- TBOX XT((4,12),[2001-01-01,2001-10-01])
SELECT extent(Trip) FROM Trips;
-- STBOX XT(((0,0),(3,3),[2001-01-01 08:00:00+01, 2001-01-01 08:20:00+01)))
</pre></li><li class="listitem"><a name="tAnd"></a><a class="indexterm" name="idm6041"></a><p>Y temporal</p><p><code class="varname">tAnd(tbool) → tbool</code></p><pre class="programlisting">
SELECT tAnd(NoEmps #&gt; 6) FROM Department;
-- {[t@2001-01-01, f@2001-04-01, f@2001-10-01)}
</pre></li><li class="listitem"><a name="tOr"></a><a class="indexterm" name="idm6049"></a><p>O temporal</p><p><code class="varname">tOr(tbool) → tbool</code></p><pre class="programlisting">
SELECT tOr(NoEmps #&gt; 6) FROM Department;
-- {[t@2001-01-01, f@2001-08-01, f@2001-10-01)}
</pre></li><li class="listitem"><a name="tMin"></a><a class="indexterm" name="idm6057"></a><p>Mínimo temporal</p><p><code class="varname">tMin(ttype) → ttype</code></p><pre class="programlisting">
SELECT tMin(NoEmps) FROM Department;
-- {[10@2001-01-01, 4@2001-02-01, 6@2001-06-01, 6@2001-10-01)}
</pre></li><li class="listitem"><a name="tMax"></a><a class="indexterm" name="idm6065"></a><p>Máximo temporal</p><p><code class="varname">tMax(ttype) → ttype</code></p><pre class="programlisting">
SELECT tMax(NoEmps) FROM Department;
-- {[10@2001-01-01, 12@2001-04-01, 6@2001-08-01, 6@2001-10-01)}
</pre></li><li class="listitem"><a name="tSum"></a><a class="indexterm" name="idm6073"></a><p>Suma temporal</p><p><code class="varname">tSum(tnumber) → {tnumberSeq,tnumberSeqSet}</code></p><pre class="programlisting">
SELECT tSum(NoEmps) FROM Department;
/* {[10@2001-01-01, 14@2001-02-01, 16@2001-04-01, 18@2001-06-01, 6@2001-08-01,
   6@2001-10-01)} */
</pre></li><li class="listitem"><a name="tAvg"></a><a class="indexterm" name="idm6081"></a><p>Promedio temporal</p><p><code class="varname">tAvg(tnumber) → {tfloatSeq,tfloatSeqSet}</code></p><pre class="programlisting">
SELECT tAvg(NoEmps) FROM Department;
/* {[10@2001-01-01, 10@2001-02-01), [7@2001-02-01, 7@2001-04-01),
   [8@2001-04-01, 8@2001-06-01), [9@2001-06-01, 9@2001-08-01),
   [6@2001-08-01, 6@2001-10-01) */
</pre></li><li class="listitem"><a name="wMin"></a><a class="indexterm" name="idm6089"></a><p>Mínimo de ventana</p><p><code class="varname">wMin(tnumber,interval) → {tnumberSeq,tnumberSeqSet}</code></p><pre class="programlisting">
SELECT wMin(NoEmps, interval '2 days') FROM Department;
-- {[10@2001-01-01, 4@2001-04-01, 6@2001-06-03, 6@2001-10-03)}
</pre></li><li class="listitem"><a name="wMax"></a><a class="indexterm" name="idm6097"></a><p>Máximo de ventana</p><p><code class="varname">wMax(tnumber,interval) → {tnumberSeq,tnumberSeqSet}</code></p><pre class="programlisting">
SELECT wMax(NoEmps, interval '2 days') FROM Department;
-- {[10@2001-01-01, 12@2001-04-01, 6@2001-08-03, 6@2001-10-03)}
</pre></li><li class="listitem"><a name="wCount"></a><a class="indexterm" name="idm6105"></a><p>Conteo de ventana</p><p><code class="varname">wCount(tnumber,interval) → {tintSeq,tintSeqSet}</code></p><pre class="programlisting">
SELECT wCount(NoEmps, interval '2 days') FROM Department;
/* {[1@2001-01-01, 2@2001-02-01, 3@2001-04-01, 2@2001-04-03, 3@2001-06-01, 2@2001-06-03,
   1@2001-08-03, 1@2001-10-03)} */
</pre></li><li class="listitem"><a name="wSum"></a><a class="indexterm" name="idm6113"></a><p>Suma de ventana</p><p><code class="varname">wSum(tint,interval) → {tintSeq,tintSeqSet}</code></p><pre class="programlisting">
SELECT wSum(NoEmps, interval '2 days') FROM Department;
/* {[10@2001-01-01, 14@2001-02-01, 26@2001-04-01, 16@2001-04-03, 22@2001-06-01,
   18@2001-06-03, 6@2001-08-03, 6@2001-10-03)} */
</pre></li><li class="listitem"><a name="wAvg"></a><a class="indexterm" name="idm6121"></a><p>Promedio de ventana</p><p><code class="varname">wAvg(tint,interval) → {tfloatDiscSeq,tfloatSeqSet}</code></p><pre class="programlisting">
SELECT wAvg(NoEmps, interval '2 days') FROM Department;
/* {[10@2001-01-01, 10@2001-02-01), [7@2001-02-01, 7@2001-04-01),
   [8.66666666666667@2001-04-01, 8.66666666666667@2001-04-03),
   [8@2001-04-03, 8@2001-06-01),
   [7.33333333333333@2001-06-01, 7.33333333333333@2001-06-03),
   [9@2001-06-03, 9@2001-08-03), [6@2001-08-03, 6@2001-10-03)} */
</pre></li><li class="listitem"><a name="tCentroid"></a><a class="indexterm" name="idm6129"></a><p>Centroide temporal</p><p><code class="varname">tCentroid(tgeompoint) → tgeompoint</code></p><pre class="programlisting">
SELECT tCentroid(Trip) FROM Trips;
/* {[POINT(0 0)@2001-01-01 08:00:00+00, POINT(1 0)@2001-01-01 08:05:00+00),
   [POINT(0.5 0)@2001-01-01 08:05:00+00, POINT(1.5 0.5)@2001-01-01 08:10:00+00,
   POINT(2 1.5)@2001-01-01 08:15:00+00),
   [POINT(2 2)@2001-01-01 08:15:00+00, POINT(3 3)@2001-01-01 08:20:00+00)} */
</pre></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch09s05.html">Anterior</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch10s02.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Mosaicos multidimensionales </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Indexación</td></tr></table></div></body></html>
