<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Operadores de cuadro delimitador</title><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"><link rel="home" href="index.html" title="MobilityDB 1.1 Manual de usuario"><link rel="up" href="ch06.html" title="Capítulo 6. Tipos temporales: Operaciones genéricas (Parte 2)"><link rel="prev" href="ch06s03.html" title="Comparaciones"><link rel="next" href="ch06s05.html" title="Funciones de utilidad"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Operadores de cuadro delimitador</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch06s03.html">Anterior</a> </td><th width="60%" align="center">Capítulo 6. Tipos temporales: Operaciones genéricas (Parte 2)</th><td width="20%" align="right"> <a accesskey="n" href="ch06s05.html">Siguiente</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="temporal_types_bbox"></a>Operadores de cuadro delimitador</h2></div></div></div><p>Al crear índices para tipos temporales, lo que se almacena en el índice no es el valor real sino un cuadro delimitador que representa el valor. En este caso, el índice proporcionará una lista de valores candidatos que <span class="emphasis"><em>pueden</em></span> satisfacer el predicado de la consulta, y se necesita un segundo paso para filtrar los valores candidatos calculando el predicado de la consulta sobre los valores reales.</p><p>Sin embargo, cuando los cuadros delimitadores tienen un gran espacio vacío no cubierto por los valores reales, el índice generará muchos valores candidatos que no satisfacen el predicado de la consulta, lo que reduce la eficiencia del índice. En estas situaciones, puede ser mejor representar un valor no con un cuadro delimitador <span class="emphasis"><em>único</em></span>, sino con <span class="emphasis"><em>múltiples</em></span> cuadros delimitadores. Esto aumenta considerablemente la eficiencia del índice, siempre que el índice sea capaz de gestionar múltiples cuadros delimitadores por valor. Las siguientes funciones se utilizan para generar múltiples cuadros delimitadores para un único valor temporal.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="temporal_spans_merge"></a><a class="indexterm" name="idm3751"></a><p>Devuelve una matriz de rangos temporales a partir de los instantes o segmentos de un valor temporal</p><p><code class="varname">spansMerge(temp, max_count = 0) → spans[]</code></p><p>Si no se especifica el último argumento, la matriz resultante tendrá un rango por instante o segmento del valor temporal, dependiendo de si la interpolación es discreta o continua. En caso contrario, el número de rangos especificado se obtendrá fusionando instantes o segmentos consecutivos.</p><pre class="programlisting">
SELECT spansMerge(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04,
  A@2000-01-05}');
/* {"[2000-01-01, 2000-01-01]", "[2000-01-02, 2000-01-02]",
    "[2000-01-03, 2000-01-03]", "[2000-01-04, 2000-01-04]"} */
SELECT spansMerge(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04,
  1@2000-01-05]');
/* {"[2000-01-01, 2000-01-02])", "[2000-01-02, 2000-01-03])",
    "[2000-01-03, 2000-01-04])", "[2000-01-04, 2000-01-05])"} */
SELECT spansMerge(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04,
  A@2000-01-05]', 3);
/* {"[2000-01-01, 2000-01-03])", "[2000-01-03, 2000-01-04])",
    "[2000-01-04, 2000-01-05])"} */
SELECT spansMerge(tgeompoint '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02], 
  [Point(1 1)@2000-01-03, Point(2 2)@2000-01-04], [Point(1 1)@2000-01-05]}', 2);
-- {"[2000-01-01, 2000-01-04])", "[2000-01-05, 2000-01-05])"}
</pre></li><li class="listitem"><a name="tboxes_merge"></a><a class="indexterm" name="idm3760"></a><p>Devuelve una matriz de cuadros temporales a partir de los instantes o segmentos de un número temporal</p><p><code class="varname">tboxesMerge(tnumber, max_count = 0) → tbox[]</code></p><p>Si no se especifica el último argumento, la matriz resultante tendrá un cuadro por instante o segmento del número temporal, dependiendo de si la interpolación es discreta o continua. En caso contrario, el número de cuadros especificado se obtendrá fusionando instantes o segmentos consecutivos.</p><pre class="programlisting">
SELECT tboxesMerge(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 4@2000-01-04,
  1@2000-01-05}');
/* {"TBOXINT XT([1, 2),[2000-01-01, 2000-01-01])",
    "TBOXINT XT([2, 3),[2000-01-02, 2000-01-02])",
    "TBOXINT XT([1, 2),[2000-01-03, 2000-01-03])",
    "TBOXINT XT([4, 5),[2000-01-04, 2000-01-04])"} */
SELECT tboxesMerge(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 4@2000-01-04,
  1@2000-01-05]');
/* {"TBOXINT XT([1, 3),[2000-01-01, 2000-01-02])",
    "TBOXINT XT([1, 3),[2000-01-02, 2000-01-03])",
    "TBOXINT XT([1, 5),[2000-01-03, 2000-01-04])",
    "TBOXINT XT([1, 5),[2000-01-04, 2000-01-05])"} */
SELECT tboxesMerge(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 4@2000-01-04,
  1@2000-01-05]', 3);
/* {"TBOXFLOAT XT([1, 2],[2000-01-01, 2000-01-03])",
    "TBOXFLOAT XT([1, 4],[2000-01-03, 2000-01-04])",
    "TBOXFLOAT XT([1, 4],[2000-01-04, 2000-01-05])"} */
SELECT tboxesMerge(tfloat '{[1@2000-01-01, 2@2000-01-02], [1@2000-01-03, 4@2000-01-04],
  [1@2000-01-05]}', 2);
/* {"TBOXFLOAT XT([1, 4],[2000-01-01, 2000-01-04])",
    "TBOXFLOAT XT([1, 1],[2000-01-05, 2000-01-05])"} */
</pre></li><li class="listitem"><a name="stboxes_merge"></a><a class="indexterm" name="idm3769"></a><p>Devuelve ya sea una matriz de cuadros espaciales a partir de los segmentos de una (multi)línea o una matriz de cuadros espaciotemporales a partir de los instantes o segmentos de un punto temporal</p><p><code class="varname">stboxesMerge(lines, max_count = 0) → stbox[]</code></p><p><code class="varname">stboxesMerge(tpoint, max_count = 0) → stbox[]</code></p><p>Si no se especifica el último argumento, la matriz resultante tendrá un cuadro por segmento de la (multi)línea o por instante o segmento del punto temporal, dependiendo de si la interpolación es discreta o continua. En caso contrario, el número de cuadros especificado se obtendrá fusionando instantes o segmentos consecutivos.</p><pre class="programlisting">
SELECT stboxesMerge(geometry 'Linestring(1 1,2 2,3 1,4 2,5 1)');
/* {"STBOX X((1,1),(2,2))","STBOX X((2,1),(3,2))",
    "STBOX X((3,1),(4,2))","STBOX X((4,1),(5,2))"} */
SELECT stboxesMerge(geometry 'Linestring(1 1,2 2,3 1,4 2,5 1)', 2);
-- {"STBOX X((1,1),(3,2))","STBOX X((3,1),(5,2))"}
SELECT stboxesMerge(geometry 'MultiLinestring((1 1,2 2),(3 1,4 2),(5 1,6 2))', 2);
-- {"STBOX X((1,1),(4,2))","STBOX X((5,1),(6,2))"}
</pre><pre class="programlisting">
SELECT stboxesMerge(tgeompoint '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, 
  Point(3 1)@2000-01-03, Point(4 2)@2000-01-04, Point(5 1)@2000-01-05}');
/* {"STBOX XT(((1,1),(1,1)),[2000-01-01, 2000-01-01])",
    "STBOX XT(((2,2),(2,2)),[2000-01-02, 2000-01-02])",
    "STBOX XT(((3,3),(3,3)),[2000-01-03, 2000-01-03])",
    "STBOX XT(((4,4),(4,4)),[2000-01-04, 2000-01-04])"} */
SELECT stboxesMerge(tgeompoint '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02,
  Point(3 1)@2000-01-03, Point(4 2)@2000-01-04, Point(5 1)@2000-01-05]');
/* {"STBOX XT(((1,1),(2,2)),[2000-01-01, 2000-01-02])",
    "STBOX XT(((2,1),(3,2)),[2000-01-02, 2000-01-03])",
    "STBOX XT(((3,1),(4,2)),[2000-01-03, 2000-01-04])",
    "STBOX XT(((4,1),(5,2)),[2000-01-04, 2000-01-05])"} */
SELECT stboxesMerge(tgeompoint '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02], 
  [Point(3 1)@2000-01-03, Point(4 2)@2000-01-04], [Point(5 1)@2000-01-05]}', 2);
/* {"STBOX XT(((1,1),(4,2)),[2000-01-01, 2000-01-04])",
    "STBOX XT(((5,1),(5,1)),[2000-01-05, 2000-01-05])"} */
</pre></li></ul></div><p>Otros operadores de cuadro delimitador determinan si los cuadros delimitadores de sus argumentos satisfacen el predicado y dan como resultado un valor booleano. Como se indica en el <a class="xref" href="ch04.html" title="Capítulo 4. Tipos temporales">Capítulo 4, <i>Tipos temporales</i></a>, el cuadro delimitador asociado a un tipo temporal depende del tipo base: es el tipo <code class="varname">tstzspan</code> para los tipos <code class="varname">tbool</code> y <code class="varname">ttext</code>, el tipo <code class="varname">tbox</code> para los tipos <code class="varname">tint</code> y <code class="varname">tfloat</code> y el tipo <code class="varname">stbox</code> para los tipos <code class="varname">tgeompoint</code> y <code class="varname">tgeogpoint</code>. Además, como se dijo en la <a class="xref" href="ch03s03.html" title="Conversiones de tipo">“Conversiones de tipo”</a>, muchos tipos PostgreSQL, PostGIS o MobilityDB se pueden convertir a los tipos <code class="varname">tbox</code> y <code class="varname">stbox</code>. Por ejemplo, los tipos numéricos y los rangos se pueden convertir al tipo <code class="varname">tbox</code>, los tipos <code class="varname">geometry</code> y <code class="varname">geography</code> se pueden convertir al tipo <code class="varname">stbox</code> y los tipos de tiempo y los tipos temporales se pueden convertir a los tipos <code class="varname">tbox</code> y <code class="varname">stbox</code>.</p><p>Un primer conjunto de operadores considera las relaciones topológicas entre los cuadros delimitadores. Hay cinco operadores topológicos: superposición (<code class="varname">&amp;&amp;</code>), contiene (<code class="varname">@&gt;</code>), está contenido (<code class="varname">&lt;@</code>), mismo (<code class="varname">~=</code>) y adyacente (<code class="varname">-|-</code>). Los argumentos de estos operadores pueden ser un tipo base, una cuadro delimitador o un tipo temporal y los operadores verifican la relación topológica teniendo en cuenta el valor y/o la dimensión temporal según el tipo de los argumentos.</p><p>Otro conjunto de operadores considera la posición relativa de los cuadros delimitadores. Los operadores <code class="varname">&lt;&lt;</code>, <code class="varname">&gt;&gt;</code>, <code class="varname">&amp;&lt;</code> y <code class="varname">&amp;&gt;</code> consideran la dimensión de valor para los tipos <code class="varname">tint</code> y <code class="varname">tfloat</code> y las coordenadas X para los tipos <code class="varname">tgeompoint</code> y <code class="varname">tgeogpoint</code>, los operadores <code class="varname">&lt;&lt;|</code>, <code class="varname">|&gt;&gt;</code>, <code class="varname">&amp;&lt;|</code> y <code class="varname">|&amp;&gt;</code> consideran las coordenadas Y para los tipos <code class="varname">tgeompoint</code> y <code class="varname">tgeogpoint</code>, los operadores <code class="varname">&lt;&lt;/</code>, <code class="varname">/&gt;&gt;</code>, <code class="varname">&amp;&lt;/</code> y <code class="varname">/&amp;&gt;</code> consideran las coordenadas Z para los tipos <code class="varname">tgeompoint</code> y <code class="varname">tgeogpoint</code> y los operadores <code class="varname">&lt;&lt;#</code>, <code class="varname">#&gt;&gt;</code>, <code class="varname">#&amp;&lt;</code> y <code class="varname">#&amp;&gt;</code> consideran la dimensión tiempo para todos los tipos temporales.</p><p>Finalmente, cabe destacar que los operadores de cuadro delimitador permiten mezclar geometrías 2D/3D pero en ese caso, el cálculo sólo se realiza en 2D.</p><p>Refiérase a la <a class="xref" href="ch03s09.html" title="Operaciones de cuadro delimitador">“Operaciones de cuadro delimitador”</a> para los operadores de cuadro delimitador.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch06s03.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="ch06.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="ch06s05.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Comparaciones </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Funciones de utilidad</td></tr></table></div></body></html>
