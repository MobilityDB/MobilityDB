SELECT SRID(geomset '{"SRID=5676;Point(1 1)", "SRID=5676;Point(2 2)"}');
 srid 
------
 5676
(1 row)

SELECT asEWKT(setSRID(geomset '{"Point(0 0)", "Point(1 1)"}', 5676));
                 asewkt                 
----------------------------------------
 SRID=5676;{"POINT(0 0)", "POINT(1 1)"}
(1 row)

WITH test(geoset) AS (
  SELECT geomset 'SRID=4326;{"Point(1.0 2.0 3.0)","Point(4.0 5.0 6.0)"}' )
SELECT asEWKT(transform(transform(geoset, 5676), 4326), 6) FROM test;
                      asewkt                      
--------------------------------------------------
 SRID=4326;{"POINT Z (1 2 3)", "POINT Z (4 5 6)"}
(1 row)

SELECT asEWKT(transform(geomset 'SRID=4326;{"Point(1.0 2.0 3.0)","Point(4.0 5.0 6.0)"}', 4326));
                      asewkt                      
--------------------------------------------------
 SRID=4326;{"POINT Z (1 2 3)", "POINT Z (4 5 6)"}
(1 row)

WITH test(geoset) AS (
  SELECT geomset 'SRID=4326;{"Point(1.0 2.0 3.0)","Point(4.0 5.0 6.0)"}' )
SELECT asEWKT(transform(transform(geoset, 102004), 4326), 6) FROM test;
                      asewkt                      
--------------------------------------------------
 SRID=4326;{"POINT Z (1 2 3)", "POINT Z (4 5 6)"}
(1 row)

WITH test(geoset) AS (
  SELECT geomset 'SRID=909090;{"Point(1.0 2.0 3.0)","Point(4.0 5.0 6.0)"}' )
SELECT asEWKT(transform(transform(geoset, 102004), 909090), 6) FROM test;
ERROR:  Transform: Could not form projection from 'srid=909090'
WITH test(geoset) AS (
  SELECT geomset 'SRID=4326;{"Point(1.0 2.0 3.0)","Point(4.0 5.0 6.0)"}' )
SELECT asEWKT(transform(transform(geoset, 909090), 4326), 6) FROM test;
ERROR:  Transform: Could not form projection to 'srid=909090'
SELECT SRID(stbox 'STBOX ZT(((1.0,2.0,3.0),(4.0,5.0,6.0)),[2000-01-01,2000-01-02])');
 srid 
------
    0
(1 row)

SELECT SRID(stbox 'SRID=4326;STBOX ZT(((1.0,2.0,3.0),(4.0,5.0,6.0)),[2000-01-01,2000-01-02])');
 srid 
------
 4326
(1 row)

/* Errors */
SELECT SRID(stbox 'STBOX T([2000-01-01,2000-01-02])');
ERROR:  The stbox must have X dimension
SELECT setSRID(stbox 'STBOX X((1,1),(2,2))', 5676);
            setsrid             
--------------------------------
 SRID=5676;STBOX X((1,1),(2,2))
(1 row)

SELECT setSRID(stbox 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])', 5676);
                                            setsrid                                             
------------------------------------------------------------------------------------------------
 SRID=5676;STBOX XT(((1,1),(2,2)),[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])
(1 row)

SELECT setSRID(stbox 'STBOX Z((1,1,1),(2,2,2))', 5676);
              setsrid               
------------------------------------
 SRID=5676;STBOX Z((1,1,1),(2,2,2))
(1 row)

SELECT setSRID(stbox 'STBOX ZT(((1,1,1),(2,2,2)),[2000-01-01,2000-01-02])', 5676);
                                              setsrid                                               
----------------------------------------------------------------------------------------------------
 SRID=5676;STBOX ZT(((1,1,1),(2,2,2)),[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])
(1 row)

SELECT setSRID(stbox 'GEODSTBOX Z((1,1,1),(2,2,2))', 4326);
                setsrid                 
----------------------------------------
 SRID=4326;GEODSTBOX Z((1,1,1),(2,2,2))
(1 row)

SELECT setSRID(stbox 'GEODSTBOX ZT(((1,1,1),(2,2,2)),[2000-01-01,2000-01-02])', 4326);
                                                setsrid                                                 
--------------------------------------------------------------------------------------------------------
 SRID=4326;GEODSTBOX ZT(((1,1,1),(2,2,2)),[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])
(1 row)

/* Errors */
SELECT setSRID(stbox 'STBOX T([2000-01-01,2000-01-02])', 5676);
ERROR:  The stbox must have X dimension
SELECT setSRID(stbox 'GEODSTBOX T([2000-01-01,2000-01-02])', 4326);
ERROR:  The stbox must have X dimension
SELECT round(transform(transform(stbox 'SRID=4326;STBOX X((1,1),(2,2))', 5676), 4326), 1);
             round              
--------------------------------
 SRID=4326;STBOX X((1,1),(2,2))
(1 row)

SELECT round(transform(transform(stbox 'SRID=4326;STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])', 5676), 4326), 1);
                                             round                                              
------------------------------------------------------------------------------------------------
 SRID=4326;STBOX XT(((1,1),(2,2)),[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])
(1 row)

SELECT round(transform(transform(stbox 'SRID=4326;STBOX Z((1,1,1),(2,2,2))', 5676), 4326), 1);
               round                
------------------------------------
 SRID=4326;STBOX Z((1,1,1),(2,2,2))
(1 row)

SELECT round(transform(transform(stbox 'SRID=4326;STBOX ZT(((1,1,1),(2,2,2)),[2000-01-01,2000-01-02])', 5676), 4326), 1);
                                               round                                                
----------------------------------------------------------------------------------------------------
 SRID=4326;STBOX ZT(((1,1,1),(2,2,2)),[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])
(1 row)

SELECT round(transform(transform(stbox 'SRID=4326;GEODSTBOX Z((1,1,1),(2,2,2))', 4269), 4326), 1);
                 round                  
----------------------------------------
 SRID=4326;GEODSTBOX Z((1,1,1),(2,2,2))
(1 row)

SELECT round(transform(transform(stbox 'SRID=4326;GEODSTBOX ZT(((1,1,1),(2,2,2)),[2000-01-01,2000-01-02])', 4269), 4326), 1);
                                                 round                                                  
--------------------------------------------------------------------------------------------------------
 SRID=4326;GEODSTBOX ZT(((1,1,1),(2,2,2)),[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])
(1 row)

SELECT DISTINCT SRID(b) FROM tbl_stbox;
 srid 
------
    0
(1 row)

SELECT MIN(xmin(setSRID(b,4326))) FROM tbl_stbox;
   min    
----------
 0.512863
(1 row)

SELECT ROUND(MIN(xmin(transform(transform(setSRID(b,5676), 4326), 5676)))::numeric, 1) FROM tbl_stbox;
 round 
-------
   0.5
(1 row)

SELECT MIN(xmin(round(transform(transform(setSRID(b,5676), 4326), 5676), 1))) FROM tbl_stbox;
 min 
-----
 0.5
(1 row)

SELECT transform(stbox 'SRID=4326;STBOX X((1,1),(2,2))', 4326);
           transform            
--------------------------------
 SRID=4326;STBOX X((1,1),(2,2))
(1 row)

/* Errors */
SELECT transform(stbox 'SRID=4326;STBOX X((1,1),(2,2))', 0);
ERROR:  The SRID cannot be unknown
SELECT SRID(tgeometry 'Point(1 1)@2000-01-01');
 srid 
------
    0
(1 row)

SELECT SRID(tgeometry '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03}');
 srid 
------
    0
(1 row)

SELECT SRID(tgeometry '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03]');
 srid 
------
    0
(1 row)

SELECT SRID(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}');
 srid 
------
    0
(1 row)

SELECT SRID(tgeography 'Point(1.5 1.5)@2000-01-01');
 srid 
------
 4326
(1 row)

SELECT SRID(tgeography '{Point(1.5 1.5)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.5 1.5)@2000-01-03}');
 srid 
------
 4326
(1 row)

SELECT SRID(tgeography '[Point(1.5 1.5)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.5 1.5)@2000-01-03]');
 srid 
------
 4326
(1 row)

SELECT SRID(tgeography '{[Point(1.5 1.5)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.5 1.5)@2000-01-03],[Point(3.5 3.5)@2000-01-04, Point(3.5 3.5)@2000-01-05]}');
 srid 
------
 4326
(1 row)

SELECT SRID(tgeometry 'Point(1 1 1)@2000-01-01');
 srid 
------
    0
(1 row)

SELECT SRID(tgeometry '{Point(1 1 1)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 1 1)@2000-01-03}');
 srid 
------
    0
(1 row)

SELECT SRID(tgeometry '[Point(1 1 1)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 1 1)@2000-01-03]');
 srid 
------
    0
(1 row)

SELECT SRID(tgeometry '{[Point(1 1 1)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 1 1)@2000-01-03],[Point(3 3 3)@2000-01-04, Point(3 3 3)@2000-01-05]}');
 srid 
------
    0
(1 row)

SELECT SRID(tgeography 'Point(1.5 1.5 1.5)@2000-01-01');
 srid 
------
 4326
(1 row)

SELECT SRID(tgeography '{Point(1.5 1.5 1.5)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.5 1.5 1.5)@2000-01-03}');
 srid 
------
 4326
(1 row)

SELECT SRID(tgeography '[Point(1.5 1.5 1.5)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.5 1.5 1.5)@2000-01-03]');
 srid 
------
 4326
(1 row)

SELECT SRID(tgeography '{[Point(1.5 1.5 1.5)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.5 1.5 1.5)@2000-01-03],[Point(3.5 3.5 3.5)@2000-01-04, Point(3.5 3.5 3.5)@2000-01-05]}');
 srid 
------
 4326
(1 row)

SELECT asEWKT(setSRID(tgeometry 'Point(1 1 1)@2000-01-01', 5676));
                         asewkt                         
--------------------------------------------------------
 SRID=5676;POINT Z (1 1 1)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asEWKT(setSRID(tgeometry '{Point(1 1 1)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 1 1)@2000-01-03}', 5676));
                                                                        asewkt                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=5676;{POINT Z (1 1 1)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2 2 2)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1 1 1)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asEWKT(setSRID(tgeometry '[Point(1 1 1)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 1 1)@2000-01-03]', 5676));
                                                                        asewkt                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=5676;[POINT Z (1 1 1)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2 2 2)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1 1 1)@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT asEWKT(setSRID(tgeometry '{[Point(1 1 1)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 1 1)@2000-01-03],[Point(3 3 3)@2000-01-04, Point(3 3 3)@2000-01-05]}', 5676));
                                                                                                                        asewkt                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=5676;{[POINT Z (1 1 1)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2 2 2)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1 1 1)@Mon Jan 03 00:00:00 2000 PST], [POINT Z (3 3 3)@Tue Jan 04 00:00:00 2000 PST, POINT Z (3 3 3)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT asEWKT(setSRID(tgeography 'Point(1.5 1.5 1.5)@2000-01-01', 4269));
                            asewkt                            
--------------------------------------------------------------
 SRID=4269;POINT Z (1.5 1.5 1.5)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asEWKT(setSRID(tgeography '{Point(1.5 1.5 1.5)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.5 1.5 1.5)@2000-01-03}', 4269));
                                                                                 asewkt                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=4269;{POINT Z (1.5 1.5 1.5)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2.5 2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1.5 1.5 1.5)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asEWKT(setSRID(tgeography '[Point(1.5 1.5 1.5)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.5 1.5 1.5)@2000-01-03]', 4269));
                                                                                 asewkt                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=4269;[POINT Z (1.5 1.5 1.5)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2.5 2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1.5 1.5 1.5)@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT asEWKT(setSRID(tgeography '{[Point(1.5 1.5 1.5)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.5 1.5 1.5)@2000-01-03],[Point(3.5 3.5 3.5)@2000-01-04, Point(3.5 3.5 3.5)@2000-01-05]}', 4269));
                                                                                                                                       asewkt                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=4269;{[POINT Z (1.5 1.5 1.5)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2.5 2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1.5 1.5 1.5)@Mon Jan 03 00:00:00 2000 PST], [POINT Z (3.5 3.5 3.5)@Tue Jan 04 00:00:00 2000 PST, POINT Z (3.5 3.5 3.5)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT startValue(transform(tgeometry 'SRID=5676;Point(1 2 3)@2000-01-01', 4326)) = st_transform(geometry 'SRID=5676;Point(1 2 3)', 4326);
 ?column? 
----------
 t
(1 row)

SELECT startValue(transform(tgeometry 'SRID=5676;{Point(1 2 3)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 2 3)@2000-01-03}', 4326)) = st_transform(geometry 'SRID=5676;Point(1 2 3)', 4326);
 ?column? 
----------
 t
(1 row)

SELECT startValue(transform(tgeometry 'SRID=5676;[Point(1 2 3)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 2 3)@2000-01-03]', 4326)) = st_transform(geometry 'SRID=5676;Point(1 2 3)', 4326);
 ?column? 
----------
 t
(1 row)

SELECT startValue(transform(tgeometry 'SRID=5676;{[Point(1 2 3)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 2 3)@2000-01-03],[Point(3 3 3)@2000-01-04, Point(3 3 3)@2000-01-05]}', 4326)) = st_transform(geometry 'SRID=5676;Point(1 2 3)', 4326);
 ?column? 
----------
 t
(1 row)

SELECT startValue(transform(tgeometry 'SRID=5676;Point(1 2 3)@2000-01-01', 5676)) = st_transform(geometry 'SRID=5676;Point(1 2 3)', 5676);
 ?column? 
----------
 t
(1 row)

SELECT startValue(transform(tgeometry 'SRID=5676;Point(1 2 3)@2000-01-01', 4326)) = st_transform(geometry 'SRID=4326;Point(1 2 3)', 4326);
 ?column? 
----------
 f
(1 row)

WITH test(geoset, pipeline) AS (
  SELECT geomset 'SRID=4326;{"Point(1.0 2.0 3.0)","Point(4.0 5.0 6.0)"}',
   text 'urn:ogc:def:coordinateOperation:EPSG::16031' )
SELECT asText(transformPipeline(transformPipeline(geoset, pipeline, 4326), pipeline, 4326, false), 3) = asText(geoset, 3)
FROM test;
 ?column? 
----------
 t
(1 row)

WITH test(box, pipeline) AS (
  SELECT tgeometry 'SRID=4326;[POINT(2.123456 49.123456)@2000-01-01, POINT(3.123456 50.123456)@2000-01-02]'::stbox,
   text 'urn:ogc:def:coordinateOperation:EPSG::16031' )
SELECT asText(transformPipeline(transformPipeline(box, pipeline, 4326), pipeline, 4326, false), 3) = asText(box, 3)
FROM test;
 ?column? 
----------
 t
(1 row)

SELECT asText(transformPipeline(tgeometry 'SRID=4326;POINT(2 49)@2000-01-01',
  text 'urn:ogc:def:coordinateOperation:EPSG::16031'));
                                 astext                                  
-------------------------------------------------------------------------
 POINT(426857.9877165967 5427937.523342293)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(transformPipeline(tgeometry 'POINT(426857.9877165967 5427937.523342293)@2000-01-01 00:00:00+01',
  text 'urn:ogc:def:coordinateOperation:EPSG::16031', 4326, false), 3);
                  astext                  
------------------------------------------
 POINT(2 49)@Fri Dec 31 15:00:00 1999 PST
(1 row)

WITH test1(pipeline) AS (
  SELECT text 'urn:ogc:def:coordinateOperation:EPSG::16031' ),
test2(temp) AS (
  SELECT tgeometry 'SRID=4326;POINT(2.123456 49.123456)@2000-01-01' UNION
  SELECT tgeometry 'SRID=4326;{POINT(2.123456 49.123456)@2000-01-01, POINT(3.123456 50.123456)@2000-01-02}' UNION
  SELECT tgeometry 'SRID=4326;[POINT(2.123456 49.123456)@2000-01-01, POINT(3.123456 50.123456)@2000-01-02]' UNION
  SELECT tgeometry 'SRID=4326;{[POINT(2.123456 49.123456)@2000-01-01, POINT(3.123456 50.123456)@2000-01-02],'
    '[POINT(2.123456 49.123456)@2000-01-03, POINT(3.123456 50.123456)@2000-01-04]}'
    )
SELECT DISTINCT asText(transformPipeline(transformPipeline(temp, pipeline, 4326), pipeline, 4326, false), 3) = asText(temp, 3)
FROM test1, test2;
 ?column? 
----------
 t
(1 row)

SELECT ST_AsText(round(geometry 'Point(1.123456789 1.123456789)', 6));
        st_astext         
--------------------------
 POINT(1.123457 1.123457)
(1 row)

SELECT ST_AsText(round(geometry 'Linestring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789)', 6));
                             st_astext                             
-------------------------------------------------------------------
 LINESTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457)
(1 row)

SELECT ST_AsText(round(geometry 'Triangle((1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 1.123456789,1.123456789 1.123456789))', 6));
                                      st_astext                                      
-------------------------------------------------------------------------------------
 TRIANGLE((1.123457 1.123457,2.123457 2.123457,3.123457 1.123457,1.123457 1.123457))
(1 row)

SELECT ST_AsText(round(geometry 'Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789)', 6));
                               st_astext                               
-----------------------------------------------------------------------
 CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457)
(1 row)

SELECT ST_AsText(round(geometry 'CompoundCurve(Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),(3.123456789 3.123456789, 4.123456789 4.123456789))', 6));
                                                         st_astext                                                          
----------------------------------------------------------------------------------------------------------------------------
 COMPOUNDCURVE(CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),(3.123457 3.123457,4.123457 4.123457))
(1 row)

SELECT ST_AsText(round(geometry 'Multicurve(Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),(3.123456789 3.123456789,2.123456789 2.123456789,1.123456789 1.123456789),CompoundCurve(Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),(3.123456789 3.123456789, 4.123456789 4.123456789)))', 6));
                                                                                                                              st_astext                                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 MULTICURVE(CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),(3.123457 3.123457,2.123457 2.123457,1.123457 1.123457),COMPOUNDCURVE(CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),(3.123457 3.123457,4.123457 4.123457)))
(1 row)

SELECT ST_AsText(round(geometry 'Polygon((1.123456789 1.123456789,4.123456789 4.123456789,7.123456789 1.123456789,1.123456789 1.123456789),(3.123456789 2.123456789,4.123456789 3.123456789,5.123456789 2.123456789,3.123456789 2.123456789))', 6));
                                                                          st_astext                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 POLYGON((1.123457 1.123457,4.123457 4.123457,7.123457 1.123457,1.123457 1.123457),(3.123457 2.123457,4.123457 3.123457,5.123457 2.123457,3.123457 2.123457))
(1 row)

SELECT ST_AsText(round(geometry 'CurvePolygon(Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,1.123456789 1.123456789),(2.123456789 2.123456789,1.123456789 2.123456789,2.123456789 1.123456789,2.123456789 2.123456789))', 6));
                                                                           st_astext                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 CURVEPOLYGON(CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,1.123457 1.123457),(2.123457 2.123457,1.123457 2.123457,2.123457 1.123457,2.123457 2.123457))
(1 row)

SELECT ST_AsText(round(geometry 'CurvePolygon(CompoundCurve(Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),(3.123456789 3.123456789, 4.123456789 4.123456789,1.123456789 1.123456789)))', 6));
                                                                         st_astext                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------
 CURVEPOLYGON(COMPOUNDCURVE(CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),(3.123457 3.123457,4.123457 4.123457,1.123457 1.123457)))
(1 row)

SELECT ST_NPoints(round(geometry 'MultiPoint((1.123456789 1.123456789),(2.123456789 2.123456789),(3.123456789 3.123456789))', 6));
 st_npoints 
------------
          3
(1 row)

SELECT array_agg(ST_AsText((dp).geom)) FROM (SELECT ST_DumpPoints(round(geometry 'MultiPoint((1.123456789 1.123456789),(2.123456789 2.123456789),(3.123456789 3.123456789))', 6))) AS t(dp);
                                     array_agg                                      
------------------------------------------------------------------------------------
 {"POINT(1.123457 1.123457)","POINT(2.123457 2.123457)","POINT(3.123457 3.123457)"}
(1 row)

SELECT ST_AsText(round(geometry 'MultiLinestring((1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),(4.123456789 4.123456789,5.123456789 5.123456789))', 6));
                                                   st_astext                                                    
----------------------------------------------------------------------------------------------------------------
 MULTILINESTRING((1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),(4.123457 4.123457,5.123457 5.123457))
(1 row)

SELECT ST_AsText(round(geometry 'MultiPolygon(((1.123456789 1.123456789,4.123456789 4.123456789,7.123456789 1.123456789,1.123456789 1.123456789)),((3.123456789 2.123456789,4.123456789 3.123456789,5.123456789 2.123456789,3.123456789 2.123456789)))', 6));
                                                                               st_astext                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 MULTIPOLYGON(((1.123457 1.123457,4.123457 4.123457,7.123457 1.123457,1.123457 1.123457)),((3.123457 2.123457,4.123457 3.123457,5.123457 2.123457,3.123457 2.123457)))
(1 row)

SELECT ST_AsText(round(geometry 'GeometryCollection(Point(1.123456789 1.123456789),
  Linestring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),
  Triangle((1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 1.123456789,1.123456789 1.123456789)),
  Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),
  Polygon((1.123456789 1.123456789,4.123456789 4.123456789,7.123456789 1.123456789,1.123456789 1.123456789),(3.123456789 2.123456789,4.123456789 3.123456789,5.123456789 2.123456789,3.123456789 2.123456789)))', 6));
                                                                                                                                                                                                               st_astext                                                                                                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GEOMETRYCOLLECTION(POINT(1.123457 1.123457),LINESTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),TRIANGLE((1.123457 1.123457,2.123457 2.123457,3.123457 1.123457,1.123457 1.123457)),CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),POLYGON((1.123457 1.123457,4.123457 4.123457,7.123457 1.123457,1.123457 1.123457),(3.123457 2.123457,4.123457 3.123457,5.123457 2.123457,3.123457 2.123457)))
(1 row)

SELECT ST_AsText(round(geometry 'GeometryCollection(
  MultiPoint(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),
  MultiLinestring((1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),(4.123456789 4.123456789,5.123456789 5.123456789)),
  MultiPolygon(((1.123456789 1.123456789,4.123456789 4.123456789,7.123456789 1.123456789,1.123456789 1.123456789)),((3.123456789 2.123456789,4.123456789 3.123456789,5.123456789 2.123456789,3.123456789 2.123456789))))', 6));
                                                                                                                                                                                    st_astext                                                                                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GEOMETRYCOLLECTION(MULTIPOINT((1.123457 1.123457),(2.123457 2.123457),(3.123457 3.123457)),MULTILINESTRING((1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),(4.123457 4.123457,5.123457 5.123457)),MULTIPOLYGON(((1.123457 1.123457,4.123457 4.123457,7.123457 1.123457,1.123457 1.123457)),((3.123457 2.123457,4.123457 3.123457,5.123457 2.123457,3.123457 2.123457))))
(1 row)

SELECT ST_AsText(round(geometry 'GeometryCollection(
  Multicurve(Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),(3.123456789 3.123456789,2.123456789 2.123456789,1.123456789 1.123456789)), 
  CompoundCurve(Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,3.123456789 3.123456789),(3.123456789 3.123456789, 4.123456789 4.123456789)), 
  CurvePolygon(Circularstring(1.123456789 1.123456789,2.123456789 2.123456789,1.123456789 1.123456789)))', 6));
                                                                                                                                                                                  st_astext                                                                                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GEOMETRYCOLLECTION(MULTICURVE(CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),(3.123457 3.123457,2.123457 2.123457,1.123457 1.123457)),COMPOUNDCURVE(CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,3.123457 3.123457),(3.123457 3.123457,4.123457 4.123457)),CURVEPOLYGON(CIRCULARSTRING(1.123457 1.123457,2.123457 2.123457,1.123457 1.123457)))
(1 row)

SELECT ST_AsText(round(geometry 'Point Empty', 6));
  st_astext  
-------------
 POINT EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'Linestring Empty', 6));
    st_astext     
------------------
 LINESTRING EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'Triangle Empty', 6));
   st_astext    
----------------
 TRIANGLE EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'Circularstring Empty', 6));
      st_astext       
----------------------
 CIRCULARSTRING EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'CompoundCurve Empty', 6));
      st_astext      
---------------------
 COMPOUNDCURVE EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'Polygon Empty', 6));
   st_astext   
---------------
 POLYGON EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'CurvePolygon Empty', 6));
     st_astext      
--------------------
 CURVEPOLYGON EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'MultiPoint Empty', 6));
    st_astext     
------------------
 MULTIPOINT EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'MultiLinestring Empty', 6));
       st_astext       
-----------------------
 MULTILINESTRING EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'MultiPolygon Empty', 6));
     st_astext      
--------------------
 MULTIPOLYGON EMPTY
(1 row)

SELECT ST_AsText(round(geometry 'Point Z(1.123456789 1.123456789 1.123456789)', 6));
              st_astext               
--------------------------------------
 POINT Z (1.123457 1.123457 1.123457)
(1 row)

SELECT ST_AsText(round(geometry 'Linestring Z(1.123456789 1.123456789 1.123456789,2.123456789 2.123456789 2.123456789,3.123456789 3.123456789 3.123456789)', 6));
                                            st_astext                                            
-------------------------------------------------------------------------------------------------
 LINESTRING Z (1.123457 1.123457 1.123457,2.123457 2.123457 2.123457,3.123457 3.123457 3.123457)
(1 row)

SELECT ST_AsText(round(geometry 'Triangle Z((1.123456789 1.123456789 1.123456789,2.123456789 2.123456789 2.123456789,3.123456789 1.123456789 1.123456789,1.123456789 1.123456789 1.123456789))', 6));
                                                         st_astext                                                          
----------------------------------------------------------------------------------------------------------------------------
 TRIANGLE Z ((1.123457 1.123457 1.123457,2.123457 2.123457 2.123457,3.123457 1.123457 1.123457,1.123457 1.123457 1.123457))
(1 row)

SELECT ST_AsText(round(geometry 'Circularstring Z(1.123456789 1.123456789 1.123456789,2.123456789 2.123456789 2.123456789,3.123456789 3.123456789 3.123456789)', 6));
                                              st_astext                                              
-----------------------------------------------------------------------------------------------------
 CIRCULARSTRING Z (1.123457 1.123457 1.123457,2.123457 2.123457 2.123457,3.123457 3.123457 3.123457)
(1 row)

SELECT ST_AsText(round(geometry 'Polygon Z((1.123456789 1.123456789 1.123456789,4.123456789 4.123456789 4.123456789,7.123456789 1.123456789 1.123456789,1.123456789 1.123456789 1.123456789),(3.123456789 2.123456789 2.123456789,4.123456789 3.123456789 3.123456789,5.123456789 2.123456789 2.123456789,3.123456789 2.123456789 2.123456789))', 6));
                                                                                                                st_astext                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 POLYGON Z ((1.123457 1.123457 1.123457,4.123457 4.123457 4.123457,7.123457 1.123457 1.123457,1.123457 1.123457 1.123457),(3.123457 2.123457 2.123457,4.123457 3.123457 3.123457,5.123457 2.123457 2.123457,3.123457 2.123457 2.123457))
(1 row)

SELECT array_agg(ST_AsText((dp).geom)) FROM (SELECT ST_DumpPoints(round(geometry 'MultiPoint Z(1.123456789 1.123456789 1.123456789,2.123456789 2.123456789 2.123456789,3.123456789 3.123456789 3.123456789)', 6))) AS t(dp);
                                                       array_agg                                                        
------------------------------------------------------------------------------------------------------------------------
 {"POINT Z (1.123457 1.123457 1.123457)","POINT Z (2.123457 2.123457 2.123457)","POINT Z (3.123457 3.123457 3.123457)"}
(1 row)

SELECT ST_AsText(round(geometry 'MultiLinestring Z((1.123456789 1.123456789 1.123456789,2.123456789 2.123456789 2.123456789,3.123456789 3.123456789 3.123456789),(4.123456789 4.123456789 4.123456789,5.123456789 5.123456789 5.123456789))', 6));
                                                                           st_astext                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 MULTILINESTRING Z ((1.123457 1.123457 1.123457,2.123457 2.123457 2.123457,3.123457 3.123457 3.123457),(4.123457 4.123457 4.123457,5.123457 5.123457 5.123457))
(1 row)

SELECT ST_AsText(round(geometry 'MultiPolygon Z(((1.123456789 1.123456789 1.123456789,4.123456789 4.123456789 4.123456789,7.123456789 1.123456789 1.123456789,1.123456789 1.123456789 1.123456789)),((3.123456789 2.123456789 2.123456789,4.123456789 3.123456789 3.123456789,5.123456789 2.123456789 2.123456789,3.123456789 2.123456789 2.123456789)))', 6));
                                                                                                                    st_astext                                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 MULTIPOLYGON Z (((1.123457 1.123457 1.123457,4.123457 4.123457 4.123457,7.123457 1.123457 1.123457,1.123457 1.123457 1.123457)),((3.123457 2.123457 2.123457,4.123457 3.123457 3.123457,5.123457 2.123457 2.123457,3.123457 2.123457 2.123457)))
(1 row)

/* Errors */
SELECT round(geometry '
POLYHEDRALSURFACE Z (
  ((0 0 0, 0 1 0, 1 1 0, 1 0 0, 0 0 0)),
  ((0 0 0, 0 1 0, 0 1 1, 0 0 1, 0 0 0)),
  ((0 0 0, 1 0 0, 1 0 1, 0 0 1, 0 0 0)),
  ((1 1 1, 1 0 1, 0 0 1, 0 1 1, 1 1 1)),
  ((1 1 1, 1 0 1, 1 0 0, 1 1 0, 1 1 1)),
  ((1 1 1, 1 1 0, 0 1 0, 0 1 1, 1 1 1))
)', 1);
ERROR:  Unsupported geometry type in round function: PolyhedralSurface
SELECT round(geometry 'GeometryCollection(
Point(1 1 1),
POLYHEDRALSURFACE Z (
  ((0 0 0, 0 1 0, 1 1 0, 1 0 0, 0 0 0)),
  ((0 0 0, 0 1 0, 0 1 1, 0 0 1, 0 0 0)),
  ((0 0 0, 1 0 0, 1 0 1, 0 0 1, 0 0 0)),
  ((1 1 1, 1 0 1, 0 0 1, 0 1 1, 1 1 1)),
  ((1 1 1, 1 0 1, 1 0 0, 1 1 0, 1 1 1)),
  ((1 1 1, 1 1 0, 0 1 0, 0 1 1, 1 1 1))
))', 1);
ERROR:  Unsupported geometry type in round function: PolyhedralSurface
SELECT asText(round(tgeometry 'Point(1.12345 1.12345)@2000-01-01', 2));
                    astext                     
-----------------------------------------------
 POINT(1.12 1.12)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(round(tgeometry '{Point(1.12345 1.12345)@2000-01-01, Point(2 2)@2000-01-02, Point(1.12345 1.12345)@2000-01-03}', 2));
                                                                 astext                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------
 {POINT(1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1.12 1.12)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asText(round(tgeometry '[Point(1.12345 1.12345)@2000-01-01, Point(2 2)@2000-01-02, Point(1.12345 1.12345)@2000-01-03]', 2));
                                                                 astext                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------
 [POINT(1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1.12 1.12)@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT asText(round(tgeometry '{[Point(1.12345 1.12345)@2000-01-01, Point(2 2)@2000-01-02, Point(1.12345 1.12345)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}', 2));
                                                                                                            astext                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1.12 1.12)@Mon Jan 03 00:00:00 2000 PST], [POINT(3 3)@Tue Jan 04 00:00:00 2000 PST, POINT(3 3)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT asText(round(tgeography 'Point(1.12345 1.12345)@2000-01-01', 2));
                    astext                     
-----------------------------------------------
 POINT(1.12 1.12)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(round(tgeography '{Point(1.12345 1.12345)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.12345 1.12345)@2000-01-03}', 2));
                                                                   astext                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------
 {POINT(1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT(2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT(1.12 1.12)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asText(round(tgeography '[Point(1.12345 1.12345)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.12345 1.12345)@2000-01-03]', 2));
                                                                   astext                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------
 [POINT(1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT(2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT(1.12 1.12)@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT asText(round(tgeography '{[Point(1.12345 1.12345)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.12345 1.12345)@2000-01-03],[Point(3.5 3.5)@2000-01-04, Point(3.5 3.5)@2000-01-05]}', 2));
                                                                                                                  astext                                                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT(2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT(1.12 1.12)@Mon Jan 03 00:00:00 2000 PST], [POINT(3.5 3.5)@Tue Jan 04 00:00:00 2000 PST, POINT(3.5 3.5)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT asText(round(tgeometry 'Point(1.12345 1.12345 1.12345)@2000-01-01', 2));
                        astext                         
-------------------------------------------------------
 POINT Z (1.12 1.12 1.12)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(round(tgeometry '{Point(1.12345 1.12345 1.12345)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1.12345 1.12345 1.12345)@2000-01-03}', 2));
                                                                            astext                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 {POINT Z (1.12 1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2 2 2)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1.12 1.12 1.12)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asText(round(tgeometry '[Point(1.12345 1.12345 1.12345)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1.12345 1.12345 1.12345)@2000-01-03]', 2));
                                                                            astext                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 [POINT Z (1.12 1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2 2 2)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1.12 1.12 1.12)@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT asText(round(tgeometry '{[Point(1.12345 1.12345 1.12345)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1.12345 1.12345 1.12345)@2000-01-03],[Point(3 3 3)@2000-01-04, Point(3 3 3)@2000-01-05]}', 2));
                                                                                                                            astext                                                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[POINT Z (1.12 1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2 2 2)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1.12 1.12 1.12)@Mon Jan 03 00:00:00 2000 PST], [POINT Z (3 3 3)@Tue Jan 04 00:00:00 2000 PST, POINT Z (3 3 3)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT asText(round(tgeography 'Point(1.12345 1.12345 1.12345)@2000-01-01', 2));
                        astext                         
-------------------------------------------------------
 POINT Z (1.12 1.12 1.12)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(round(tgeography '{Point(1.12345 1.12345 1.12345)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.12345 1.12345 1.12345)@2000-01-03}', 2));
                                                                               astext                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {POINT Z (1.12 1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2.5 2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1.12 1.12 1.12)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asText(round(tgeography '[Point(1.12345 1.12345 1.12345)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.12345 1.12345 1.12345)@2000-01-03]', 2));
                                                                               astext                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [POINT Z (1.12 1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2.5 2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1.12 1.12 1.12)@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT asText(round(tgeography '{[Point(1.12345 1.12345 1.12345)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.12345 1.12345 1.12345)@2000-01-03],[Point(3.5 3.5 3.5)@2000-01-04, Point(3.5 3.5 3.5)@2000-01-05]}', 2));
                                                                                                                                     astext                                                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[POINT Z (1.12 1.12 1.12)@Sat Jan 01 00:00:00 2000 PST, POINT Z (2.5 2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT Z (1.12 1.12 1.12)@Mon Jan 03 00:00:00 2000 PST], [POINT Z (3.5 3.5 3.5)@Tue Jan 04 00:00:00 2000 PST, POINT Z (3.5 3.5 3.5)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT asText(round(ARRAY[tgeometry '[Point(1.55 1.55)@2000-01-01, Point(2.55 2.55)@2000-01-02, Point(1.55 1.55)@2000-01-03]', '[Point(3.55 3.55)@2000-01-04, Point(3.55 3.55)@2000-01-05]'],1));
                                                                                                                  astext                                                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[POINT(1.6 1.6)@Sat Jan 01 00:00:00 2000 PST, POINT(2.6 2.6)@Sun Jan 02 00:00:00 2000 PST, POINT(1.6 1.6)@Mon Jan 03 00:00:00 2000 PST]","[POINT(3.6 3.6)@Tue Jan 04 00:00:00 2000 PST, POINT(3.6 3.6)@Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT round(ARRAY[]::tgeometry[]);
 round 
-------
 
(1 row)

SELECT asEWKT(tgeometry 'Point(1 1)@2000-01-01'::tgeography);
                      asewkt                       
---------------------------------------------------
 SRID=4326;POINT(1 1)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asEWKT(tgeometry '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03}'::tgeography);
                                                                asewkt                                                                 
---------------------------------------------------------------------------------------------------------------------------------------
 SRID=4326;{POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asEWKT(tgeometry '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03]'::tgeography);
                                                                asewkt                                                                 
---------------------------------------------------------------------------------------------------------------------------------------
 SRID=4326;[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT asEWKT(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}'::tgeography);
                                                                                                           asewkt                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=4326;{[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST], [POINT(3 3)@Tue Jan 04 00:00:00 2000 PST, POINT(3 3)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT asEWKT(tgeography 'Point(1.5 1.5)@2000-01-01'::tgeometry);
                        asewkt                         
-------------------------------------------------------
 SRID=4326;POINT(1.5 1.5)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asEWKT(tgeography '{Point(1.5 1.5)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.5 1.5)@2000-01-03}'::tgeometry);
                                                                      asewkt                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=4326;{POINT(1.5 1.5)@Sat Jan 01 00:00:00 2000 PST, POINT(2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT(1.5 1.5)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asEWKT(tgeography '[Point(1.5 1.5)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.5 1.5)@2000-01-03]'::tgeometry);
                                                                      asewkt                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=4326;[POINT(1.5 1.5)@Sat Jan 01 00:00:00 2000 PST, POINT(2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT(1.5 1.5)@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT asEWKT(tgeography '{[Point(1.5 1.5)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.5 1.5)@2000-01-03],[Point(3.5 3.5)@2000-01-04, Point(3.5 3.5)@2000-01-05]}'::tgeometry);
                                                                                                                     asewkt                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 SRID=4326;{[POINT(1.5 1.5)@Sat Jan 01 00:00:00 2000 PST, POINT(2.5 2.5)@Sun Jan 02 00:00:00 2000 PST, POINT(1.5 1.5)@Mon Jan 03 00:00:00 2000 PST], [POINT(3.5 3.5)@Tue Jan 04 00:00:00 2000 PST, POINT(3.5 3.5)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT ST_AsText(traversedArea(tgeometry 'Point(1 1)@2000-01-01'));
 st_astext  
------------
 POINT(1 1)
(1 row)

SELECT array_agg(ST_AsText((dp).geom)) FROM (SELECT ST_DumpPoints(traversedArea(tgeometry '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03}'))) AS t(dp);
          array_agg          
-----------------------------
 {"POINT(1 1)","POINT(2 2)"}
(1 row)

SELECT ST_AsText(traversedArea(tgeometry '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03]'));
        st_astext        
-------------------------
 MULTIPOINT((1 1),(2 2))
(1 row)

SELECT ST_AsText(traversedArea(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}'));
           st_astext           
-------------------------------
 MULTIPOINT((1 1),(2 2),(3 3))
(1 row)

SELECT ST_AsText(traversedArea(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}'));
           st_astext           
-------------------------------
 MULTIPOINT((1 1),(2 2),(3 3))
(1 row)

SELECT ST_AsText(traversedArea(tgeography 'Point(1.5 1.5)@2000-01-01'));
   st_astext    
----------------
 POINT(1.5 1.5)
(1 row)

SELECT array_agg(ST_AsText((dp).geom)) FROM (SELECT ST_DumpPoints(traversedArea(tgeography '{Point(1.5 1.5)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.5 1.5)@2000-01-03}')::geometry)) AS t(dp);
              array_agg              
-------------------------------------
 {"POINT(1.5 1.5)","POINT(2.5 2.5)"}
(1 row)

SELECT ST_AsText(traversedArea(tgeography '[Point(1.5 1.5)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.5 1.5)@2000-01-03]'));
            st_astext            
---------------------------------
 MULTIPOINT((1.5 1.5),(2.5 2.5))
(1 row)

SELECT ST_AsText(traversedArea(tgeography '{[Point(1.5 1.5)@2000-01-01, Point(2.5 2.5)@2000-01-02, Point(1.5 1.5)@2000-01-03],[Point(3.5 3.5)@2000-01-04, Point(3.5 3.5)@2000-01-05]}'));
                 st_astext                 
-------------------------------------------
 MULTIPOINT((1.5 1.5),(2.5 2.5),(3.5 3.5))
(1 row)

SELECT ST_AsText(traversedArea(tgeometry 'Point(1 1 1)@2000-01-01'));
    st_astext    
-----------------
 POINT Z (1 1 1)
(1 row)

SELECT array_agg(ST_AsText((dp).geom)) FROM (SELECT ST_DumpPoints(traversedArea(tgeometry '{Point(1 1 1)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 1 1)@2000-01-03}'))) AS t(dp);
               array_agg               
---------------------------------------
 {"POINT Z (1 1 1)","POINT Z (2 2 2)"}
(1 row)

SELECT ST_AsText(traversedArea(tgeometry '[Point(1 1 1)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 1 1)@2000-01-03]'));
           st_astext            
--------------------------------
 MULTIPOINT Z ((1 1 1),(2 2 2))
(1 row)

SELECT ST_AsText(traversedArea(tgeometry '{[Point(1 1 1)@2000-01-01, Point(2 2 2)@2000-01-02, Point(1 1 1)@2000-01-03],[Point(3 3 3)@2000-01-04, Point(3 3 3)@2000-01-05]}'));
               st_astext                
----------------------------------------
 MULTIPOINT Z ((1 1 1),(2 2 2),(3 3 3))
(1 row)

SELECT ST_AsText(traversedArea(tgeography 'Point(1.5 1.5 1.5)@2000-01-01'));
       st_astext       
-----------------------
 POINT Z (1.5 1.5 1.5)
(1 row)

SELECT array_agg(ST_AsText((dp).geom)) FROM (SELECT ST_DumpPoints(traversedArea(tgeography '{Point(1.5 1.5 1.5)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.5 1.5 1.5)@2000-01-03}')::geometry)) AS t(dp);
                     array_agg                     
---------------------------------------------------
 {"POINT Z (1.5 1.5 1.5)","POINT Z (2.5 2.5 2.5)"}
(1 row)

SELECT ST_AsText(traversedArea(tgeography '[Point(1.5 1.5 1.5)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.5 1.5 1.5)@2000-01-03]'));
                 st_astext                  
--------------------------------------------
 MULTIPOINT Z ((1.5 1.5 1.5),(2.5 2.5 2.5))
(1 row)

SELECT ST_AsText(traversedArea(tgeography '{[Point(1.5 1.5 1.5)@2000-01-01, Point(2.5 2.5 2.5)@2000-01-02, Point(1.5 1.5 1.5)@2000-01-03],[Point(3.5 3.5 3.5)@2000-01-04, Point(3.5 3.5 3.5)@2000-01-05]}'));
                        st_astext                         
----------------------------------------------------------
 MULTIPOINT Z ((1.5 1.5 1.5),(2.5 2.5 2.5),(3.5 3.5 3.5))
(1 row)

SELECT array_agg(ST_AsText((dp).geom)) FROM (SELECT ST_DumpPoints(traversedArea(tgeometry '{[Point(1 1)@2001-01-01], [Point(1 1)@2001-02-01], [Point(1 1)@2001-03-01]}'))) AS t(dp);
   array_agg    
----------------
 {"POINT(1 1)"}
(1 row)

SELECT array_agg(ST_AsText((dp).geom)) FROM (SELECT ST_DumpPoints(traversedArea(tgeography '{[Point(1 1)@2001-01-01], [Point(1 1)@2001-02-01], [Point(1 1)@2001-03-01]}')::geometry)) AS t(dp);
   array_agg    
----------------
 {"POINT(1 1)"}
(1 row)

SELECT asText(atGeometry(tgeometry 'Point(1 1)@2000-01-01', geometry 'Linestring(0 0,3 3)'));
                 astext                  
-----------------------------------------
 POINT(1 1)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(atGeometry(tgeometry '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03}', geometry 'Linestring(0 0,3 3)'));
                                                           astext                                                            
-----------------------------------------------------------------------------------------------------------------------------
 {POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asText(atGeometry(tgeometry '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03]', geometry 'Linestring(0 0,3 3)'));
                                                            astext                                                             
-------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

SELECT asText(atGeometry(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}', geometry 'Linestring(0 0,3 3)'));
                                                                                                      astext                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST], [POINT(3 3)@Tue Jan 04 00:00:00 2000 PST, POINT(3 3)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT asText(atGeometry(tgeometry '[Point(0 3)@2000-01-01, Point(1 1)@2000-01-02, Point(3 2)@2000-01-03, Point(0 3)@2000-01-04]', geometry 'Polygon((0 0,0 2,2 2,2 0,0 0))'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(1 1)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST)}
(1 row)

SELECT astext(atGeometry(tgeometry '[Point(0 0)@2000-01-01, Point(3 3)@2000-01-02, Point(0 3)@2000-01-03, Point(
3 0)@2000-01-04]', 'Polygon((1 1,2 1,2 2,1 2,1 1))'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry 'Point(1 1)@2000-01-01', geometry 'Linestring empty'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03}', geometry 'Linestring empty'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03]', geometry 'Linestring empty'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}', geometry 'Linestring empty'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '[Point(1 1)@2000-01-01]', geometry 'Linestring(0 0,1 1)'));
                   astext                    
---------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST]}
(1 row)

SELECT asText(atGeometry(tgeometry '[Point(1 1)@2000-01-01, Point(3 3)@2000-01-02]','Point(2 2)'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '[Point(0 1)@2000-01-01,Point(5 1)@2000-01-05]', geometry 'Linestring(0 0,2 2,3 1,4 1,5 0)'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '[Point(0 0)@2000-01-01]', geometry 'Polygon((0 1,1 2,2 1,1 0,0 1))'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '{[Point(0 0)@2000-01-01, Point(0 0)@2000-01-02],[Point(0 0)@2000-01-03]}', geometry 'Polygon((0 1,1 2,2 1,1 0,0 1))'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '[Point(1 1)@2000-01-01]', geometry 'Linestring(2 2,3 3)'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02]}', geometry 'Linestring(0 1,1 2)'));
 astext 
--------
 
(1 row)

SELECT asText(atGeometry(tgeometry '[Point(1 1)@2000-01-01, Point(1 1)@2000-01-02)', geometry 'Linestring(1 1,2 2)'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(1 1)@Sun Jan 02 00:00:00 2000 PST)}
(1 row)

/* Errors */
SELECT atGeometry(tgeometry 'Point(1 1 1)@2000-01-01', geometry 'Linestring(0 0,3 3)');
ERROR:  The tgeometry cannot have Z dimension
SELECT atGeometry(tgeometry 'Point(1 1)@2000-01-01', geometry 'SRID=5676;Linestring(1 1,2 2)');
ERROR:  Operation on mixed SRID
SELECT atGeometry(tgeometry 'Point(1 1)@2000-01-01', geometry 'Linestring(1 1 1,2 2 2)');
ERROR:  The geometry cannot have Z dimension
SELECT asText(minusGeometry(tgeometry 'Point(1 1)@2000-01-01', geometry 'Linestring(0 0,3 3)'));
 astext 
--------
 
(1 row)

SELECT asText(minusGeometry(tgeometry '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03}', geometry 'Linestring(0 0,3 3)'));
 astext 
--------
 
(1 row)

SELECT asText(minusGeometry(tgeometry '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03]', geometry 'Linestring(0 0,3 3)'));
 astext 
--------
 
(1 row)

SELECT asText(minusGeometry(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}', geometry 'Linestring(0 0,3 3)'));
 astext 
--------
 
(1 row)

SELECT asText(minusGeometry(tgeometry 'Point(1 1)@2000-01-01', geometry 'Linestring empty'));
                 astext                  
-----------------------------------------
 POINT(1 1)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(minusGeometry(tgeometry '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03}', geometry 'Linestring empty'));
                                                           astext                                                            
-----------------------------------------------------------------------------------------------------------------------------
 {POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST}
(1 row)

SELECT asText(minusGeometry(tgeometry '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03]', geometry 'Linestring empty'));
                                                           astext                                                            
-----------------------------------------------------------------------------------------------------------------------------
 [POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST]
(1 row)

SELECT asText(minusGeometry(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}', geometry 'Linestring empty'));
                                                                                                      astext                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST], [POINT(3 3)@Tue Jan 04 00:00:00 2000 PST, POINT(3 3)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT asText(minusGeometry(tgeometry '[Point(1 1)@2000-01-01, Point(1 1)@2000-01-02)', geometry 'Linestring(0 1,2 1)'));
 astext 
--------
 
(1 row)

SELECT asText(minusGeometry(tgeometry '{[Point(1 1)@2000-01-01, Point(1 1)@2000-01-02)}', geometry 'Linestring(0 1,2 1)'));
 astext 
--------
 
(1 row)

SELECT asText(minusGeometry(tgeometry '[Point(1 1)@2000-01-01, Point(3 3)@2000-01-02]','Point(2 2)'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(3 3)@Sun Jan 02 00:00:00 2000 PST]}
(1 row)

SELECT asText(minusGeometry(tgeometry '{[Point(1 1)@2000-01-01, Point(3 3)@2000-01-02],[Point(3 3)@2000-01-03]}','Point(2 2)'));
                                                             astext                                                              
---------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(3 3)@Sun Jan 02 00:00:00 2000 PST], [POINT(3 3)@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

/* Errors */
SELECT minusGeometry(tgeometry 'Point(1 1 1)@2000-01-01', geometry 'Linestring(0 0,3 3)');
ERROR:  The tgeometry cannot have Z dimension
SELECT minusGeometry(tgeometry 'Point(1 1)@2000-01-01', geometry 'SRID=5676;Linestring(1 1,2 2)');
ERROR:  Operation on mixed SRID
SELECT minusGeometry(tgeometry 'Point(1 1)@2000-01-01', geometry 'Linestring(1 1 1,2 2 2)');
ERROR:  The geometry cannot have Z dimension
WITH test(temp, geo) AS (
  SELECT tgeometry '[Point(1 1)@2000-01-01, Point(3 1)@2000-01-03,
    Point(3 1)@2000-01-05]', geometry 'Polygon((2 0,2 2,4 2,4 0,2 0))' )
SELECT temp = merge(atGeometry(temp, geo), minusGeometry(temp, geo))
FROM test;
 ?column? 
----------
 t
(1 row)

SELECT asText(atStbox(tgeometry 'Point(1 1)@2000-01-01', 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])'));
                 astext                  
-----------------------------------------
 POINT(1 1)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(atStbox(tgeometry '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03}', 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])'));
                                       astext                                       
------------------------------------------------------------------------------------
 {POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST}
(1 row)

SELECT asText(atStbox(tgeometry '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03]', 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST]}
(1 row)

SELECT asText(atStbox(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}', 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 2)@Sun Jan 02 00:00:00 2000 PST]}
(1 row)

SELECT asText(atStbox(tgeometry 'Point(1 1)@2000-01-01', 'STBOX X((1,1),(2,2))'));
                 astext                  
-----------------------------------------
 POINT(1 1)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(atStbox(tgeometry 'Point(1 1)@2000-01-01', 'STBOX T([2000-01-01,2000-01-02])'));
                 astext                  
-----------------------------------------
 POINT(1 1)@Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT asText(atStbox(tgeometry '(Point(2 2)@2000-01-02, Point(3 3)@2000-01-03]', 'STBOX T([2000-01-01,2000-01-02])'));
 astext 
--------
 
(1 row)

SELECT asText(atStbox(tgeometry '[Point(1 1)@2001-01-01, Point(1 0)@2001-01-02,
  Point(0 0)@2001-01-03, Point(0 1)@2001-01-04, Point(1 1)@2001-01-05]',
  stbox 'STBOX X((0,0),(2,2))', false));
                                                                                                     astext                                                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1 1)@Mon Jan 01 00:00:00 2001 PST, POINT(1 0)@Tue Jan 02 00:00:00 2001 PST, POINT(0 0)@Wed Jan 03 00:00:00 2001 PST, POINT(0 1)@Thu Jan 04 00:00:00 2001 PST, POINT(1 1)@Fri Jan 05 00:00:00 2001 PST]}
(1 row)

SELECT asText(atStbox(tgeometry '[Point(1 1)@2001-01-01, Point(1 2)@2001-01-02,
  Point(2 2)@2001-01-03, Point(2 1)@2001-01-04, Point(1 1)@2001-01-05]',
  stbox 'STBOX X((0,0),(2,2))', false));
                                                                                                     astext                                                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1 1)@Mon Jan 01 00:00:00 2001 PST, POINT(1 2)@Tue Jan 02 00:00:00 2001 PST, POINT(2 2)@Wed Jan 03 00:00:00 2001 PST, POINT(2 1)@Thu Jan 04 00:00:00 2001 PST, POINT(1 1)@Fri Jan 05 00:00:00 2001 PST]}
(1 row)

SELECT asText(minusStbox(tgeometry 'Point(1 1)@2000-01-01', 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])'));
 astext 
--------
 
(1 row)

SELECT asText(minusStbox(tgeometry '{Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03}', 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])'));
 astext 
--------
 
(1 row)

SELECT asText(minusStbox(tgeometry '[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03]', 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])'));
 astext 
--------
 
(1 row)

SELECT asText(minusStbox(tgeometry '{[Point(1 1)@2000-01-01, Point(2 2)@2000-01-02, Point(1 1)@2000-01-03],[Point(3 3)@2000-01-04, Point(3 3)@2000-01-05]}', 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(3 3)@Tue Jan 04 00:00:00 2000 PST, POINT(3 3)@Wed Jan 05 00:00:00 2000 PST]}
(1 row)

SELECT asText(minusStbox(tgeometry '[Point(1 1)@2001-01-01, Point(1 0)@2001-01-02,
  Point(0 0)@2001-01-03, Point(0 1)@2001-01-04, Point(1 1)@2001-01-05]',
  stbox 'STBOX X((0,0),(2,2))', false));
 astext 
--------
 
(1 row)

SELECT asText(minusStbox(tgeometry '[Point(1 1)@2001-01-01, Point(1 2)@2001-01-02,
  Point(2 2)@2001-01-03, Point(2 1)@2001-01-04, Point(1 1)@2001-01-05]',
  stbox 'STBOX X((0,0),(2,2))', false));
 astext 
--------
 
(1 row)

SELECT asText(atStbox(tgeometry '{Point(1 1)@2000-01-01}', stbox 'STBOX X((1 1),(3 3))'));
                   astext                    
---------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST]}
(1 row)

SELECT asText(atStbox(tgeometry '[Point(1 1)@2000-01-01]', stbox 'STBOX X((1 1),(3 3))'));
                   astext                    
---------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST]}
(1 row)

SELECT astext(atStbox(tgeometry '[Point(1 1)@2000-01-01, Point(1 3)@2000-01-02, Point(1 1)@2000-01-03]', stbox 'STBOX X((0,0),(2 2))'));
                                                             astext                                                              
---------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(1 1)@Sun Jan 02 00:00:00 2000 PST), [POINT(1 1)@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

SELECT astext(atStbox(tgeometry '[Point(1 1)@2000-01-01, Point(1 2)@2000-01-02, Point(1 1)@2000-01-03]', stbox 'STBOX X((0,0),(2 2))'));
                                                            astext                                                             
-------------------------------------------------------------------------------------------------------------------------------
 {[POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(1 2)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST]}
(1 row)

SELECT astext(atStbox(tgeometry '[Point(1 2)@2000-01-01, Point(1 1)@2000-01-02, Point(2 1)@2000-01-03]', stbox 'STBOX X((0,0),(1 1))'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(1 1)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Mon Jan 03 00:00:00 2000 PST)}
(1 row)

SELECT astext(atStbox(tgeometry '[Point(0 2)@2000-01-01, Point(2 0)@2000-01-02]', stbox 'STBOX X((0,0),(1 1))'));
 astext 
--------
 
(1 row)

SELECT astext(atStbox(tgeometry '[Point(0 0)@2000-01-01, Point(2 2)@2000-01-02]', stbox 'STBOX X((0,0),(1 1))'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(0 0)@Sat Jan 01 00:00:00 2000 PST, POINT(0 0)@Sun Jan 02 00:00:00 2000 PST)}
(1 row)

SELECT astext(atStbox(tgeometry '[Point(-2 1)@2000-01-01, Point(2 1)@2000-01-02]', stbox 'STBOX X((0,0),(1 1))'));
 astext 
--------
 
(1 row)

SELECT astext(atStbox(tgeometry '(Point(2 1)@2000-01-01, Point(2 1)@2000-01-02)', stbox 'STBOX X((0,0),(2 2))'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {(POINT(2 1)@Sat Jan 01 00:00:00 2000 PST, POINT(2 1)@Sun Jan 02 00:00:00 2000 PST)}
(1 row)

SELECT astext(atStbox(tgeometry '(Point(3 1)@2000-01-01, Point(3 1)@2000-01-02)', stbox 'STBOX X((0,0),(2 2))'));
 astext 
--------
 
(1 row)

SELECT astext(atStbox(tgeometry '(Point(1 1)@2000-01-01, Point(3 1)@2000-01-02, Point(3 1)@2000-01-04)', stbox 'STBOX X((0,0),(2 2))'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {(POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(1 1)@Sun Jan 02 00:00:00 2000 PST)}
(1 row)

SELECT astext(atStbox(tgeometry '(Point(3 1)@2000-01-01, Point(2 1)@2000-01-02, Point(2 1)@2000-01-04)', stbox 'STBOX X((0,0),(2 2))'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(2 1)@Sun Jan 02 00:00:00 2000 PST, POINT(2 1)@Tue Jan 04 00:00:00 2000 PST)}
(1 row)

SELECT astext(atStbox(tgeometry '(Point(1 1)@2000-01-01, Point(3 1)@2000-01-02, Point(3 1)@2000-01-04)', stbox 'STBOX X((0,0),(2 2))'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {(POINT(1 1)@Sat Jan 01 00:00:00 2000 PST, POINT(1 1)@Sun Jan 02 00:00:00 2000 PST)}
(1 row)

SELECT astext(atStbox(tgeometry '(Point(3 1)@2000-01-01, Point(1 1)@2000-01-02, Point(1 1)@2000-01-04)', stbox 'STBOX X((0,0),(2 2))'));
                                        astext                                        
--------------------------------------------------------------------------------------
 {[POINT(1 1)@Sun Jan 02 00:00:00 2000 PST, POINT(1 1)@Tue Jan 04 00:00:00 2000 PST)}
(1 row)

/* Errors */
SELECT asText(atStbox(tgeometry 'SRID=4326;Point(1 1)@2000-01-01', 'GEODSTBOX ZT(((1,1,1),(2,2,2)),[2000-01-01,2000-01-02])'));
ERROR:  Operation on mixed planar and geodetic coordinates
SELECT asText(atStbox(tgeometry 'SRID=5676;Point(1 1)@2000-01-01', 'STBOX XT(((1,1),(2,2)),[2000-01-01,2000-01-02])'));
ERROR:  Operation on mixed SRID
WITH temp(trip, box) AS (
  SELECT tgeometry '[Point(1 1)@2000-01-01, Point(3 1)@2000-01-03,
    Point(3 1)@2000-01-05]', stbox 'STBox X((2 0),(4 2))' )
SELECT trip = merge(atStbox(trip, box), minusStbox(trip,box))
FROM temp;
 ?column? 
----------
 t
(1 row)

