SELECT intspanset '{[1,2),[3,4),[5,6)}';
        intspanset        
--------------------------
 {[1, 2), [3, 4), [5, 6)}
(1 row)

SELECT floatspanset '{[1,2),[3,4),[5,6)}';
       floatspanset       
--------------------------
 {[1, 2), [3, 4), [5, 6)}
(1 row)

SELECT tstzspanset '{[2000-01-01, 2000-01-02), [2000-01-03, 2000-01-04)}';
                                                         tstzspanset                                                          
------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST), [Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)}
(1 row)

SELECT tstzspanset '{[2000-01-01, 2000-01-02), [2000-01-02, 2000-01-03), [2000-01-03, 2000-01-04)}';
                          tstzspanset                           
----------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)}
(1 row)

/* Errors */
SELECT tstzspanset '2000-01-01, 2000-01-02';
ERROR:  Could not parse span set: Missing open brace
LINE 2: SELECT tstzspanset '2000-01-01, 2000-01-02';
                           ^
SELECT tstzspanset '{[2000-01-01, 2000-01-02]';
ERROR:  Could not parse span set: Missing closing brace
LINE 1: SELECT tstzspanset '{[2000-01-01, 2000-01-02]';
                           ^
SELECT spanset(ARRAY [intspan '[1,2)','[3,4)','[5,6)']);
         spanset          
--------------------------
 {[1, 2), [3, 4), [5, 6)}
(1 row)

SELECT spanset(ARRAY [floatspan '[1,2)','[3,4)','[5,6)']);
         spanset          
--------------------------
 {[1, 2), [3, 4), [5, 6)}
(1 row)

SELECT spanset(ARRAY [tstzspan '[2000-01-01, 2000-01-02]', '[2000-01-03,2000-01-04]']);
                                                           spanset                                                            
------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST], [Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]}
(1 row)

/* Errors */
SELECT spanset(ARRAY [tstzspan '[2000-01-01, 2000-01-03]', '[2000-01-02,2000-01-04]']);
ERROR:  Invalid value for span set
SELECT spanset('{}'::tstzspan[]);
ERROR:  The input array cannot be empty
SELECT spanset(timestamptz '2000-01-01');
                            spanset                             
----------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]}
(1 row)

SELECT spanset(tstzset '{2000-01-01,2000-01-02}');
                                                           spanset                                                            
------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST], [Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]}
(1 row)

SELECT spanset(tstzspan '[2000-01-01,2000-01-02]');
                            spanset                             
----------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]}
(1 row)

SELECT timestamptz '2000-01-01'::tstzspanset;
                          tstzspanset                           
----------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]}
(1 row)

SELECT tstzset '{2000-01-01,2000-01-02}'::tstzspanset;
                                                         tstzspanset                                                          
------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST], [Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]}
(1 row)

SELECT tstzspan '[2000-01-01,2000-01-02]'::tstzspanset;
                          tstzspanset                           
----------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]}
(1 row)

SELECT shift(intspanset '{[1,2),[3,4),[5,6)}', 2);
          shift           
--------------------------
 {[3, 4), [5, 6), [7, 8)}
(1 row)

SELECT shift(tstzspanset '{[2000-01-01,2000-01-01]}', '5 min');
                             shift                              
----------------------------------------------------------------
 {[Sat Jan 01 00:05:00 2000 PST, Sat Jan 01 00:05:00 2000 PST]}
(1 row)

SELECT shift(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', '5 min');
                                                                                           shift                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(Sat Jan 01 00:05:00 2000 PST, Sun Jan 02 00:05:00 2000 PST), (Sun Jan 02 00:05:00 2000 PST, Mon Jan 03 00:05:00 2000 PST), (Mon Jan 03 00:05:00 2000 PST, Tue Jan 04 00:05:00 2000 PST)}
(1 row)

SELECT shift(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min');
                                                                                           shift                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(Sat Jan 01 00:05:00 2000 PST, Sun Jan 02 00:05:00 2000 PST), (Mon Jan 03 00:05:00 2000 PST, Tue Jan 04 00:05:00 2000 PST), (Wed Jan 05 00:05:00 2000 PST, Thu Jan 06 00:05:00 2000 PST)}
(1 row)

SELECT shift(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min');
                                                                                           shift                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:05:00 2000 PST, Sun Jan 02 00:05:00 2000 PST), (Mon Jan 03 00:05:00 2000 PST, Tue Jan 04 00:05:00 2000 PST), (Wed Jan 05 00:05:00 2000 PST, Thu Jan 06 00:05:00 2000 PST)}
(1 row)

SELECT shift(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min');
                                                                                           shift                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(Sat Jan 01 00:05:00 2000 PST, Sun Jan 02 00:05:00 2000 PST), (Mon Jan 03 00:05:00 2000 PST, Tue Jan 04 00:05:00 2000 PST), (Wed Jan 05 00:05:00 2000 PST, Thu Jan 06 00:05:00 2000 PST]}
(1 row)

SELECT shift(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min');
                                                                                           shift                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:05:00 2000 PST, Sun Jan 02 00:05:00 2000 PST), (Mon Jan 03 00:05:00 2000 PST, Tue Jan 04 00:05:00 2000 PST), (Wed Jan 05 00:05:00 2000 PST, Thu Jan 06 00:05:00 2000 PST]}
(1 row)

SELECT tscale(tstzspanset '{[2000-01-01,2000-01-01]}', '1 hour');
                             tscale                             
----------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]}
(1 row)

SELECT tscale(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', '1 hour');
                                                                                           tscale                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:20:00 2000 PST), (Sat Jan 01 00:20:00 2000 PST, Sat Jan 01 00:40:00 2000 PST), (Sat Jan 01 00:40:00 2000 PST, Sat Jan 01 01:00:00 2000 PST)}
(1 row)

SELECT tscale(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '1 hour');
                                                                                           tscale                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:12:00 2000 PST), (Sat Jan 01 00:24:00 2000 PST, Sat Jan 01 00:36:00 2000 PST), (Sat Jan 01 00:48:00 2000 PST, Sat Jan 01 01:00:00 2000 PST)}
(1 row)

SELECT tscale(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '1 hour');
                                                                                           tscale                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:12:00 2000 PST), (Sat Jan 01 00:24:00 2000 PST, Sat Jan 01 00:36:00 2000 PST), (Sat Jan 01 00:48:00 2000 PST, Sat Jan 01 01:00:00 2000 PST)}
(1 row)

SELECT tscale(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '1 hour');
                                                                                           tscale                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:12:00 2000 PST), (Sat Jan 01 00:24:00 2000 PST, Sat Jan 01 00:36:00 2000 PST), (Sat Jan 01 00:48:00 2000 PST, Sat Jan 01 01:00:00 2000 PST]}
(1 row)

SELECT tscale(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '1 hour');
                                                                                           tscale                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:12:00 2000 PST), (Sat Jan 01 00:24:00 2000 PST, Sat Jan 01 00:36:00 2000 PST), (Sat Jan 01 00:48:00 2000 PST, Sat Jan 01 01:00:00 2000 PST]}
(1 row)

SELECT shiftTscale(tstzspanset '{[2000-01-01,2000-01-01]}', '5 min', '1 hour');
                          shifttscale                           
----------------------------------------------------------------
 {[Sat Jan 01 00:05:00 2000 PST, Sat Jan 01 00:05:00 2000 PST]}
(1 row)

SELECT shiftTscale(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', '5 min', '1 hour');
                                                                                        shifttscale                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(Sat Jan 01 00:05:00 2000 PST, Sat Jan 01 00:25:00 2000 PST), (Sat Jan 01 00:25:00 2000 PST, Sat Jan 01 00:45:00 2000 PST), (Sat Jan 01 00:45:00 2000 PST, Sat Jan 01 01:05:00 2000 PST)}
(1 row)

SELECT shiftTscale(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min', '1 hour');
                                                                                        shifttscale                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(Sat Jan 01 00:05:00 2000 PST, Sat Jan 01 00:17:00 2000 PST), (Sat Jan 01 00:29:00 2000 PST, Sat Jan 01 00:41:00 2000 PST), (Sat Jan 01 00:53:00 2000 PST, Sat Jan 01 01:05:00 2000 PST)}
(1 row)

SELECT shiftTscale(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', '5 min', '1 hour');
                                                                                        shifttscale                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:05:00 2000 PST, Sat Jan 01 00:17:00 2000 PST), (Sat Jan 01 00:29:00 2000 PST, Sat Jan 01 00:41:00 2000 PST), (Sat Jan 01 00:53:00 2000 PST, Sat Jan 01 01:05:00 2000 PST)}
(1 row)

SELECT shiftTscale(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min', '1 hour');
                                                                                        shifttscale                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {(Sat Jan 01 00:05:00 2000 PST, Sat Jan 01 00:17:00 2000 PST), (Sat Jan 01 00:29:00 2000 PST, Sat Jan 01 00:41:00 2000 PST), (Sat Jan 01 00:53:00 2000 PST, Sat Jan 01 01:05:00 2000 PST]}
(1 row)

SELECT shiftTscale(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', '5 min', '1 hour');
                                                                                        shifttscale                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {[Sat Jan 01 00:05:00 2000 PST, Sat Jan 01 00:17:00 2000 PST), (Sat Jan 01 00:29:00 2000 PST, Sat Jan 01 00:41:00 2000 PST), (Sat Jan 01 00:53:00 2000 PST, Sat Jan 01 01:05:00 2000 PST]}
(1 row)

SELECT memSize(intspanset '{[1,2),[3,4),[5,6)}');
 memsize 
---------
     112
(1 row)

SELECT memSize(floatspanset '{[1,2),[3,4),[5,6)}');
 memsize 
---------
     112
(1 row)

SELECT memSize(tstzspanset '{[2000-01-01,2000-01-01]}');
 memsize 
---------
      64
(1 row)

SELECT memSize(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 memsize 
---------
     112
(1 row)

SELECT memSize(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 memsize 
---------
     112
(1 row)

SELECT memSize(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 memsize 
---------
     112
(1 row)

SELECT memSize(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 memsize 
---------
     112
(1 row)

SELECT memSize(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 memsize 
---------
     112
(1 row)

SELECT span(intspanset '{[1,2),[3,4),[5,6)}');
  span  
--------
 [1, 6)
(1 row)

SELECT span(floatspanset '{[1,2),[3,4),[5,6)}');
  span  
--------
 [1, 6)
(1 row)

SELECT lower(intspanset '{[1,2),[3,4),[5,6)}');
 lower 
-------
     1
(1 row)

SELECT lower(floatspanset '{[1,2),[3,4),[5,6)}');
 lower 
-------
     1
(1 row)

SELECT lower_inc(intspanset '{[1,2),[3,4),[5,6)}');
 lower_inc 
-----------
 t
(1 row)

SELECT lower_inc(floatspanset '{[1,2),[3,4),[5,6)}');
 lower_inc 
-----------
 t
(1 row)

SELECT upper(intspanset '{[1,2),[3,4),[5,6)}');
 upper 
-------
     6
(1 row)

SELECT upper(floatspanset '{[1,2),[3,4),[5,6)}');
 upper 
-------
     6
(1 row)

SELECT upper_inc(intspanset '{[1,2),[3,4),[5,6)}');
 upper_inc 
-----------
 f
(1 row)

SELECT upper_inc(floatspanset '{[1,2),[3,4),[5,6)}');
 upper_inc 
-----------
 f
(1 row)

SELECT span(tstzspanset '{[2000-01-01,2000-01-01]}');
                             span                             
--------------------------------------------------------------
 [Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]
(1 row)

SELECT span(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                             span                             
--------------------------------------------------------------
 (Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)
(1 row)

SELECT span(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                             span                             
--------------------------------------------------------------
 (Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST)
(1 row)

SELECT span(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                             span                             
--------------------------------------------------------------
 [Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST)
(1 row)

SELECT span(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                             span                             
--------------------------------------------------------------
 (Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]
(1 row)

SELECT span(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                             span                             
--------------------------------------------------------------
 [Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]
(1 row)

SELECT duration(tstzspanset '{[2000-01-01,2000-01-01]}', true);
 duration 
----------
 00:00:00
(1 row)

SELECT duration(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', true);
 duration 
----------
 3 days
(1 row)

SELECT duration(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', true);
 duration 
----------
 5 days
(1 row)

SELECT duration(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', true);
 duration 
----------
 5 days
(1 row)

SELECT duration(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', true);
 duration 
----------
 5 days
(1 row)

SELECT duration(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', true);
 duration 
----------
 5 days
(1 row)

SELECT width(intspanset '{[1,2),[3,4),[5,6)}');
 width 
-------
     3
(1 row)

SELECT width(floatspanset '{[1,2),[3,4),[5,6)}');
 width 
-------
     3
(1 row)

SELECT duration(tstzspanset '{[2000-01-01,2000-01-01]}');
 duration 
----------
 00:00:00
(1 row)

SELECT duration(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 duration 
----------
 3 days
(1 row)

SELECT duration(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 duration 
----------
 3 days
(1 row)

SELECT duration(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 duration 
----------
 3 days
(1 row)

SELECT duration(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 duration 
----------
 3 days
(1 row)

SELECT duration(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 duration 
----------
 3 days
(1 row)

SELECT numSpans(intspanset '{[1,2),[3,4),[5,6)}');
 numspans 
----------
        3
(1 row)

SELECT numSpans(floatspanset '{[1,2),[3,4),[5,6)}');
 numspans 
----------
        3
(1 row)

SELECT numSpans(tstzspanset '{[2000-01-01,2000-01-01]}');
 numspans 
----------
        1
(1 row)

SELECT numSpans(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 numspans 
----------
        3
(1 row)

SELECT numSpans(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numspans 
----------
        3
(1 row)

SELECT numSpans(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numspans 
----------
        3
(1 row)

SELECT numSpans(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numspans 
----------
        3
(1 row)

SELECT numSpans(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numspans 
----------
        3
(1 row)

SELECT startSpan(intspanset '{[1,2),[3,4),[5,6)}');
 startspan 
-----------
 [1, 2)
(1 row)

SELECT startSpan(floatspanset '{[1,2),[3,4),[5,6)}');
 startspan 
-----------
 [1, 2)
(1 row)

SELECT startSpan(tstzspanset '{[2000-01-01,2000-01-01]}');
                          startspan                           
--------------------------------------------------------------
 [Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]
(1 row)

SELECT startSpan(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                          startspan                           
--------------------------------------------------------------
 (Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)
(1 row)

SELECT startSpan(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                          startspan                           
--------------------------------------------------------------
 (Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)
(1 row)

SELECT startSpan(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                          startspan                           
--------------------------------------------------------------
 [Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)
(1 row)

SELECT startSpan(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                          startspan                           
--------------------------------------------------------------
 (Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)
(1 row)

SELECT startSpan(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                          startspan                           
--------------------------------------------------------------
 [Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)
(1 row)

SELECT endSpan(intspanset '{[1,2),[3,4),[5,6)}');
 endspan 
---------
 [5, 6)
(1 row)

SELECT endSpan(floatspanset '{[1,2),[3,4),[5,6)}');
 endspan 
---------
 [5, 6)
(1 row)

SELECT endSpan(tstzspanset '{[2000-01-01,2000-01-01]}');
                           endspan                            
--------------------------------------------------------------
 [Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]
(1 row)

SELECT endSpan(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                           endspan                            
--------------------------------------------------------------
 (Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)
(1 row)

SELECT endSpan(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                           endspan                            
--------------------------------------------------------------
 (Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST)
(1 row)

SELECT endSpan(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                           endspan                            
--------------------------------------------------------------
 (Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST)
(1 row)

SELECT endSpan(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                           endspan                            
--------------------------------------------------------------
 (Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]
(1 row)

SELECT endSpan(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                           endspan                            
--------------------------------------------------------------
 (Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]
(1 row)

SELECT spanN(intspanset '{[1,2),[3,4),[5,6)}', 2);
 spann  
--------
 [3, 4)
(1 row)

SELECT spanN(floatspanset '{[1,2),[3,4),[5,6)}', 2);
 spann  
--------
 [3, 4)
(1 row)

SELECT spanN(tstzspanset '{[2000-01-01,2000-01-01]}', 1);
                            spann                             
--------------------------------------------------------------
 [Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]
(1 row)

SELECT spanN(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', 1);
                            spann                             
--------------------------------------------------------------
 (Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)
(1 row)

SELECT spanN(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 2);
                            spann                             
--------------------------------------------------------------
 (Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)
(1 row)

SELECT spanN(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 3);
                            spann                             
--------------------------------------------------------------
 (Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST)
(1 row)

SELECT spanN(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 4);
 spann 
-------
 
(1 row)

SELECT spanN(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 0);
 spann 
-------
 
(1 row)

SELECT spans(intspanset '{[1,2),[3,4),[5,6)}');
            spans             
------------------------------
 {"[1, 2)","[3, 4)","[5, 6)"}
(1 row)

SELECT spans(floatspanset '{[1,2),[3,4),[5,6)}');
            spans             
------------------------------
 {"[1, 2)","[3, 4)","[5, 6)"}
(1 row)

SELECT spans(tstzspanset '{[2000-01-01,2000-01-01]}');
                              spans                               
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]"}
(1 row)

SELECT spans(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                                                                                             spans                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"(Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)","(Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST)","(Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)"}
(1 row)

SELECT spans(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                                             spans                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"(Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)","(Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)","(Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST)"}
(1 row)

SELECT spans(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                                             spans                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)","(Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)","(Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST)"}
(1 row)

SELECT spans(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                                             spans                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"(Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)","(Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)","(Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]"}
(1 row)

SELECT spans(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                                             spans                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST)","(Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST)","(Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]"}
(1 row)

SELECT numTimestamps(tstzspanset '{[2000-01-01,2000-01-01]}');
 numtimestamps 
---------------
             1
(1 row)

SELECT numTimestamps(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 numtimestamps 
---------------
             4
(1 row)

SELECT numTimestamps(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numtimestamps 
---------------
             6
(1 row)

SELECT numTimestamps(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
 numtimestamps 
---------------
             6
(1 row)

SELECT numTimestamps(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numtimestamps 
---------------
             6
(1 row)

SELECT numTimestamps(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
 numtimestamps 
---------------
             6
(1 row)

SELECT startTimestamp(tstzspanset '{[2000-01-01,2000-01-01]}');
        starttimestamp        
------------------------------
 Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT startTimestamp(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
        starttimestamp        
------------------------------
 Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT startTimestamp(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
        starttimestamp        
------------------------------
 Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT startTimestamp(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
        starttimestamp        
------------------------------
 Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT startTimestamp(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
        starttimestamp        
------------------------------
 Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT startTimestamp(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
        starttimestamp        
------------------------------
 Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT endTimestamp(tstzspanset '{[2000-01-01,2000-01-01]}');
         endtimestamp         
------------------------------
 Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT endTimestamp(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
         endtimestamp         
------------------------------
 Tue Jan 04 00:00:00 2000 PST
(1 row)

SELECT endTimestamp(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
         endtimestamp         
------------------------------
 Thu Jan 06 00:00:00 2000 PST
(1 row)

SELECT endTimestamp(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
         endtimestamp         
------------------------------
 Thu Jan 06 00:00:00 2000 PST
(1 row)

SELECT endTimestamp(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
         endtimestamp         
------------------------------
 Thu Jan 06 00:00:00 2000 PST
(1 row)

SELECT endTimestamp(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
         endtimestamp         
------------------------------
 Thu Jan 06 00:00:00 2000 PST
(1 row)

SELECT timestampN(tstzspanset '{[2000-01-01,2000-01-01]}', 1);
          timestampn          
------------------------------
 Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT timestampN(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}', 1);
          timestampn          
------------------------------
 Sat Jan 01 00:00:00 2000 PST
(1 row)

SELECT timestampN(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 2);
          timestampn          
------------------------------
 Sun Jan 02 00:00:00 2000 PST
(1 row)

SELECT timestampN(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}', 3);
          timestampn          
------------------------------
 Mon Jan 03 00:00:00 2000 PST
(1 row)

SELECT timestampN(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 4);
          timestampn          
------------------------------
 Tue Jan 04 00:00:00 2000 PST
(1 row)

SELECT timestampN(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}', 0);
 timestampn 
------------
 
(1 row)

SELECT timestampN(tstzspanset '{[2000-01-01,2000-01-01],[2000-01-02,2000-01-02]}',3);
 timestampn 
------------
 
(1 row)

SELECT timestamps(tstzspanset '{[2000-01-01,2000-01-01]}');
            timestamps            
----------------------------------
 {"Sat Jan 01 00:00:00 2000 PST"}
(1 row)

SELECT timestamps(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
                                                          timestamps                                                           
-------------------------------------------------------------------------------------------------------------------------------
 {"Sat Jan 01 00:00:00 2000 PST","Sun Jan 02 00:00:00 2000 PST","Mon Jan 03 00:00:00 2000 PST","Tue Jan 04 00:00:00 2000 PST"}
(1 row)

SELECT timestamps(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                                         timestamps                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"Sat Jan 01 00:00:00 2000 PST","Sun Jan 02 00:00:00 2000 PST","Mon Jan 03 00:00:00 2000 PST","Tue Jan 04 00:00:00 2000 PST","Wed Jan 05 00:00:00 2000 PST","Thu Jan 06 00:00:00 2000 PST"}
(1 row)

SELECT timestamps(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06)}');
                                                                                         timestamps                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"Sat Jan 01 00:00:00 2000 PST","Sun Jan 02 00:00:00 2000 PST","Mon Jan 03 00:00:00 2000 PST","Tue Jan 04 00:00:00 2000 PST","Wed Jan 05 00:00:00 2000 PST","Thu Jan 06 00:00:00 2000 PST"}
(1 row)

SELECT timestamps(tstzspanset '{(2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                                         timestamps                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"Sat Jan 01 00:00:00 2000 PST","Sun Jan 02 00:00:00 2000 PST","Mon Jan 03 00:00:00 2000 PST","Tue Jan 04 00:00:00 2000 PST","Wed Jan 05 00:00:00 2000 PST","Thu Jan 06 00:00:00 2000 PST"}
(1 row)

SELECT timestamps(tstzspanset '{[2000-01-01,2000-01-02),(2000-01-03,2000-01-04),(2000-01-05,2000-01-06]}');
                                                                                         timestamps                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"Sat Jan 01 00:00:00 2000 PST","Sun Jan 02 00:00:00 2000 PST","Mon Jan 03 00:00:00 2000 PST","Tue Jan 04 00:00:00 2000 PST","Wed Jan 05 00:00:00 2000 PST","Thu Jan 06 00:00:00 2000 PST"}
(1 row)

SELECT spanset_cmp(intspanset '{[1,1]}', intspanset '{[1,2),[2,3),[3,4)}');
 spanset_cmp 
-------------
          -1
(1 row)

SELECT intspanset '{[1,1]}' = intspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 f
(1 row)

SELECT intspanset '{[1,1]}' <> intspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 t
(1 row)

SELECT intspanset '{[1,1]}' < intspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 t
(1 row)

SELECT intspanset '{[1,1]}' <= intspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 t
(1 row)

SELECT intspanset '{[1,1]}' > intspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 f
(1 row)

SELECT intspanset '{[1,1]}' >= intspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 f
(1 row)

SELECT spanset_cmp(floatspanset '{[1,1]}', floatspanset '{[1,2),[2,3),[3,4)}');
 spanset_cmp 
-------------
          -1
(1 row)

SELECT floatspanset '{[1,1]}' = floatspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 f
(1 row)

SELECT floatspanset '{[1,1]}' <> floatspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 t
(1 row)

SELECT floatspanset '{[1,1]}' < floatspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 t
(1 row)

SELECT floatspanset '{[1,1]}' <= floatspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 t
(1 row)

SELECT floatspanset '{[1,1]}' > floatspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 f
(1 row)

SELECT floatspanset '{[1,1]}' >= floatspanset '{[1,2),[2,3),[3,4)}';
 ?column? 
----------
 f
(1 row)

SELECT spanset_cmp(tstzspanset '{[2000-01-01,2000-01-01]}', tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}');
 spanset_cmp 
-------------
          -1
(1 row)

SELECT tstzspanset '{[2000-01-01,2000-01-01]}' = tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 f
(1 row)

SELECT tstzspanset '{[2000-01-01,2000-01-01]}' <> tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 t
(1 row)

SELECT tstzspanset '{[2000-01-01,2000-01-01]}' < tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 t
(1 row)

SELECT tstzspanset '{[2000-01-01,2000-01-02]}' < tstzspanset '{[2000-01-01,2000-01-02],[2000-01-03,2000-01-04]}';
 ?column? 
----------
 t
(1 row)

SELECT tstzspanset '{[2000-01-01,2000-01-02],[2000-01-03,2000-01-04]}' < tstzspanset '{[2000-01-01,2000-01-02]}';
 ?column? 
----------
 f
(1 row)

SELECT tstzspanset '{[2000-01-01,2000-01-01]}' <= tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 t
(1 row)

SELECT tstzspanset '{[2000-01-01,2000-01-01]}' > tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 f
(1 row)

SELECT tstzspanset '{[2000-01-01,2000-01-01]}' >= tstzspanset '{(2000-01-01,2000-01-02),(2000-01-02,2000-01-03),(2000-01-03,2000-01-04)}';
 ?column? 
----------
 f
(1 row)

SELECT spanset_hash(intspanset '{[1,2]}') = spanset_hash(intspanset '{[1,2]}');
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash(intspanset '{[1,2]}') <> spanset_hash(intspanset '{[2,2]}');
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash(floatspanset '{[1.5,2.5]}') = spanset_hash(floatspanset '{[1.5,2.5]}');
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash(floatspanset '{[1.5,2.5]}') <> spanset_hash(floatspanset '{[2.5,2.5]}');
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash(tstzspanset '{[2000-01-01,2000-01-02]}') = spanset_hash(tstzspanset '{[2000-01-01,2000-01-02]}');
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash(tstzspanset '{[2000-01-01,2000-01-02]}') <> spanset_hash(tstzspanset '{[2000-01-02,2000-01-02]}');
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash_extended(intspanset '{[1,2]}', 1) = spanset_hash_extended(intspanset '{[1,2]}', 1);
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash_extended(intspanset '{[1,2]}', 1) <> spanset_hash_extended(intspanset '{[2,2]}', 1);
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash_extended(floatspanset '{[1,2]}', 1) = spanset_hash_extended(floatspanset '{[1,2]}', 1);
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash_extended(floatspanset '{[1,2]}', 1) <> spanset_hash_extended(floatspanset '{[2,2]}', 1);
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash_extended(tstzspanset '{[2000-01-01,2000-01-02]}', 1) = spanset_hash_extended(tstzspanset '{[2000-01-01,2000-01-02]}', 1);
 ?column? 
----------
 t
(1 row)

SELECT spanset_hash_extended(tstzspanset '{[2000-01-01,2000-01-02]}', 1) <> spanset_hash_extended(tstzspanset '{[2000-01-02,2000-01-02]}', 1);
 ?column? 
----------
 t
(1 row)

