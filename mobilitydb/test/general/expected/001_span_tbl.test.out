COPY tbl_intspan TO '/tmp/tbl_intspan' (FORMAT BINARY);
COPY 100
COPY tbl_floatspan TO '/tmp/tbl_floatspan' (FORMAT BINARY);
COPY 100
COPY tbl_period TO '/tmp/tbl_period' (FORMAT BINARY);
COPY 100
DROP TABLE IF EXISTS tbl_intspan_tmp;
NOTICE:  table "tbl_intspan_tmp" does not exist, skipping
DROP TABLE
DROP TABLE IF EXISTS tbl_floatspan_tmp;
NOTICE:  table "tbl_floatspan_tmp" does not exist, skipping
DROP TABLE
DROP TABLE IF EXISTS tbl_period_tmp;
NOTICE:  table "tbl_period_tmp" does not exist, skipping
DROP TABLE
CREATE TABLE tbl_intspan_tmp AS TABLE tbl_intspan WITH NO DATA;
CREATE TABLE AS
CREATE TABLE tbl_floatspan_tmp AS TABLE tbl_floatspan WITH NO DATA;
CREATE TABLE AS
CREATE TABLE tbl_period_tmp AS TABLE tbl_period WITH NO DATA;
CREATE TABLE AS
COPY tbl_intspan_tmp FROM '/tmp/tbl_intspan' (FORMAT BINARY);
COPY 100
COPY tbl_floatspan_tmp FROM '/tmp/tbl_floatspan' (FORMAT BINARY);
COPY 100
COPY tbl_period_tmp FROM '/tmp/tbl_period' (FORMAT BINARY);
COPY 100
SELECT COUNT(*) FROM tbl_intspan t1, tbl_intspan_tmp t2 WHERE t1.k = t2.k AND t1.i <> t2.i;
 count 
-------
     0
(1 row)

SELECT COUNT(*) FROM tbl_floatspan t1, tbl_floatspan_tmp t2 WHERE t1.k = t2.k AND t1.f <> t2.f;
 count 
-------
     0
(1 row)

SELECT COUNT(*) FROM tbl_period t1, tbl_period_tmp t2 WHERE t1.k = t2.k AND t1.p <> t2.p;
 count 
-------
     0
(1 row)

DROP TABLE tbl_intspan_tmp;
DROP TABLE
DROP TABLE tbl_floatspan_tmp;
DROP TABLE
DROP TABLE tbl_period_tmp;
DROP TABLE
SELECT COUNT(*) FROM tbl_intspan WHERE intspanFromBinary(asBinary(i)) <> i;
 count 
-------
     0
(1 row)

SELECT COUNT(*) FROM tbl_floatspan WHERE floatspanFromBinary(asBinary(f)) <> f;
 count 
-------
     0
(1 row)

SELECT COUNT(*) FROM tbl_period WHERE periodFromBinary(asBinary(p)) <> p;
 count 
-------
     0
(1 row)

SELECT COUNT(*) FROM tbl_intspan WHERE intspanFromHexWKB(asHexWKB(i)) <> i;
 count 
-------
     0
(1 row)

SELECT COUNT(*) FROM tbl_floatspan WHERE floatspanFromHexWKB(asHexWKB(f)) <> f;
 count 
-------
     0
(1 row)

SELECT COUNT(*) FROM tbl_period WHERE periodFromHexWKB(asHexWKB(p)) <> p;
 count 
-------
     0
(1 row)

SELECT SUM(width(i)) FROM tbl_intspan;
 sum 
-----
 513
(1 row)

SELECT round(SUM(width(f))::numeric, 6) FROM tbl_floatspan;
   round    
------------
 524.526653
(1 row)

SELECT MAX(duration(period(t, t + i))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT MAX(duration(period(t, t + i, true, true))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT MAX(duration(period(t, t + i, true, false))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT MAX(duration(period(t, t + i, false, true))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT MAX(duration(period(t, t + i, false, false))) FROM tbl_timestamptz, tbl_interval;
   max    
----------
 01:39:00
(1 row)

SELECT k, i::int4range FROM tbl_intspan ORDER BY 1;
  k  |    i     
-----+----------
   1 | 
   2 | [19,21)
   3 | [74,83)
   4 | [78,82)
   5 | [38,44)
   6 | [11,15)
   7 | [3,5)
   8 | [87,88)
   9 | [68,74)
  10 | [34,43)
  11 | [30,34)
  12 | [66,70)
  13 | [87,91)
  14 | [88,96)
  15 | [74,79)
  16 | [51,57)
  17 | [83,90)
  18 | [74,80)
  19 | [59,64)
  20 | [92,101)
  21 | [14,15)
  22 | [39,41)
  23 | [20,23)
  24 | [20,28)
  25 | [84,89)
  26 | [83,85)
  27 | [95,100)
  28 | [51,59)
  29 | [82,86)
  30 | [62,68)
  31 | [84,86)
  32 | [13,20)
  33 | [82,90)
  34 | [25,29)
  35 | [39,41)
  36 | [38,43)
  37 | [21,28)
  38 | [69,73)
  39 | [2,11)
  40 | [30,38)
  41 | [44,46)
  42 | [1,5)
  43 | [61,66)
  44 | [22,26)
  45 | [90,98)
  46 | [1,8)
  47 | [95,97)
  48 | [43,51)
  49 | [2,9)
  50 | [19,23)
  51 | [85,91)
  52 | [93,94)
  53 | [33,39)
  54 | [47,51)
  55 | [53,60)
  56 | [21,30)
  57 | [88,90)
  58 | [36,41)
  59 | [72,78)
  60 | [93,99)
  61 | [40,49)
  62 | [38,42)
  63 | [9,17)
  64 | [14,15)
  65 | [48,51)
  66 | [50,54)
  67 | [89,93)
  68 | [40,43)
  69 | [6,14)
  70 | [57,63)
  71 | [62,70)
  72 | [55,60)
  73 | [99,108)
  74 | [1,8)
  75 | [48,57)
  76 | [35,43)
  77 | [88,95)
  78 | [24,33)
  79 | [53,57)
  80 | [6,7)
  81 | [70,76)
  82 | [35,41)
  83 | [98,105)
  84 | [83,84)
  85 | [60,64)
  86 | [63,66)
  87 | [19,21)
  88 | [73,75)
  89 | [9,16)
  90 | [89,95)
  91 | [68,71)
  92 | [44,50)
  93 | [96,103)
  94 | [53,58)
  95 | [6,12)
  96 | [50,57)
  97 | [15,23)
  98 | [36,38)
  99 | [58,60)
 100 | [19,21)
(100 rows)

SELECT k, p::tstzrange FROM tbl_period ORDER BY 1;
  k  |                          p                          
-----+-----------------------------------------------------
   1 | 
   2 | ["2001-12-29 20:53:00+00","2001-12-29 21:00:00+00"]
   3 | ("2001-04-04 03:38:00+00","2001-04-04 03:47:00+00")
   4 | ["2001-03-25 14:48:00+00","2001-03-25 14:49:00+00")
   5 | ("2001-03-14 19:43:00+00","2001-03-14 19:51:00+00"]
   6 | ["2001-03-06 19:10:00+00","2001-03-06 19:17:00+00"]
   7 | ("2001-05-17 09:48:00+00","2001-05-17 09:55:00+00")
   8 | ["2001-10-21 10:13:00+00","2001-10-21 10:13:00+00"]
   9 | ["2001-11-20 23:14:00+00","2001-11-20 23:15:00+00"]
  10 | ["2001-05-15 15:56:00+00","2001-05-15 15:56:00+00"]
  11 | ("2001-03-30 22:10:00+00","2001-03-30 22:13:00+00"]
  12 | ("2001-06-12 04:42:00+00","2001-06-12 04:44:00+00")
  13 | ("2001-04-27 19:39:00+00","2001-04-27 19:41:00+00")
  14 | ("2001-11-24 03:07:00+00","2001-11-24 03:14:00+00"]
  15 | ["2001-07-26 17:32:00+00","2001-07-26 17:34:00+00"]
  16 | ["2001-04-26 13:46:00+00","2001-04-26 13:53:00+00")
  17 | ["2001-10-05 13:37:00+00","2001-10-05 13:41:00+00")
  18 | ("2001-03-18 20:55:00+00","2001-03-18 21:03:00+00"]
  19 | ["2001-04-26 01:52:00+00","2001-04-26 01:56:00+00"]
  20 | ["2001-01-22 18:30:00+00","2001-01-22 18:31:00+00"]
  21 | ("2001-05-02 16:54:00+00","2001-05-02 17:01:00+00"]
  22 | ("2001-06-21 13:54:00+00","2001-06-21 13:59:00+00")
  23 | ("2001-09-26 08:57:00+00","2001-09-26 09:06:00+00"]
  24 | ("2001-07-02 23:14:00+00","2001-07-02 23:20:00+00"]
  25 | ["2001-03-29 15:35:00+00","2001-03-29 15:41:00+00")
  26 | ("2001-12-07 04:42:00+00","2001-12-07 04:50:00+00"]
  27 | ["2001-05-02 19:40:00+00","2001-05-02 19:47:00+00"]
  28 | ["2001-09-04 04:23:00+00","2001-09-04 04:27:00+00"]
  29 | ("2001-06-17 08:09:00+00","2001-06-17 08:11:00+00"]
  30 | ("2001-04-26 07:11:00+00","2001-04-26 07:18:00+00"]
  31 | ["2001-09-17 22:13:00+00","2001-09-17 22:13:00+00"]
  32 | ("2001-08-30 05:21:00+00","2001-08-30 05:23:00+00")
  33 | ["2001-06-10 20:47:00+00","2001-06-10 20:55:00+00")
  34 | ["2001-08-15 22:54:00+00","2001-08-15 23:02:00+00")
  35 | ["2001-09-07 12:41:00+00","2001-09-07 12:48:00+00")
  36 | ("2001-01-18 19:13:00+00","2001-01-18 19:20:00+00")
  37 | ("2001-06-28 04:16:00+00","2001-06-28 04:17:00+00")
  38 | ("2001-06-21 11:10:00+00","2001-06-21 11:12:00+00"]
  39 | ["2001-07-11 22:02:00+00","2001-07-11 22:06:00+00")
  40 | ["2001-07-25 15:02:00+00","2001-07-25 15:05:00+00")
  41 | ["2001-05-01 14:55:00+00","2001-05-01 15:03:00+00"]
  42 | ("2001-04-13 06:25:00+00","2001-04-13 06:27:00+00"]
  43 | ["2001-11-19 14:46:00+00","2001-11-19 14:50:00+00")
  44 | ("2001-09-17 08:55:00+00","2001-09-17 09:00:00+00")
  45 | ["2001-06-06 16:00:00+00","2001-06-06 16:08:00+00")
  46 | ["2001-12-10 21:57:00+00","2001-12-10 22:05:00+00")
  47 | ["2001-12-26 11:34:00+00","2001-12-26 11:41:00+00"]
  48 | ["2001-06-03 05:42:00+00","2001-06-03 05:47:00+00"]
  49 | ["2001-11-01 15:13:00+00","2001-11-01 15:21:00+00")
  50 | ["2001-12-12 23:42:00+00","2001-12-12 23:44:00+00")
  51 | ["2001-02-25 19:28:00+00","2001-02-25 19:35:00+00"]
  52 | ("2001-08-29 07:16:00+00","2001-08-29 07:18:00+00")
  53 | ["2001-04-09 21:21:00+00","2001-04-09 21:30:00+00"]
  54 | ["2001-08-07 12:24:00+00","2001-08-07 12:33:00+00")
  55 | ["2001-03-02 09:39:00+00","2001-03-02 09:39:00+00"]
  56 | ["2001-05-31 02:34:00+00","2001-05-31 02:41:00+00")
  57 | ["2001-08-29 02:53:00+00","2001-08-29 02:54:00+00"]
  58 | ["2001-07-15 07:04:00+00","2001-07-15 07:08:00+00")
  59 | ["2001-07-13 01:15:00+00","2001-07-13 01:16:00+00"]
  60 | ["2001-02-15 07:56:00+00","2001-02-15 07:58:00+00")
  61 | ("2001-03-11 15:48:00+00","2001-03-11 15:57:00+00")
  62 | ["2001-06-29 19:08:00+00","2001-06-29 19:15:00+00")
  63 | ["2001-05-16 17:56:00+00","2001-05-16 18:01:00+00")
  64 | ("2001-10-17 01:24:00+00","2001-10-17 01:26:00+00"]
  65 | ["2001-07-26 17:00:00+00","2001-07-26 17:08:00+00")
  66 | ("2001-12-07 19:29:00+00","2001-12-07 19:34:00+00"]
  67 | ["2001-08-13 12:50:00+00","2001-08-13 12:50:00+00"]
  68 | ["2001-03-19 09:54:00+00","2001-03-19 09:54:00+00"]
  69 | ["2001-02-17 22:58:00+00","2001-02-17 23:06:00+00"]
  70 | ("2001-07-15 21:52:00+00","2001-07-15 21:54:00+00")
  71 | ["2001-06-11 20:32:00+00","2001-06-11 20:41:00+00")
  72 | ["2001-07-19 07:42:00+00","2001-07-19 07:45:00+00"]
  73 | ("2001-11-02 14:13:00+00","2001-11-02 14:22:00+00")
  74 | ["2001-01-20 02:40:00+00","2001-01-20 02:49:00+00")
  75 | ("2001-08-16 16:19:00+00","2001-08-16 16:27:00+00")
  76 | ("2001-11-13 19:17:00+00","2001-11-13 19:26:00+00")
  77 | ["2001-05-26 04:17:00+00","2001-05-26 04:24:00+00")
  78 | ("2001-08-08 07:51:00+00","2001-08-08 07:57:00+00")
  79 | ("2001-05-24 14:46:00+00","2001-05-24 14:49:00+00"]
  80 | ["2001-01-30 19:10:00+00","2001-01-30 19:17:00+00"]
  81 | ["2001-12-08 16:37:00+00","2001-12-08 16:42:00+00")
  82 | ("2001-10-28 01:53:00+00","2001-10-28 02:02:00+00")
  83 | ("2001-01-20 18:40:00+00","2001-01-20 18:48:00+00"]
  84 | ["2001-02-23 05:50:00+00","2001-02-23 05:54:00+00")
  85 | ("2001-04-03 03:50:00+00","2001-04-03 03:53:00+00")
  86 | ["2001-08-25 14:58:00+00","2001-08-25 15:00:00+00"]
  87 | ("2001-08-31 21:52:00+00","2001-08-31 21:58:00+00"]
  88 | ("2001-11-10 12:08:00+00","2001-11-10 12:14:00+00")
  89 | ["2001-05-27 09:34:00+00","2001-05-27 09:34:00+00"]
  90 | ["2001-01-21 13:52:00+00","2001-01-21 14:01:00+00"]
  91 | ("2001-01-23 09:23:00+00","2001-01-23 09:31:00+00")
  92 | ("2001-11-19 06:06:00+00","2001-11-19 06:11:00+00")
  93 | ["2001-08-16 15:44:00+00","2001-08-16 15:44:00+00"]
  94 | ["2001-03-08 15:44:00+00","2001-03-08 15:46:00+00"]
  95 | ("2001-05-17 09:27:00+00","2001-05-17 09:35:00+00"]
  96 | ("2001-01-10 13:55:00+00","2001-01-10 13:59:00+00")
  97 | ("2001-01-15 03:35:00+00","2001-01-15 03:44:00+00"]
  98 | ("2001-11-13 18:05:00+00","2001-11-13 18:06:00+00"]
  99 | ("2001-04-23 21:56:00+00","2001-04-23 22:01:00+00"]
 100 | ["2001-04-30 10:04:00+00","2001-04-30 10:04:00+00"]
(100 rows)

SELECT k, r::period FROM tbl_tstzrange ORDER BY 1;
  k  |                        r                         
-----+--------------------------------------------------
   1 | 
   2 | [2001-08-18 08:25:00+00, 2001-08-18 08:30:00+00)
   3 | [2001-06-21 13:57:00+00, 2001-06-21 13:59:00+00]
   4 | (2001-09-03 08:36:00+00, 2001-09-03 08:42:00+00]
   5 | [2001-12-06 23:12:00+00, 2001-12-06 23:13:00+00]
   6 | [2001-09-27 09:57:00+00, 2001-09-27 10:01:00+00]
   7 | (2001-02-04 08:27:00+00, 2001-02-04 08:33:00+00)
   8 | (2001-12-16 00:54:00+00, 2001-12-16 01:02:00+00]
   9 | (2001-07-29 16:25:00+00, 2001-07-29 16:34:00+00)
  10 | (2001-07-22 20:42:00+00, 2001-07-22 20:51:00+00]
  11 | [2001-09-01 06:29:00+00, 2001-09-01 06:37:00+00)
  12 | [2001-09-28 01:20:00+00, 2001-09-28 01:22:00+00]
  13 | [2001-03-05 19:27:00+00, 2001-03-05 19:34:00+00]
  14 | (2001-07-16 15:12:00+00, 2001-07-16 15:15:00+00]
  15 | (2001-03-27 01:54:00+00, 2001-03-27 01:59:00+00]
  16 | [2001-05-02 09:25:00+00, 2001-05-02 09:27:00+00)
  17 | [2001-06-01 11:06:00+00, 2001-06-01 11:06:00+00]
  18 | [2001-01-01 02:06:00+00, 2001-01-01 02:15:00+00]
  19 | [2001-10-22 05:33:00+00, 2001-10-22 05:41:00+00]
  20 | (2001-03-21 00:35:00+00, 2001-03-21 00:39:00+00]
  21 | [2001-01-25 16:16:00+00, 2001-01-25 16:22:00+00)
  22 | (2001-03-14 01:48:00+00, 2001-03-14 01:49:00+00]
  23 | [2001-05-21 17:35:00+00, 2001-05-21 17:41:00+00)
  24 | [2001-08-09 15:56:00+00, 2001-08-09 15:59:00+00)
  25 | [2001-09-13 08:05:00+00, 2001-09-13 08:14:00+00)
  26 | [2001-10-16 17:05:00+00, 2001-10-16 17:09:00+00)
  27 | [2001-02-16 12:19:00+00, 2001-02-16 12:26:00+00)
  28 | (2001-06-01 02:31:00+00, 2001-06-01 02:32:00+00]
  29 | [2001-07-10 06:08:00+00, 2001-07-10 06:08:00+00]
  30 | [2001-04-12 23:36:00+00, 2001-04-12 23:36:00+00]
  31 | [2001-07-12 16:27:00+00, 2001-07-12 16:34:00+00)
  32 | (2001-10-30 11:39:00+00, 2001-10-30 11:42:00+00]
  33 | (2001-08-26 03:54:00+00, 2001-08-26 03:59:00+00)
  34 | [2001-05-20 06:10:00+00, 2001-05-20 06:13:00+00]
  35 | [2001-09-30 11:40:00+00, 2001-09-30 11:48:00+00)
  36 | (2001-04-28 17:11:00+00, 2001-04-28 17:15:00+00)
  37 | (2001-05-14 17:47:00+00, 2001-05-14 17:56:00+00)
  38 | (2001-01-26 14:16:00+00, 2001-01-26 14:23:00+00]
  39 | (2001-08-08 05:11:00+00, 2001-08-08 05:14:00+00]
  40 | [2001-11-26 16:39:00+00, 2001-11-26 16:47:00+00]
  41 | (2001-12-25 04:27:00+00, 2001-12-25 04:31:00+00]
  42 | (2001-01-01 13:22:00+00, 2001-01-01 13:26:00+00)
  43 | (2001-11-12 06:58:00+00, 2001-11-12 07:05:00+00)
  44 | [2001-02-20 04:03:00+00, 2001-02-20 04:11:00+00)
  45 | [2001-03-23 18:19:00+00, 2001-03-23 18:19:00+00]
  46 | [2001-12-09 23:57:00+00, 2001-12-10 00:02:00+00)
  47 | (2001-11-05 23:35:00+00, 2001-11-05 23:43:00+00]
  48 | [2001-05-07 05:28:00+00, 2001-05-07 05:36:00+00]
  49 | (2001-07-16 22:47:00+00, 2001-07-16 22:48:00+00]
  50 | (2001-11-22 05:57:00+00, 2001-11-22 06:00:00+00]
  51 | [2001-06-30 23:07:00+00, 2001-06-30 23:11:00+00)
  52 | (2001-08-31 12:36:00+00, 2001-08-31 12:40:00+00)
  53 | (2001-07-24 23:11:00+00, 2001-07-24 23:20:00+00]
  54 | [2001-03-13 21:49:00+00, 2001-03-13 21:56:00+00]
  55 | [2001-08-25 19:13:00+00, 2001-08-25 19:15:00+00]
  56 | (2001-11-15 15:55:00+00, 2001-11-15 15:59:00+00)
  57 | [2001-07-12 20:05:00+00, 2001-07-12 20:13:00+00)
  58 | (2001-11-20 15:18:00+00, 2001-11-20 15:21:00+00]
  59 | [2001-07-02 21:02:00+00, 2001-07-02 21:03:00+00]
  60 | [2001-06-07 14:00:00+00, 2001-06-07 14:00:00+00]
  61 | [2001-02-01 21:21:00+00, 2001-02-01 21:29:00+00]
  62 | [2001-01-19 23:45:00+00, 2001-01-19 23:50:00+00)
  63 | [2001-06-15 20:59:00+00, 2001-06-15 21:00:00+00]
  64 | (2001-03-11 23:17:00+00, 2001-03-11 23:19:00+00)
  65 | (2001-01-29 09:40:00+00, 2001-01-29 09:47:00+00)
  66 | (2001-07-30 10:39:00+00, 2001-07-30 10:42:00+00]
  67 | (2001-06-29 10:06:00+00, 2001-06-29 10:11:00+00)
  68 | (2001-05-14 17:21:00+00, 2001-05-14 17:26:00+00)
  69 | (2001-08-19 10:57:00+00, 2001-08-19 11:01:00+00)
  70 | [2001-02-01 03:54:00+00, 2001-02-01 03:59:00+00)
  71 | [2001-11-02 16:25:00+00, 2001-11-02 16:32:00+00]
  72 | [2001-04-30 14:20:00+00, 2001-04-30 14:22:00+00]
  73 | [2001-11-06 17:52:00+00, 2001-11-06 17:58:00+00)
  74 | [2001-07-09 11:59:00+00, 2001-07-09 12:07:00+00]
  75 | (2001-05-25 17:15:00+00, 2001-05-25 17:20:00+00)
  76 | [2001-09-05 08:21:00+00, 2001-09-05 08:29:00+00)
  77 | (2001-06-05 22:09:00+00, 2001-06-05 22:10:00+00)
  78 | [2001-12-14 21:49:00+00, 2001-12-14 21:52:00+00]
  79 | [2001-11-03 05:27:00+00, 2001-11-03 05:34:00+00]
  80 | (2001-02-03 05:50:00+00, 2001-02-03 05:51:00+00]
  81 | (2001-03-31 00:49:00+00, 2001-03-31 00:57:00+00]
  82 | (2001-11-03 08:35:00+00, 2001-11-03 08:41:00+00]
  83 | [2001-03-01 18:15:00+00, 2001-03-01 18:18:00+00)
  84 | [2001-11-11 12:28:00+00, 2001-11-11 12:36:00+00)
  85 | (2001-12-08 06:34:00+00, 2001-12-08 06:36:00+00)
  86 | [2001-12-25 09:23:00+00, 2001-12-25 09:28:00+00)
  87 | [2001-07-08 19:52:00+00, 2001-07-08 19:55:00+00]
  88 | [2001-08-31 22:19:00+00, 2001-08-31 22:24:00+00]
  89 | [2001-02-10 19:35:00+00, 2001-02-10 19:40:00+00]
  90 | [2001-12-19 15:07:00+00, 2001-12-19 15:10:00+00]
  91 | [2001-10-11 18:18:00+00, 2001-10-11 18:19:00+00)
  92 | [2001-09-22 20:40:00+00, 2001-09-22 20:40:00+00]
  93 | (2001-08-25 05:19:00+00, 2001-08-25 05:26:00+00)
  94 | [2001-02-15 09:11:00+00, 2001-02-15 09:11:00+00]
  95 | [2001-08-02 17:36:00+00, 2001-08-02 17:45:00+00)
  96 | (2001-09-11 20:22:00+00, 2001-09-11 20:26:00+00]
  97 | (2001-11-19 03:57:00+00, 2001-11-19 04:00:00+00]
  98 | (2001-01-17 04:14:00+00, 2001-01-17 04:18:00+00]
  99 | (2001-02-14 13:15:00+00, 2001-02-14 13:19:00+00)
 100 | [2001-05-16 04:09:00+00, 2001-05-16 04:16:00+00)
(100 rows)

SELECT k, t::period FROM tbl_timestamptz ORDER BY 1;
  k  |                        t                         
-----+--------------------------------------------------
   1 | 
   2 | [2001-06-14 21:11:00+00, 2001-06-14 21:11:00+00]
   3 | [2001-04-01 00:47:00+00, 2001-04-01 00:47:00+00]
   4 | [2001-07-11 01:31:00+00, 2001-07-11 01:31:00+00]
   5 | [2001-04-01 17:37:00+00, 2001-04-01 17:37:00+00]
   6 | [2001-12-08 20:23:00+00, 2001-12-08 20:23:00+00]
   7 | [2001-03-01 09:14:00+00, 2001-03-01 09:14:00+00]
   8 | [2001-05-11 20:09:00+00, 2001-05-11 20:09:00+00]
   9 | [2001-03-31 04:25:00+00, 2001-03-31 04:25:00+00]
  10 | [2001-10-11 02:54:00+00, 2001-10-11 02:54:00+00]
  11 | [2001-07-18 01:57:00+00, 2001-07-18 01:57:00+00]
  12 | [2001-04-19 16:38:00+00, 2001-04-19 16:38:00+00]
  13 | [2001-09-16 18:15:00+00, 2001-09-16 18:15:00+00]
  14 | [2001-07-22 23:46:00+00, 2001-07-22 23:46:00+00]
  15 | [2001-01-01 02:36:00+00, 2001-01-01 02:36:00+00]
  16 | [2001-11-18 17:34:00+00, 2001-11-18 17:34:00+00]
  17 | [2001-10-06 23:08:00+00, 2001-10-06 23:08:00+00]
  18 | [2001-05-01 18:28:00+00, 2001-05-01 18:28:00+00]
  19 | [2001-03-05 17:58:00+00, 2001-03-05 17:58:00+00]
  20 | [2001-11-08 10:14:00+00, 2001-11-08 10:14:00+00]
  21 | [2001-01-09 15:47:00+00, 2001-01-09 15:47:00+00]
  22 | [2001-02-18 09:31:00+00, 2001-02-18 09:31:00+00]
  23 | [2001-11-09 06:18:00+00, 2001-11-09 06:18:00+00]
  24 | [2001-09-12 15:59:00+00, 2001-09-12 15:59:00+00]
  25 | [2001-04-18 19:25:00+00, 2001-04-18 19:25:00+00]
  26 | [2001-09-20 02:42:00+00, 2001-09-20 02:42:00+00]
  27 | [2001-06-21 12:58:00+00, 2001-06-21 12:58:00+00]
  28 | [2001-09-17 10:51:00+00, 2001-09-17 10:51:00+00]
  29 | [2001-05-19 12:35:00+00, 2001-05-19 12:35:00+00]
  30 | [2001-08-15 07:04:00+00, 2001-08-15 07:04:00+00]
  31 | [2001-07-05 03:49:00+00, 2001-07-05 03:49:00+00]
  32 | [2001-01-29 04:33:00+00, 2001-01-29 04:33:00+00]
  33 | [2001-01-28 07:16:00+00, 2001-01-28 07:16:00+00]
  34 | [2001-10-03 06:36:00+00, 2001-10-03 06:36:00+00]
  35 | [2001-08-08 07:05:00+00, 2001-08-08 07:05:00+00]
  36 | [2001-04-29 01:53:00+00, 2001-04-29 01:53:00+00]
  37 | [2001-09-11 03:59:00+00, 2001-09-11 03:59:00+00]
  38 | [2001-10-06 17:19:00+00, 2001-10-06 17:19:00+00]
  39 | [2001-09-07 00:03:00+00, 2001-09-07 00:03:00+00]
  40 | [2001-12-09 11:25:00+00, 2001-12-09 11:25:00+00]
  41 | [2001-07-17 22:14:00+00, 2001-07-17 22:14:00+00]
  42 | [2001-03-25 05:01:00+00, 2001-03-25 05:01:00+00]
  43 | [2001-03-29 05:03:00+00, 2001-03-29 05:03:00+00]
  44 | [2001-04-03 18:30:00+00, 2001-04-03 18:30:00+00]
  45 | [2001-10-14 05:47:00+00, 2001-10-14 05:47:00+00]
  46 | [2001-03-29 08:39:00+00, 2001-03-29 08:39:00+00]
  47 | [2001-02-20 14:04:00+00, 2001-02-20 14:04:00+00]
  48 | [2001-07-21 06:55:00+00, 2001-07-21 06:55:00+00]
  49 | [2001-07-28 05:08:00+00, 2001-07-28 05:08:00+00]
  50 | [2001-04-25 08:03:00+00, 2001-04-25 08:03:00+00]
  51 | [2001-05-29 18:10:00+00, 2001-05-29 18:10:00+00]
  52 | [2001-08-05 21:55:00+00, 2001-08-05 21:55:00+00]
  53 | [2001-06-12 18:35:00+00, 2001-06-12 18:35:00+00]
  54 | [2001-04-08 01:29:00+00, 2001-04-08 01:29:00+00]
  55 | [2001-04-18 15:55:00+00, 2001-04-18 15:55:00+00]
  56 | [2001-09-28 16:00:00+00, 2001-09-28 16:00:00+00]
  57 | [2001-12-26 07:12:00+00, 2001-12-26 07:12:00+00]
  58 | [2001-10-07 06:53:00+00, 2001-10-07 06:53:00+00]
  59 | [2001-06-16 04:51:00+00, 2001-06-16 04:51:00+00]
  60 | [2001-05-14 20:47:00+00, 2001-05-14 20:47:00+00]
  61 | [2001-05-22 15:57:00+00, 2001-05-22 15:57:00+00]
  62 | [2001-12-18 11:40:00+00, 2001-12-18 11:40:00+00]
  63 | [2001-06-12 02:20:00+00, 2001-06-12 02:20:00+00]
  64 | [2001-06-19 00:14:00+00, 2001-06-19 00:14:00+00]
  65 | [2001-09-20 19:17:00+00, 2001-09-20 19:17:00+00]
  66 | [2001-01-18 12:26:00+00, 2001-01-18 12:26:00+00]
  67 | [2001-10-15 04:07:00+00, 2001-10-15 04:07:00+00]
  68 | [2001-06-02 01:17:00+00, 2001-06-02 01:17:00+00]
  69 | [2001-10-24 06:45:00+00, 2001-10-24 06:45:00+00]
  70 | [2001-06-22 06:11:00+00, 2001-06-22 06:11:00+00]
  71 | [2001-05-11 13:42:00+00, 2001-05-11 13:42:00+00]
  72 | [2001-05-11 07:00:00+00, 2001-05-11 07:00:00+00]
  73 | [2001-09-13 12:12:00+00, 2001-09-13 12:12:00+00]
  74 | [2001-08-06 20:45:00+00, 2001-08-06 20:45:00+00]
  75 | [2001-08-12 03:30:00+00, 2001-08-12 03:30:00+00]
  76 | [2001-06-27 19:59:00+00, 2001-06-27 19:59:00+00]
  77 | [2001-11-02 08:25:00+00, 2001-11-02 08:25:00+00]
  78 | [2001-10-01 18:34:00+00, 2001-10-01 18:34:00+00]
  79 | [2001-01-16 05:55:00+00, 2001-01-16 05:55:00+00]
  80 | [2001-05-30 14:33:00+00, 2001-05-30 14:33:00+00]
  81 | [2001-01-25 05:37:00+00, 2001-01-25 05:37:00+00]
  82 | [2001-06-14 01:06:00+00, 2001-06-14 01:06:00+00]
  83 | [2001-01-03 15:29:00+00, 2001-01-03 15:29:00+00]
  84 | [2001-07-07 01:12:00+00, 2001-07-07 01:12:00+00]
  85 | [2001-09-19 04:35:00+00, 2001-09-19 04:35:00+00]
  86 | [2001-04-21 08:24:00+00, 2001-04-21 08:24:00+00]
  87 | [2001-04-04 19:12:00+00, 2001-04-04 19:12:00+00]
  88 | [2001-09-14 12:47:00+00, 2001-09-14 12:47:00+00]
  89 | [2001-01-26 18:18:00+00, 2001-01-26 18:18:00+00]
  90 | [2001-09-18 02:03:00+00, 2001-09-18 02:03:00+00]
  91 | [2001-01-27 12:34:00+00, 2001-01-27 12:34:00+00]
  92 | [2001-06-17 11:16:00+00, 2001-06-17 11:16:00+00]
  93 | [2001-09-05 14:44:00+00, 2001-09-05 14:44:00+00]
  94 | [2001-07-08 15:55:00+00, 2001-07-08 15:55:00+00]
  95 | [2001-12-03 14:30:00+00, 2001-12-03 14:30:00+00]
  96 | [2001-05-27 12:02:00+00, 2001-05-27 12:02:00+00]
  97 | [2001-07-26 05:21:00+00, 2001-07-26 05:21:00+00]
  98 | [2001-09-17 19:38:00+00, 2001-09-17 19:38:00+00]
  99 | [2001-10-26 15:19:00+00, 2001-10-26 15:19:00+00]
 100 | [2001-05-19 14:07:00+00, 2001-05-19 14:07:00+00]
(100 rows)

SELECT lower(p) FROM tbl_period;
         lower          
------------------------
 2001-04-26 07:11:00+00
 2001-03-14 19:43:00+00
 2001-06-10 20:47:00+00
 2001-05-24 14:46:00+00
 2001-07-11 22:02:00+00
 2001-04-27 19:39:00+00
 2001-03-25 14:48:00+00
 2001-02-15 07:56:00+00
 2001-01-10 13:55:00+00
 2001-09-26 08:57:00+00
 2001-06-11 20:32:00+00
 2001-10-28 01:53:00+00
 2001-02-23 05:50:00+00
 2001-12-12 23:42:00+00
 2001-06-06 16:00:00+00
 2001-06-28 04:16:00+00
 2001-12-08 16:37:00+00
 2001-10-17 01:24:00+00
 2001-09-04 04:23:00+00
 2001-05-16 17:56:00+00
 
 2001-05-26 04:17:00+00
 2001-08-16 16:19:00+00
 2001-01-15 03:35:00+00
 2001-04-13 06:25:00+00
 2001-07-15 07:04:00+00
 2001-08-13 12:50:00+00
 2001-03-18 20:55:00+00
 2001-06-29 19:08:00+00
 2001-08-30 05:21:00+00
 2001-09-17 08:55:00+00
 2001-08-08 07:51:00+00
 2001-05-02 16:54:00+00
 2001-10-05 13:37:00+00
 2001-03-30 22:10:00+00
 2001-12-07 04:42:00+00
 2001-07-25 15:02:00+00
 2001-05-27 09:34:00+00
 2001-03-06 19:10:00+00
 2001-07-15 21:52:00+00
 2001-03-19 09:54:00+00
 2001-04-26 13:46:00+00
 2001-01-23 09:23:00+00
 2001-05-17 09:27:00+00
 2001-08-25 14:58:00+00
 2001-04-03 03:50:00+00
 2001-04-04 03:38:00+00
 2001-03-11 15:48:00+00
 2001-04-26 01:52:00+00
 2001-01-22 18:30:00+00
 2001-01-20 02:40:00+00
 2001-11-13 18:05:00+00
 2001-05-02 19:40:00+00
 2001-01-30 19:10:00+00
 2001-01-18 19:13:00+00
 2001-05-31 02:34:00+00
 2001-07-19 07:42:00+00
 2001-11-10 12:08:00+00
 2001-07-13 01:15:00+00
 2001-05-15 15:56:00+00
 2001-08-16 15:44:00+00
 2001-03-29 15:35:00+00
 2001-02-17 22:58:00+00
 2001-03-08 15:44:00+00
 2001-04-09 21:21:00+00
 2001-09-07 12:41:00+00
 2001-06-21 13:54:00+00
 2001-12-07 19:29:00+00
 2001-02-25 19:28:00+00
 2001-01-21 13:52:00+00
 2001-06-03 05:42:00+00
 2001-11-19 14:46:00+00
 2001-09-17 22:13:00+00
 2001-10-21 10:13:00+00
 2001-12-26 11:34:00+00
 2001-05-17 09:48:00+00
 2001-12-10 21:57:00+00
 2001-06-21 11:10:00+00
 2001-04-23 21:56:00+00
 2001-05-01 14:55:00+00
 2001-06-12 04:42:00+00
 2001-11-02 14:13:00+00
 2001-12-29 20:53:00+00
 2001-11-13 19:17:00+00
 2001-08-15 22:54:00+00
 2001-07-26 17:00:00+00
 2001-01-20 18:40:00+00
 2001-04-30 10:04:00+00
 2001-03-02 09:39:00+00
 2001-08-31 21:52:00+00
 2001-07-26 17:32:00+00
 2001-11-20 23:14:00+00
 2001-11-19 06:06:00+00
 2001-08-29 07:16:00+00
 2001-08-07 12:24:00+00
 2001-08-29 02:53:00+00
 2001-07-02 23:14:00+00
 2001-11-24 03:07:00+00
 2001-06-17 08:09:00+00
 2001-11-01 15:13:00+00
(100 rows)

SELECT upper(p) FROM tbl_period;
         upper          
------------------------
 2001-04-26 07:18:00+00
 2001-03-14 19:51:00+00
 2001-06-10 20:55:00+00
 2001-05-24 14:49:00+00
 2001-07-11 22:06:00+00
 2001-04-27 19:41:00+00
 2001-03-25 14:49:00+00
 2001-02-15 07:58:00+00
 2001-01-10 13:59:00+00
 2001-09-26 09:06:00+00
 2001-06-11 20:41:00+00
 2001-10-28 02:02:00+00
 2001-02-23 05:54:00+00
 2001-12-12 23:44:00+00
 2001-06-06 16:08:00+00
 2001-06-28 04:17:00+00
 2001-12-08 16:42:00+00
 2001-10-17 01:26:00+00
 2001-09-04 04:27:00+00
 2001-05-16 18:01:00+00
 
 2001-05-26 04:24:00+00
 2001-08-16 16:27:00+00
 2001-01-15 03:44:00+00
 2001-04-13 06:27:00+00
 2001-07-15 07:08:00+00
 2001-08-13 12:50:00+00
 2001-03-18 21:03:00+00
 2001-06-29 19:15:00+00
 2001-08-30 05:23:00+00
 2001-09-17 09:00:00+00
 2001-08-08 07:57:00+00
 2001-05-02 17:01:00+00
 2001-10-05 13:41:00+00
 2001-03-30 22:13:00+00
 2001-12-07 04:50:00+00
 2001-07-25 15:05:00+00
 2001-05-27 09:34:00+00
 2001-03-06 19:17:00+00
 2001-07-15 21:54:00+00
 2001-03-19 09:54:00+00
 2001-04-26 13:53:00+00
 2001-01-23 09:31:00+00
 2001-05-17 09:35:00+00
 2001-08-25 15:00:00+00
 2001-04-03 03:53:00+00
 2001-04-04 03:47:00+00
 2001-03-11 15:57:00+00
 2001-04-26 01:56:00+00
 2001-01-22 18:31:00+00
 2001-01-20 02:49:00+00
 2001-11-13 18:06:00+00
 2001-05-02 19:47:00+00
 2001-01-30 19:17:00+00
 2001-01-18 19:20:00+00
 2001-05-31 02:41:00+00
 2001-07-19 07:45:00+00
 2001-11-10 12:14:00+00
 2001-07-13 01:16:00+00
 2001-05-15 15:56:00+00
 2001-08-16 15:44:00+00
 2001-03-29 15:41:00+00
 2001-02-17 23:06:00+00
 2001-03-08 15:46:00+00
 2001-04-09 21:30:00+00
 2001-09-07 12:48:00+00
 2001-06-21 13:59:00+00
 2001-12-07 19:34:00+00
 2001-02-25 19:35:00+00
 2001-01-21 14:01:00+00
 2001-06-03 05:47:00+00
 2001-11-19 14:50:00+00
 2001-09-17 22:13:00+00
 2001-10-21 10:13:00+00
 2001-12-26 11:41:00+00
 2001-05-17 09:55:00+00
 2001-12-10 22:05:00+00
 2001-06-21 11:12:00+00
 2001-04-23 22:01:00+00
 2001-05-01 15:03:00+00
 2001-06-12 04:44:00+00
 2001-11-02 14:22:00+00
 2001-12-29 21:00:00+00
 2001-11-13 19:26:00+00
 2001-08-15 23:02:00+00
 2001-07-26 17:08:00+00
 2001-01-20 18:48:00+00
 2001-04-30 10:04:00+00
 2001-03-02 09:39:00+00
 2001-08-31 21:58:00+00
 2001-07-26 17:34:00+00
 2001-11-20 23:15:00+00
 2001-11-19 06:11:00+00
 2001-08-29 07:18:00+00
 2001-08-07 12:33:00+00
 2001-08-29 02:54:00+00
 2001-07-02 23:20:00+00
 2001-11-24 03:14:00+00
 2001-06-17 08:11:00+00
 2001-11-01 15:21:00+00
(100 rows)

SELECT lower_inc(p) FROM tbl_period;
 lower_inc 
-----------
 f
 f
 t
 f
 t
 f
 t
 t
 f
 f
 t
 f
 t
 t
 t
 f
 t
 f
 t
 t
 
 t
 f
 f
 f
 t
 t
 f
 t
 f
 f
 f
 f
 t
 f
 f
 t
 t
 t
 f
 t
 t
 f
 f
 t
 f
 f
 f
 t
 t
 t
 f
 t
 t
 f
 t
 t
 f
 t
 t
 t
 t
 t
 t
 t
 t
 f
 f
 t
 t
 t
 t
 t
 t
 t
 f
 t
 f
 f
 t
 f
 f
 t
 f
 t
 t
 f
 t
 t
 f
 t
 t
 f
 f
 t
 t
 f
 f
 f
 t
(100 rows)

SELECT upper_inc(p) FROM tbl_period;
 upper_inc 
-----------
 t
 t
 f
 t
 f
 f
 f
 f
 f
 t
 f
 f
 f
 f
 f
 f
 f
 t
 t
 f
 
 f
 f
 t
 t
 f
 t
 t
 f
 f
 f
 f
 t
 f
 t
 t
 f
 t
 t
 f
 t
 f
 f
 t
 t
 f
 f
 f
 t
 t
 f
 t
 t
 t
 f
 f
 t
 f
 t
 t
 t
 f
 t
 t
 t
 f
 f
 t
 t
 t
 t
 f
 t
 t
 t
 f
 f
 t
 t
 t
 f
 f
 t
 f
 f
 f
 t
 t
 t
 t
 t
 t
 f
 f
 f
 t
 t
 t
 t
 f
(100 rows)

SELECT duration(p) FROM tbl_period;
 duration 
----------
 00:07:00
 00:08:00
 00:08:00
 00:03:00
 00:04:00
 00:02:00
 00:01:00
 00:02:00
 00:04:00
 00:09:00
 00:09:00
 00:09:00
 00:04:00
 00:02:00
 00:08:00
 00:01:00
 00:05:00
 00:02:00
 00:04:00
 00:05:00
 
 00:07:00
 00:08:00
 00:09:00
 00:02:00
 00:04:00
 00:00:00
 00:08:00
 00:07:00
 00:02:00
 00:05:00
 00:06:00
 00:07:00
 00:04:00
 00:03:00
 00:08:00
 00:03:00
 00:00:00
 00:07:00
 00:02:00
 00:00:00
 00:07:00
 00:08:00
 00:08:00
 00:02:00
 00:03:00
 00:09:00
 00:09:00
 00:04:00
 00:01:00
 00:09:00
 00:01:00
 00:07:00
 00:07:00
 00:07:00
 00:07:00
 00:03:00
 00:06:00
 00:01:00
 00:00:00
 00:00:00
 00:06:00
 00:08:00
 00:02:00
 00:09:00
 00:07:00
 00:05:00
 00:05:00
 00:07:00
 00:09:00
 00:05:00
 00:04:00
 00:00:00
 00:00:00
 00:07:00
 00:07:00
 00:08:00
 00:02:00
 00:05:00
 00:08:00
 00:02:00
 00:09:00
 00:07:00
 00:09:00
 00:08:00
 00:08:00
 00:08:00
 00:00:00
 00:00:00
 00:06:00
 00:02:00
 00:01:00
 00:05:00
 00:02:00
 00:09:00
 00:01:00
 00:06:00
 00:07:00
 00:02:00
 00:08:00
(100 rows)

SELECT shift(p, '5 min') FROM tbl_period;
                      shift                       
--------------------------------------------------
 (2001-04-26 07:16:00+00, 2001-04-26 07:23:00+00]
 (2001-03-14 19:48:00+00, 2001-03-14 19:56:00+00]
 [2001-06-10 20:52:00+00, 2001-06-10 21:00:00+00)
 (2001-05-24 14:51:00+00, 2001-05-24 14:54:00+00]
 [2001-07-11 22:07:00+00, 2001-07-11 22:11:00+00)
 (2001-04-27 19:44:00+00, 2001-04-27 19:46:00+00)
 [2001-03-25 14:53:00+00, 2001-03-25 14:54:00+00)
 [2001-02-15 08:01:00+00, 2001-02-15 08:03:00+00)
 (2001-01-10 14:00:00+00, 2001-01-10 14:04:00+00)
 (2001-09-26 09:02:00+00, 2001-09-26 09:11:00+00]
 [2001-06-11 20:37:00+00, 2001-06-11 20:46:00+00)
 (2001-10-28 01:58:00+00, 2001-10-28 02:07:00+00)
 [2001-02-23 05:55:00+00, 2001-02-23 05:59:00+00)
 [2001-12-12 23:47:00+00, 2001-12-12 23:49:00+00)
 [2001-06-06 16:05:00+00, 2001-06-06 16:13:00+00)
 (2001-06-28 04:21:00+00, 2001-06-28 04:22:00+00)
 [2001-12-08 16:42:00+00, 2001-12-08 16:47:00+00)
 (2001-10-17 01:29:00+00, 2001-10-17 01:31:00+00]
 [2001-09-04 04:28:00+00, 2001-09-04 04:32:00+00]
 [2001-05-16 18:01:00+00, 2001-05-16 18:06:00+00)
 
 [2001-05-26 04:22:00+00, 2001-05-26 04:29:00+00)
 (2001-08-16 16:24:00+00, 2001-08-16 16:32:00+00)
 (2001-01-15 03:40:00+00, 2001-01-15 03:49:00+00]
 (2001-04-13 06:30:00+00, 2001-04-13 06:32:00+00]
 [2001-07-15 07:09:00+00, 2001-07-15 07:13:00+00)
 [2001-08-13 12:55:00+00, 2001-08-13 12:55:00+00]
 (2001-03-18 21:00:00+00, 2001-03-18 21:08:00+00]
 [2001-06-29 19:13:00+00, 2001-06-29 19:20:00+00)
 (2001-08-30 05:26:00+00, 2001-08-30 05:28:00+00)
 (2001-09-17 09:00:00+00, 2001-09-17 09:05:00+00)
 (2001-08-08 07:56:00+00, 2001-08-08 08:02:00+00)
 (2001-05-02 16:59:00+00, 2001-05-02 17:06:00+00]
 [2001-10-05 13:42:00+00, 2001-10-05 13:46:00+00)
 (2001-03-30 22:15:00+00, 2001-03-30 22:18:00+00]
 (2001-12-07 04:47:00+00, 2001-12-07 04:55:00+00]
 [2001-07-25 15:07:00+00, 2001-07-25 15:10:00+00)
 [2001-05-27 09:39:00+00, 2001-05-27 09:39:00+00]
 [2001-03-06 19:15:00+00, 2001-03-06 19:22:00+00]
 (2001-07-15 21:57:00+00, 2001-07-15 21:59:00+00)
 [2001-03-19 09:59:00+00, 2001-03-19 09:59:00+00]
 [2001-04-26 13:51:00+00, 2001-04-26 13:58:00+00)
 (2001-01-23 09:28:00+00, 2001-01-23 09:36:00+00)
 (2001-05-17 09:32:00+00, 2001-05-17 09:40:00+00]
 [2001-08-25 15:03:00+00, 2001-08-25 15:05:00+00]
 (2001-04-03 03:55:00+00, 2001-04-03 03:58:00+00)
 (2001-04-04 03:43:00+00, 2001-04-04 03:52:00+00)
 (2001-03-11 15:53:00+00, 2001-03-11 16:02:00+00)
 [2001-04-26 01:57:00+00, 2001-04-26 02:01:00+00]
 [2001-01-22 18:35:00+00, 2001-01-22 18:36:00+00]
 [2001-01-20 02:45:00+00, 2001-01-20 02:54:00+00)
 (2001-11-13 18:10:00+00, 2001-11-13 18:11:00+00]
 [2001-05-02 19:45:00+00, 2001-05-02 19:52:00+00]
 [2001-01-30 19:15:00+00, 2001-01-30 19:22:00+00]
 (2001-01-18 19:18:00+00, 2001-01-18 19:25:00+00)
 [2001-05-31 02:39:00+00, 2001-05-31 02:46:00+00)
 [2001-07-19 07:47:00+00, 2001-07-19 07:50:00+00]
 (2001-11-10 12:13:00+00, 2001-11-10 12:19:00+00)
 [2001-07-13 01:20:00+00, 2001-07-13 01:21:00+00]
 [2001-05-15 16:01:00+00, 2001-05-15 16:01:00+00]
 [2001-08-16 15:49:00+00, 2001-08-16 15:49:00+00]
 [2001-03-29 15:40:00+00, 2001-03-29 15:46:00+00)
 [2001-02-17 23:03:00+00, 2001-02-17 23:11:00+00]
 [2001-03-08 15:49:00+00, 2001-03-08 15:51:00+00]
 [2001-04-09 21:26:00+00, 2001-04-09 21:35:00+00]
 [2001-09-07 12:46:00+00, 2001-09-07 12:53:00+00)
 (2001-06-21 13:59:00+00, 2001-06-21 14:04:00+00)
 (2001-12-07 19:34:00+00, 2001-12-07 19:39:00+00]
 [2001-02-25 19:33:00+00, 2001-02-25 19:40:00+00]
 [2001-01-21 13:57:00+00, 2001-01-21 14:06:00+00]
 [2001-06-03 05:47:00+00, 2001-06-03 05:52:00+00]
 [2001-11-19 14:51:00+00, 2001-11-19 14:55:00+00)
 [2001-09-17 22:18:00+00, 2001-09-17 22:18:00+00]
 [2001-10-21 10:18:00+00, 2001-10-21 10:18:00+00]
 [2001-12-26 11:39:00+00, 2001-12-26 11:46:00+00]
 (2001-05-17 09:53:00+00, 2001-05-17 10:00:00+00)
 [2001-12-10 22:02:00+00, 2001-12-10 22:10:00+00)
 (2001-06-21 11:15:00+00, 2001-06-21 11:17:00+00]
 (2001-04-23 22:01:00+00, 2001-04-23 22:06:00+00]
 [2001-05-01 15:00:00+00, 2001-05-01 15:08:00+00]
 (2001-06-12 04:47:00+00, 2001-06-12 04:49:00+00)
 (2001-11-02 14:18:00+00, 2001-11-02 14:27:00+00)
 [2001-12-29 20:58:00+00, 2001-12-29 21:05:00+00]
 (2001-11-13 19:22:00+00, 2001-11-13 19:31:00+00)
 [2001-08-15 22:59:00+00, 2001-08-15 23:07:00+00)
 [2001-07-26 17:05:00+00, 2001-07-26 17:13:00+00)
 (2001-01-20 18:45:00+00, 2001-01-20 18:53:00+00]
 [2001-04-30 10:09:00+00, 2001-04-30 10:09:00+00]
 [2001-03-02 09:44:00+00, 2001-03-02 09:44:00+00]
 (2001-08-31 21:57:00+00, 2001-08-31 22:03:00+00]
 [2001-07-26 17:37:00+00, 2001-07-26 17:39:00+00]
 [2001-11-20 23:19:00+00, 2001-11-20 23:20:00+00]
 (2001-11-19 06:11:00+00, 2001-11-19 06:16:00+00)
 (2001-08-29 07:21:00+00, 2001-08-29 07:23:00+00)
 [2001-08-07 12:29:00+00, 2001-08-07 12:38:00+00)
 [2001-08-29 02:58:00+00, 2001-08-29 02:59:00+00]
 (2001-07-02 23:19:00+00, 2001-07-02 23:25:00+00]
 (2001-11-24 03:12:00+00, 2001-11-24 03:19:00+00]
 (2001-06-17 08:14:00+00, 2001-06-17 08:16:00+00]
 [2001-11-01 15:18:00+00, 2001-11-01 15:26:00+00)
(100 rows)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE period_cmp(t1.p, t2.p) = -1;
 count 
-------
  4851
(1 row)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE t1.p < t2.p;
 count 
-------
  4851
(1 row)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE t1.p <= t2.p;
 count 
-------
  4950
(1 row)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE t1.p > t2.p;
 count 
-------
  4851
(1 row)

SELECT COUNT(*) FROM tbl_period t1, tbl_period t2 WHERE t1.p >= t2.p;
 count 
-------
  4950
(1 row)

SELECT MAX(period_hash(p)) FROM tbl_period;
    max     
------------
 2034063717
(1 row)

SELECT MAX(period_hash_extended(p, 1)) FROM tbl_period;
         max         
---------------------
 9176714045555019126
(1 row)

SELECT COUNT(*) FROM tbl_intspan t1, tbl_int t2 WHERE t1.i << t2.i;
 count 
-------
  4366
(1 row)

SELECT COUNT(*) FROM tbl_int t1, tbl_intspan t2 WHERE t1.i << t2.i;
 count 
-------
  4928
(1 row)

SELECT COUNT(*) FROM tbl_intspan t1, tbl_int t2 WHERE t1.i >> t2.i;
 count 
-------
  4928
(1 row)

SELECT COUNT(*) FROM tbl_int t1, tbl_intspan t2 WHERE t1.i >> t2.i;
 count 
-------
  4366
(1 row)

SELECT COUNT(*) FROM tbl_intspan t1, tbl_int t2 WHERE t1.i &< t2.i;
 count 
-------
  4459
(1 row)

SELECT COUNT(*) FROM tbl_int t1, tbl_intspan t2 WHERE t1.i &< t2.i;
 count 
-------
  5435
(1 row)

SELECT COUNT(*) FROM tbl_intspan t1, tbl_int t2 WHERE t1.i &> t2.i;
 count 
-------
  5048
(1 row)

SELECT COUNT(*) FROM tbl_int t1, tbl_intspan t2 WHERE t1.i &> t2.i;
 count 
-------
  4873
(1 row)

SELECT COUNT(*) FROM tbl_intspan t1, tbl_int t2 WHERE t1.i -|- t2.i;
 count 
-------
    91
(1 row)

SELECT COUNT(*) FROM tbl_int t1, tbl_intspan t2 WHERE t1.i -|- t2.i;
 count 
-------
    91
(1 row)

SELECT COUNT(*) FROM tbl_floatspan t1, tbl_float t2 WHERE t1.f << t2.f;
 count 
-------
  4089
(1 row)

SELECT COUNT(*) FROM tbl_float t1, tbl_floatspan t2 WHERE t1.f << t2.f;
 count 
-------
  5205
(1 row)

SELECT COUNT(*) FROM tbl_floatspan t1, tbl_float t2 WHERE t1.f >> t2.f;
 count 
-------
  5205
(1 row)

SELECT COUNT(*) FROM tbl_float t1, tbl_floatspan t2 WHERE t1.f >> t2.f;
 count 
-------
  4089
(1 row)

SELECT COUNT(*) FROM tbl_floatspan t1, tbl_float t2 WHERE t1.f &< t2.f;
 count 
-------
  4089
(1 row)

SELECT COUNT(*) FROM tbl_float t1, tbl_floatspan t2 WHERE t1.f &< t2.f;
 count 
-------
  5712
(1 row)

SELECT COUNT(*) FROM tbl_floatspan t1, tbl_float t2 WHERE t1.f &> t2.f;
 count 
-------
  5205
(1 row)

SELECT COUNT(*) FROM tbl_float t1, tbl_floatspan t2 WHERE t1.f &> t2.f;
 count 
-------
  4596
(1 row)

SELECT COUNT(*) FROM tbl_floatspan t1, tbl_float t2 WHERE t1.f -|- t2.f;
 count 
-------
     0
(1 row)

SELECT COUNT(*) FROM tbl_float t1, tbl_floatspan t2 WHERE t1.f -|- t2.f;
 count 
-------
     0
(1 row)

set parallel_setup_cost=0;
SET
set parallel_tuple_cost=0;
SET
set min_parallel_table_scan_size=0;
SET
set max_parallel_workers_per_gather=2;
SET
SELECT round(extent(temp::floatspan),6) FROM tbl_tfloat_big;
         round          
------------------------
 [1.004155, 100.999349]
(1 row)

reset parallel_setup_cost;
RESET
reset parallel_tuple_cost;
RESET
reset min_parallel_table_scan_size;
RESET
reset max_parallel_workers_per_gather;
RESET
