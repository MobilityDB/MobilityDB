SELECT bucketList(intspan '[1, 10]', 2) LIMIT 3;
  bucketlist  
--------------
 (1,"[0, 2)")
 (2,"[2, 4)")
 (3,"[4, 6)")
(3 rows)

SELECT bucketList(intspan '[1, 10]', 2, 1) LIMIT 3;
  bucketlist  
--------------
 (1,"[1, 3)")
 (2,"[3, 5)")
 (3,"[5, 7)")
(3 rows)

SELECT bucketList(floatspan '(1, 10)', 2.5) LIMIT 3;
   bucketlist   
----------------
 (1,"[0, 2.5)")
 (2,"[2.5, 5)")
 (3,"[5, 7.5)")
(3 rows)

SELECT bucketList(floatspan '(1, 10)', 2.5, 1.5) LIMIT 3;
   bucketlist    
-----------------
 (1,"[-1, 1.5)")
 (2,"[1.5, 4)")
 (3,"[4, 6.5)")
(3 rows)

SELECT valueBucket(3, 2);
 valuebucket 
-------------
           2
(1 row)

SELECT valueBucket(3, 2, 1);
 valuebucket 
-------------
           3
(1 row)

SELECT valueBucket(3.5, 2.5);
 valuebucket 
-------------
         2.5
(1 row)

SELECT valueBucket(3.5, 2.5, 1.5);
 valuebucket 
-------------
         1.5
(1 row)

SELECT valueBucket(-3, 2, -2);
 valuebucket 
-------------
          -4
(1 row)

SELECT valueBucket(-3.5, 2, -2);
 valuebucket 
-------------
          -4
(1 row)

/* Errors */
SELECT valueBucket(3, -2);
ERROR:  The value must be positive: -2
SELECT valueBucket(3.5, -2.5);
ERROR:  The value must be positive: -2.500000
SELECT valueBucket(-2147483647, 3, 2);
ERROR:  number out of span
SELECT valueBucket(2147483646, 3, -2);
ERROR:  number out of span
SELECT spanBucket(3, 2);
 spanbucket 
------------
 [2, 4)
(1 row)

SELECT spanBucket(3, 2, 1);
 spanbucket 
------------
 [3, 5)
(1 row)

SELECT spanBucket(3.5, 2.5);
 spanbucket 
------------
 [2.5, 5)
(1 row)

SELECT spanBucket(3.5, 2.5, 1.5);
 spanbucket 
------------
 [1.5, 4)
(1 row)

SELECT bucketList(tstzspan '[2000-01-01, 2000-01-10]', '1 week') LIMIT 3;
                       bucketlist                       
--------------------------------------------------------
 (1,"[1999-12-27 00:00:00+00, 2000-01-03 00:00:00+00)")
 (2,"[2000-01-03 00:00:00+00, 2000-01-10 00:00:00+00)")
 (3,"[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00)")
(3 rows)

SELECT bucketList(tstzspan '[2000-01-01, 2000-01-10]', '1 week', '2020-06-15') LIMIT 3;
                       bucketlist                       
--------------------------------------------------------
 (1,"[1999-12-27 00:00:00+00, 2000-01-03 00:00:00+00)")
 (2,"[2000-01-03 00:00:00+00, 2000-01-10 00:00:00+00)")
 (3,"[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00)")
(3 rows)

SELECT timeBucket('2020-01-01', '1 week');
       timebucket       
------------------------
 2019-12-30 00:00:00+00
(1 row)

SELECT timeBucket('2020-01-01', '1 week', timestamptz '2001-06-01');
       timebucket       
------------------------
 2019-12-27 00:00:00+00
(1 row)

SELECT timeBucket('infinity'::timestamptz, '1 day');
ERROR:  timestamp out of span
SELECT timeBucket('-infinity'::timestamptz, '1 day');
ERROR:  timestamp out of span
/* Errors */
SELECT timeBucket('2020-01-01', '1 month', timestamptz '2001-06-01');
ERROR:  Interval defined in terms of month, year, century etc. not supported
SELECT periodBucket('2020-01-01', '1 week');
                   periodbucket                   
--------------------------------------------------
 [2019-12-30 00:00:00+00, 2020-01-06 00:00:00+00)
(1 row)

SELECT periodBucket('2020-01-01', '1 week', timestamptz '2001-06-01');
                   periodbucket                   
--------------------------------------------------
 [2019-12-27 00:00:00+00, 2020-01-03 00:00:00+00)
(1 row)

SELECT tileList(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, 2.5, '1 week') LIMIT 3;
                                  tilelist                                  
----------------------------------------------------------------------------
 (1,"TBOX XT([15, 17.5),[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00))")
 (2,"TBOX XT([17.5, 20),[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00))")
 (3,"TBOX XT([20, 22.5),[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00))")
(3 rows)

SELECT tileList(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, 2.5, '1 week', 15.5) LIMIT 3;
                                  tilelist                                  
----------------------------------------------------------------------------
 (1,"TBOX XT([13, 15.5),[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00))")
 (2,"TBOX XT([15.5, 18),[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00))")
 (3,"TBOX XT([18, 20.5),[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00))")
(3 rows)

SELECT tileList(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, 2.5, '1 week', 15.5, '2000-01-15') LIMIT 3;
                                  tilelist                                  
----------------------------------------------------------------------------
 (1,"TBOX XT([13, 15.5),[2000-01-15 00:00:00+00, 2000-01-22 00:00:00+00))")
 (2,"TBOX XT([15.5, 18),[2000-01-15 00:00:00+00, 2000-01-22 00:00:00+00))")
 (3,"TBOX XT([18, 20.5),[2000-01-15 00:00:00+00, 2000-01-22 00:00:00+00))")
(3 rows)

SELECT tile(15.5, timestamptz '2000-01-15', 2.5, interval '1 week');
                                 tile                                 
----------------------------------------------------------------------
 TBOX XT([15, 17.5),[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00))
(1 row)

SELECT tile(15.5, timestamptz '2000-01-15', 2.5, interval '1 week', 1.5, '2020-06-15');
                                 tile                                 
----------------------------------------------------------------------
 TBOX XT([14, 16.5),[2000-01-10 00:00:00+00, 2000-01-17 00:00:00+00))
(1 row)

SELECT valueSplit(tint '1@2000-01-01', 2);
           valuesplit           
--------------------------------
 (0,"1@2000-01-01 00:00:00+00")
(1 row)

SELECT valueSplit(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', 2);
                         valuesplit                         
------------------------------------------------------------
 (0,"{1@2000-01-01 00:00:00+00, 1@2000-01-03 00:00:00+00}")
 (2,"{2@2000-01-02 00:00:00+00}")
(2 rows)

SELECT valueSplit(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', 2);
                                        valuesplit                                        
------------------------------------------------------------------------------------------
 (0,"{[1@2000-01-01 00:00:00+00, 1@2000-01-02 00:00:00+00), [1@2000-01-03 00:00:00+00]}")
 (2,"{[2@2000-01-02 00:00:00+00, 2@2000-01-03 00:00:00+00)}")
(2 rows)

SELECT valueSplit(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', 2);
                                                     valuesplit                                                     
--------------------------------------------------------------------------------------------------------------------
 (0,"{[1@2000-01-01 00:00:00+00, 1@2000-01-02 00:00:00+00), [1@2000-01-03 00:00:00+00]}")
 (2,"{[2@2000-01-02 00:00:00+00, 2@2000-01-03 00:00:00+00), [3@2000-01-04 00:00:00+00, 3@2000-01-05 00:00:00+00]}")
(2 rows)

SELECT valueSplit(tfloat '1.5@2000-01-01', 0.5);
             valuesplit             
------------------------------------
 (1.5,"1.5@2000-01-01 00:00:00+00")
(1 row)

SELECT valueSplit(tfloat '{1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03}', 0.5);
                            valuesplit                            
------------------------------------------------------------------
 (1.5,"{1.5@2000-01-01 00:00:00+00, 1.5@2000-01-03 00:00:00+00}")
 (2.5,"{2.5@2000-01-02 00:00:00+00}")
(2 rows)

SELECT valueSplit(tfloat '[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5);
                                                        valuesplit                                                        
--------------------------------------------------------------------------------------------------------------------------
 (1.5,"{[1.5@2000-01-01 00:00:00+00, 2@2000-01-01 12:00:00+00), (2@2000-01-02 12:00:00+00, 1.5@2000-01-03 00:00:00+00]}")
 (2,"{[2@2000-01-01 12:00:00+00, 2.5@2000-01-02 00:00:00+00), (2.5@2000-01-02 00:00:00+00, 2@2000-01-02 12:00:00+00]}")
 (2.5,"{[2.5@2000-01-02 00:00:00+00]}")
(3 rows)

SELECT valueSplit(tfloat 'Interp=Step;[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5);
                                                  valuesplit                                                  
--------------------------------------------------------------------------------------------------------------
 (1.5,"Interp=Step;{[1.5@2000-01-01 00:00:00+00, 1.5@2000-01-02 00:00:00+00), [1.5@2000-01-03 00:00:00+00]}")
 (2.5,"Interp=Step;{[2.5@2000-01-02 00:00:00+00, 2.5@2000-01-03 00:00:00+00)}")
(2 rows)

SELECT valueSplit(tfloat '{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5);
                                                        valuesplit                                                        
--------------------------------------------------------------------------------------------------------------------------
 (1.5,"{[1.5@2000-01-01 00:00:00+00, 2@2000-01-01 12:00:00+00), (2@2000-01-02 12:00:00+00, 1.5@2000-01-03 00:00:00+00]}")
 (2,"{[2@2000-01-01 12:00:00+00, 2.5@2000-01-02 00:00:00+00), (2.5@2000-01-02 00:00:00+00, 2@2000-01-02 12:00:00+00]}")
 (2.5,"{[2.5@2000-01-02 00:00:00+00]}")
 (3.5,"{[3.5@2000-01-04 00:00:00+00, 3.5@2000-01-05 00:00:00+00]}")
(4 rows)

SELECT valueSplit(tfloat 'Interp=Step;{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5);
                                                  valuesplit                                                  
--------------------------------------------------------------------------------------------------------------
 (1.5,"Interp=Step;{[1.5@2000-01-01 00:00:00+00, 1.5@2000-01-02 00:00:00+00), [1.5@2000-01-03 00:00:00+00]}")
 (2.5,"Interp=Step;{[2.5@2000-01-02 00:00:00+00, 2.5@2000-01-03 00:00:00+00)}")
 (3.5,"Interp=Step;{[3.5@2000-01-04 00:00:00+00, 3.5@2000-01-05 00:00:00+00]}")
(3 rows)

SELECT timeSplit(tbool 't@2000-01-01', '1 week');
                       timesplit                       
-------------------------------------------------------
 ("1999-12-27 00:00:00+00","t@2000-01-01 00:00:00+00")
(1 row)

SELECT timeSplit(tbool '{t@2000-01-01, f@2000-01-02, t@2000-01-03}', '1 week');
                                     timesplit                                     
-----------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","{t@2000-01-01 00:00:00+00, f@2000-01-02 00:00:00+00}")
 ("2000-01-03 00:00:00+00","{t@2000-01-03 00:00:00+00}")
(2 rows)

SELECT timeSplit(tbool '[t@2000-01-01, f@2000-01-02, t@2000-01-03]', '1 week');
                                                  timesplit                                                  
-------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","[t@2000-01-01 00:00:00+00, f@2000-01-02 00:00:00+00, t@2000-01-03 00:00:00+00]")
(1 row)

SELECT timeSplit(tbool '{[t@2000-01-01, f@2000-01-02, t@2000-01-03],[t@2000-01-04, t@2000-01-05]}', '1 week');
                                                   timesplit                                                   
---------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","{[t@2000-01-01 00:00:00+00, f@2000-01-02 00:00:00+00, t@2000-01-03 00:00:00+00]}")
 ("2000-01-03 00:00:00+00","{[t@2000-01-04 00:00:00+00, t@2000-01-05 00:00:00+00]}")
(2 rows)

SELECT timeSplit(tint '1@2000-01-01', '1 week');
                       timesplit                       
-------------------------------------------------------
 ("1999-12-27 00:00:00+00","1@2000-01-01 00:00:00+00")
(1 row)

SELECT timeSplit(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', '1 week');
                                     timesplit                                     
-----------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","{1@2000-01-01 00:00:00+00, 2@2000-01-02 00:00:00+00}")
 ("2000-01-03 00:00:00+00","{1@2000-01-03 00:00:00+00}")
(2 rows)

SELECT timeSplit(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', '1 week');
                                                  timesplit                                                  
-------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","[1@2000-01-01 00:00:00+00, 2@2000-01-02 00:00:00+00, 1@2000-01-03 00:00:00+00]")
(1 row)

SELECT timeSplit(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', '1 week');
                                                   timesplit                                                   
---------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","{[1@2000-01-01 00:00:00+00, 2@2000-01-02 00:00:00+00, 1@2000-01-03 00:00:00+00]}")
 ("2000-01-03 00:00:00+00","{[3@2000-01-04 00:00:00+00, 3@2000-01-05 00:00:00+00]}")
(2 rows)

SELECT timeSplit(tfloat '1.5@2000-01-01', '1 week');
                        timesplit                        
---------------------------------------------------------
 ("1999-12-27 00:00:00+00","1.5@2000-01-01 00:00:00+00")
(1 row)

SELECT timeSplit(tfloat '{1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03}', '1 week');
                                       timesplit                                       
---------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","{1.5@2000-01-01 00:00:00+00, 2.5@2000-01-02 00:00:00+00}")
 ("2000-01-03 00:00:00+00","{1.5@2000-01-03 00:00:00+00}")
(2 rows)

SELECT timeSplit(tfloat '[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', '1 week');
                                                     timesplit                                                     
-------------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","[1.5@2000-01-01 00:00:00+00, 2.5@2000-01-02 00:00:00+00, 1.5@2000-01-03 00:00:00+00]")
(1 row)

SELECT timeSplit(tfloat 'Interp=Step;[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', '1 week');
                                                           timesplit                                                           
-------------------------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","Interp=Step;[1.5@2000-01-01 00:00:00+00, 2.5@2000-01-02 00:00:00+00, 1.5@2000-01-03 00:00:00+00]")
(1 row)

SELECT timeSplit(tfloat '{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', '1 week');
                                                      timesplit                                                      
---------------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","{[1.5@2000-01-01 00:00:00+00, 2.5@2000-01-02 00:00:00+00, 1.5@2000-01-03 00:00:00+00]}")
 ("2000-01-03 00:00:00+00","{[3.5@2000-01-04 00:00:00+00, 3.5@2000-01-05 00:00:00+00]}")
(2 rows)

SELECT timeSplit(tfloat 'Interp=Step;{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', '1 week');
                                                            timesplit                                                            
---------------------------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","Interp=Step;{[1.5@2000-01-01 00:00:00+00, 2.5@2000-01-02 00:00:00+00, 1.5@2000-01-03 00:00:00+00]}")
 ("2000-01-03 00:00:00+00","Interp=Step;{[3.5@2000-01-04 00:00:00+00, 3.5@2000-01-05 00:00:00+00]}")
(2 rows)

SELECT timeSplit(ttext 'AAA@2000-01-01', '1 week');
                          timesplit                          
-------------------------------------------------------------
 ("1999-12-27 00:00:00+00","""AAA""@2000-01-01 00:00:00+00")
(1 row)

SELECT timeSplit(ttext '{AAA@2000-01-01, BBB@2000-01-02, AAA@2000-01-03}', '1 week');
                                           timesplit                                           
-----------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","{""AAA""@2000-01-01 00:00:00+00, ""BBB""@2000-01-02 00:00:00+00}")
 ("2000-01-03 00:00:00+00","{""AAA""@2000-01-03 00:00:00+00}")
(2 rows)

SELECT timeSplit(ttext '[AAA@2000-01-01, BBB@2000-01-02, AAA@2000-01-03]', '1 week');
                                                           timesplit                                                           
-------------------------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","[""AAA""@2000-01-01 00:00:00+00, ""BBB""@2000-01-02 00:00:00+00, ""AAA""@2000-01-03 00:00:00+00]")
(1 row)

SELECT timeSplit(ttext '{[AAA@2000-01-01, BBB@2000-01-02, AAA@2000-01-03],[CCC@2000-01-04, CCC@2000-01-05]}', '1 week');
                                                            timesplit                                                            
---------------------------------------------------------------------------------------------------------------------------------
 ("1999-12-27 00:00:00+00","{[""AAA""@2000-01-01 00:00:00+00, ""BBB""@2000-01-02 00:00:00+00, ""AAA""@2000-01-03 00:00:00+00]}")
 ("2000-01-03 00:00:00+00","{[""CCC""@2000-01-04 00:00:00+00, ""CCC""@2000-01-05 00:00:00+00]}")
(2 rows)

SELECT valueTimeSplit(tint '1@2000-01-01', 2, '1 week');
                     valuetimesplit                      
---------------------------------------------------------
 (0,"1999-12-27 00:00:00+00","1@2000-01-01 00:00:00+00")
(1 row)

SELECT valueTimeSplit(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', 2, '1 week');
                      valuetimesplit                       
-----------------------------------------------------------
 (0,"1999-12-27 00:00:00+00","{1@2000-01-01 00:00:00+00}")
 (0,"2000-01-03 00:00:00+00","{1@2000-01-03 00:00:00+00}")
 (2,"1999-12-27 00:00:00+00","{2@2000-01-02 00:00:00+00}")
(3 rows)

SELECT valueTimeSplit(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', 2, '1 week');
                                    valuetimesplit                                     
---------------------------------------------------------------------------------------
 (0,"1999-12-27 00:00:00+00","{[1@2000-01-01 00:00:00+00, 1@2000-01-02 00:00:00+00)}")
 (0,"2000-01-03 00:00:00+00","{[1@2000-01-03 00:00:00+00]}")
 (2,"1999-12-27 00:00:00+00","{[2@2000-01-02 00:00:00+00, 2@2000-01-03 00:00:00+00)}")
(3 rows)

SELECT valueTimeSplit(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', 2, '1 week');
                                    valuetimesplit                                     
---------------------------------------------------------------------------------------
 (0,"1999-12-27 00:00:00+00","{[1@2000-01-01 00:00:00+00, 1@2000-01-02 00:00:00+00)}")
 (0,"2000-01-03 00:00:00+00","{[1@2000-01-03 00:00:00+00]}")
 (2,"1999-12-27 00:00:00+00","{[2@2000-01-02 00:00:00+00, 2@2000-01-03 00:00:00+00)}")
 (2,"2000-01-03 00:00:00+00","{[3@2000-01-04 00:00:00+00, 3@2000-01-05 00:00:00+00]}")
(4 rows)

SELECT valueTimeSplit(tfloat '1.5@2000-01-01', 0.5, '1 week');
                       valuetimesplit                        
-------------------------------------------------------------
 (1.5,"1999-12-27 00:00:00+00","1.5@2000-01-01 00:00:00+00")
(1 row)

SELECT valueTimeSplit(tfloat '{1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03}', 0.5, '1 week');
                        valuetimesplit                         
---------------------------------------------------------------
 (1.5,"1999-12-27 00:00:00+00","{1.5@2000-01-01 00:00:00+00}")
 (1.5,"2000-01-03 00:00:00+00","{1.5@2000-01-03 00:00:00+00}")
 (2.5,"1999-12-27 00:00:00+00","{2.5@2000-01-02 00:00:00+00}")
(3 rows)

SELECT valueTimeSplit(tfloat '[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5, '1 week');
                                                                  valuetimesplit                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------
 (1.5,"1999-12-27 00:00:00+00","{[1.5@2000-01-01 00:00:00+00, 2@2000-01-01 12:00:00+00), (2@2000-01-02 12:00:00+00, 1.5@2000-01-03 00:00:00+00]}")
 (2,"1999-12-27 00:00:00+00","{[2@2000-01-01 12:00:00+00, 2.5@2000-01-02 00:00:00+00), (2.5@2000-01-02 00:00:00+00, 2@2000-01-02 12:00:00+00]}")
 (2.5,"1999-12-27 00:00:00+00","{[2.5@2000-01-02 00:00:00+00]}")
(3 rows)

SELECT valueTimeSplit(tfloat 'Interp=Step;[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5, '1 week');
                                             valuetimesplit                                              
---------------------------------------------------------------------------------------------------------
 (1.5,"1999-12-27 00:00:00+00","Interp=Step;{[1.5@2000-01-01 00:00:00+00, 1.5@2000-01-02 00:00:00+00)}")
 (1.5,"2000-01-03 00:00:00+00","Interp=Step;{[1.5@2000-01-03 00:00:00+00]}")
 (2.5,"1999-12-27 00:00:00+00","Interp=Step;{[2.5@2000-01-02 00:00:00+00, 2.5@2000-01-03 00:00:00+00)}")
(3 rows)

SELECT valueTimeSplit(tfloat '{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5, '1 week');
                                                                  valuetimesplit                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------
 (1.5,"1999-12-27 00:00:00+00","{[1.5@2000-01-01 00:00:00+00, 2@2000-01-01 12:00:00+00), (2@2000-01-02 12:00:00+00, 1.5@2000-01-03 00:00:00+00]}")
 (2,"1999-12-27 00:00:00+00","{[2@2000-01-01 12:00:00+00, 2.5@2000-01-02 00:00:00+00), (2.5@2000-01-02 00:00:00+00, 2@2000-01-02 12:00:00+00]}")
 (2.5,"1999-12-27 00:00:00+00","{[2.5@2000-01-02 00:00:00+00]}")
 (3.5,"2000-01-03 00:00:00+00","{[3.5@2000-01-04 00:00:00+00, 3.5@2000-01-05 00:00:00+00]}")
(4 rows)

SELECT valueTimeSplit(tfloat 'Interp=Step;{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5, '1 week');
                                             valuetimesplit                                              
---------------------------------------------------------------------------------------------------------
 (1.5,"1999-12-27 00:00:00+00","Interp=Step;{[1.5@2000-01-01 00:00:00+00, 1.5@2000-01-02 00:00:00+00)}")
 (1.5,"2000-01-03 00:00:00+00","Interp=Step;{[1.5@2000-01-03 00:00:00+00]}")
 (2.5,"1999-12-27 00:00:00+00","Interp=Step;{[2.5@2000-01-02 00:00:00+00, 2.5@2000-01-03 00:00:00+00)}")
 (3.5,"2000-01-03 00:00:00+00","Interp=Step;{[3.5@2000-01-04 00:00:00+00, 3.5@2000-01-05 00:00:00+00]}")
(4 rows)

