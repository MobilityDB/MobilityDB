SELECT bins(intspan '[1, 10]', 2) LIMIT 3;
     bins     
--------------
 (1,"[0, 2)")
 (2,"[2, 4)")
 (3,"[4, 6)")
(3 rows)

SELECT bins(intspan '[1, 10]', 2, 1) LIMIT 3;
     bins     
--------------
 (1,"[1, 3)")
 (2,"[3, 5)")
 (3,"[5, 7)")
(3 rows)

SELECT bins(bigintspan '[1, 10]', 2) LIMIT 3;
     bins     
--------------
 (1,"[0, 2)")
 (2,"[2, 4)")
 (3,"[4, 6)")
(3 rows)

SELECT bins(bigintspan '[1, 10]', 2, 1) LIMIT 3;
     bins     
--------------
 (1,"[1, 3)")
 (2,"[3, 5)")
 (3,"[5, 7)")
(3 rows)

SELECT bins(floatspan '(1, 10)', 2.5) LIMIT 3;
      bins      
----------------
 (1,"[0, 2.5)")
 (2,"[2.5, 5)")
 (3,"[5, 7.5)")
(3 rows)

SELECT bins(floatspan '(1, 10)', 2.5, 1.5) LIMIT 3;
      bins       
-----------------
 (1,"[-1, 1.5)")
 (2,"[1.5, 4)")
 (3,"[4, 6.5)")
(3 rows)

SELECT bins(datespan '[2000-01-01, 2000-01-10]', '1 week') LIMIT 3;
              bins              
--------------------------------
 (1,"[12-27-1999, 01-03-2000)")
 (2,"[01-03-2000, 01-10-2000)")
 (3,"[01-10-2000, 01-17-2000)")
(3 rows)

SELECT bins(datespan '[2000-01-01, 2000-01-10]', '1 week', '2000-01-01') LIMIT 3;
              bins              
--------------------------------
 (1,"[01-01-2000, 01-08-2000)")
 (2,"[01-08-2000, 01-15-2000)")
(2 rows)

SELECT bins(tstzspan '[2000-01-01, 2000-01-10]', '1 week') LIMIT 3;
                                bins                                
--------------------------------------------------------------------
 (1,"[Mon Dec 27 00:00:00 1999 PST, Mon Jan 03 00:00:00 2000 PST)")
 (2,"[Mon Jan 03 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST)")
 (3,"[Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST)")
(3 rows)

SELECT bins(tstzspan '[2000-01-01, 2000-01-10]', '1 week', '2000-01-01') LIMIT 3;
                                bins                                
--------------------------------------------------------------------
 (1,"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST)")
 (2,"[Sat Jan 08 00:00:00 2000 PST, Sat Jan 15 00:00:00 2000 PST)")
(2 rows)

/* Errors */
SELECT bins(datespan '[2000-01-01, 2000-01-10]', '1 hour') LIMIT 3;
ERROR:  The interval must not have sub-day precision: 01:00:00
SELECT getBin(3, 2);
 getbin 
--------
 [2, 4)
(1 row)

SELECT getBin(3, 2, 1);
 getbin 
--------
 [3, 5)
(1 row)

SELECT getBin(3::bigint, 2::bigint);
 getbin 
--------
 [2, 4)
(1 row)

SELECT getBin(3::bigint, 2::bigint, 1::bigint);
 getbin 
--------
 [3, 5)
(1 row)

SELECT getBin(3.5, 2.5);
  getbin  
----------
 [2.5, 5)
(1 row)

SELECT getBin(3.5, 2.5, 1.5);
  getbin  
----------
 [1.5, 4)
(1 row)

SELECT getBin(-3, 2, -2);
  getbin  
----------
 [-4, -2)
(1 row)

SELECT getBin(-3.5, 2, -2);
  getbin  
----------
 [-4, -2)
(1 row)

SELECT getBin(date '2000-01-01', '1 week');
          getbin          
--------------------------
 [12-27-1999, 01-03-2000)
(1 row)

SELECT getBin(date '2000-01-01', '1 week', '2000-01-01');
          getbin          
--------------------------
 [01-01-2000, 01-08-2000)
(1 row)

SELECT getBin(timestamptz '2000-01-01', '1 week');
                            getbin                            
--------------------------------------------------------------
 [Mon Dec 27 00:00:00 1999 PST, Mon Jan 03 00:00:00 2000 PST)
(1 row)

SELECT getBin(timestamptz '2000-01-01', '1 week', '2000-01-01');
                            getbin                            
--------------------------------------------------------------
 [Sat Jan 01 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST)
(1 row)

SELECT getBin('infinity'::timestamptz, '1 day');
ERROR:  timestamp out of span
SELECT getBin('-infinity'::timestamptz, '1 day');
ERROR:  timestamp out of span
/* Errors */
SELECT getBin(3, -2);
ERROR:  The value must be strictly positive: -2
SELECT getBin(3.5, -2.5);
ERROR:  The value must be strictly positive: -2.500000
SELECT getBin(-2147483647, 3, 2);
ERROR:  number out of span
SELECT getBin(2147483646, 3, -2);
ERROR:  number out of span
SELECT getBin('2020-01-01', '1 month', timestamptz '2001-06-01');
ERROR:  Cannot have month intervals: 1 mon
SELECT valueSpans(intspanset '{[1, 10]}', 2) LIMIT 3;
                         valuespans                         
------------------------------------------------------------
 {"[1, 2)","[2, 4)","[4, 6)","[6, 8)","[8, 10)","[10, 11)"}
(1 row)

SELECT valueSpans(intspanset '{[1, 10]}', 2, 1) LIMIT 3;
                   valuespans                    
-------------------------------------------------
 {"[1, 3)","[3, 5)","[5, 7)","[7, 9)","[9, 11)"}
(1 row)

SELECT valueSpans(floatspanset '{(1, 10)}', 2.5) LIMIT 3;
                   valuespans                   
------------------------------------------------
 {"(1, 2.5)","[2.5, 5)","[5, 7.5)","[7.5, 10)"}
(1 row)

SELECT valueSpans(floatspanset '{(1, 10)}', 2.5, 1.5) LIMIT 3;
                       valuespans                        
---------------------------------------------------------
 {"(1, 1.5)","[1.5, 4)","[4, 6.5)","[6.5, 9)","[9, 10)"}
(1 row)

SELECT timeSpans(datespanset '{[2000-01-01, 2000-01-10]}', '1 week') LIMIT 3;
                        timespans                        
---------------------------------------------------------
 {"[01-01-2000, 01-08-2000)","[01-08-2000, 01-11-2000)"}
(1 row)

SELECT timeSpans(datespanset '{[2000-01-01, 2000-01-10]}', '1 week', '2020-06-15') LIMIT 3;
                                     timespans                                      
------------------------------------------------------------------------------------
 {"[01-01-2000, 01-03-2000)","[01-03-2000, 01-10-2000)","[01-10-2000, 01-11-2000)"}
(1 row)

SELECT timeSpans(tstzspanset '{[2000-01-01, 2000-01-10]}', '1 week') LIMIT 3;
                                                                                           timespans                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST)","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST)","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT timeSpans(tstzspanset '{[2000-01-01, 2000-01-10]}', '1 week', '2020-06-15') LIMIT 3;
                                                                                           timespans                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 23:00:00 2000 PST)","[Sun Jan 02 23:00:00 2000 PST, Sun Jan 09 23:00:00 2000 PST)","[Sun Jan 09 23:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT valueSpans(tint '[15@2000-01-15, 25@2000-01-25]', 2);
       valuespans        
-------------------------
 {"[15, 16)","[25, 26)"}
(1 row)

SELECT valueSpans(tint '[15@2000-01-15, 25@2000-01-25]', 2, 15);
       valuespans        
-------------------------
 {"[15, 16)","[25, 26)"}
(1 row)

SELECT valueSpans(tfloat '[15@2000-01-15, 25@2000-01-25]', 2.5);
                            valuespans                            
------------------------------------------------------------------
 {"[15, 17.5)","[17.5, 20)","[20, 22.5)","[22.5, 25)","[25, 25]"}
(1 row)

SELECT valueSpans(tfloat '[15@2000-01-15, 25@2000-01-25]', 2.5, 15.5);
                            valuespans                            
------------------------------------------------------------------
 {"[15, 15.5)","[15.5, 18)","[18, 20.5)","[20.5, 23)","[23, 25]"}
(1 row)

SELECT timeSpans(tint '[15@2000-01-15, 25@2000-01-25]', '2 days');
                                                                                                                                                                                          timespans                                                                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 15 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST)","[Mon Jan 17 00:00:00 2000 PST, Wed Jan 19 00:00:00 2000 PST)","[Wed Jan 19 00:00:00 2000 PST, Fri Jan 21 00:00:00 2000 PST)","[Fri Jan 21 00:00:00 2000 PST, Sun Jan 23 00:00:00 2000 PST)","[Sun Jan 23 00:00:00 2000 PST, Tue Jan 25 00:00:00 2000 PST)","[Tue Jan 25 00:00:00 2000 PST, Tue Jan 25 00:00:00 2000 PST]"}
(1 row)

SELECT timeSpans(tint '[15@2000-01-15, 25@2000-01-25]', '2 days', '2000-01-01');
                                                                                                                                                                                          timespans                                                                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 15 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST)","[Mon Jan 17 00:00:00 2000 PST, Wed Jan 19 00:00:00 2000 PST)","[Wed Jan 19 00:00:00 2000 PST, Fri Jan 21 00:00:00 2000 PST)","[Fri Jan 21 00:00:00 2000 PST, Sun Jan 23 00:00:00 2000 PST)","[Sun Jan 23 00:00:00 2000 PST, Tue Jan 25 00:00:00 2000 PST)","[Tue Jan 25 00:00:00 2000 PST, Tue Jan 25 00:00:00 2000 PST]"}
(1 row)

SELECT timeSpans(tfloat '[15@2000-01-15, 25@2000-01-25]', '2 days');
                                                                                                                                                                                          timespans                                                                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 15 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST)","[Mon Jan 17 00:00:00 2000 PST, Wed Jan 19 00:00:00 2000 PST)","[Wed Jan 19 00:00:00 2000 PST, Fri Jan 21 00:00:00 2000 PST)","[Fri Jan 21 00:00:00 2000 PST, Sun Jan 23 00:00:00 2000 PST)","[Sun Jan 23 00:00:00 2000 PST, Tue Jan 25 00:00:00 2000 PST)","[Tue Jan 25 00:00:00 2000 PST, Tue Jan 25 00:00:00 2000 PST]"}
(1 row)

SELECT timeSpans(tfloat '[15@2000-01-15, 25@2000-01-25]', '2 days', '2000-01-01');
                                                                                                                                                                                          timespans                                                                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 15 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST)","[Mon Jan 17 00:00:00 2000 PST, Wed Jan 19 00:00:00 2000 PST)","[Wed Jan 19 00:00:00 2000 PST, Fri Jan 21 00:00:00 2000 PST)","[Fri Jan 21 00:00:00 2000 PST, Sun Jan 23 00:00:00 2000 PST)","[Sun Jan 23 00:00:00 2000 PST, Tue Jan 25 00:00:00 2000 PST)","[Tue Jan 25 00:00:00 2000 PST, Tue Jan 25 00:00:00 2000 PST]"}
(1 row)

SELECT valueTiles(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, 2.5) LIMIT 3;
          valuetiles           
-------------------------------
 (1,"TBOXFLOAT X([15, 17.5))")
 (2,"TBOXFLOAT X([17.5, 20))")
 (3,"TBOXFLOAT X([20, 22.5))")
(3 rows)

SELECT valueTiles(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, 2.5, 15.5) LIMIT 3;
          valuetiles           
-------------------------------
 (1,"TBOXFLOAT X([13, 15.5))")
 (2,"TBOXFLOAT X([15.5, 18))")
 (3,"TBOXFLOAT X([18, 20.5))")
(3 rows)

SELECT getValueTile(15.5, 2.5);
      getvaluetile       
-------------------------
 TBOXFLOAT X([15, 17.5))
(1 row)

SELECT getValueTile(15.5, 2.5, 1.5);
      getvaluetile       
-------------------------
 TBOXFLOAT X([14, 16.5))
(1 row)

SELECT timeTiles(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, '1 week') LIMIT 3;
                                 timetiles                                  
----------------------------------------------------------------------------
 (1,"TBOX T([Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST))")
 (2,"TBOX T([Mon Jan 17 00:00:00 2000 PST, Mon Jan 24 00:00:00 2000 PST))")
 (3,"TBOX T([Mon Jan 24 00:00:00 2000 PST, Mon Jan 31 00:00:00 2000 PST))")
(3 rows)

SELECT timeTiles(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, '1 week', '2020-06-15') LIMIT 3;
                                 timetiles                                  
----------------------------------------------------------------------------
 (1,"TBOX T([Sun Jan 09 23:00:00 2000 PST, Sun Jan 16 23:00:00 2000 PST))")
 (2,"TBOX T([Sun Jan 16 23:00:00 2000 PST, Sun Jan 23 23:00:00 2000 PST))")
 (3,"TBOX T([Sun Jan 23 23:00:00 2000 PST, Sun Jan 30 23:00:00 2000 PST))")
(3 rows)

SELECT getTboxTimeTile(timestamptz '2000-01-15', interval '1 week');
                           gettboxtimetile                            
----------------------------------------------------------------------
 TBOX T([Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST))
(1 row)

SELECT getTboxTimeTile(timestamptz '2000-01-15', interval '1 week', '2020-06-15');
                           gettboxtimetile                            
----------------------------------------------------------------------
 TBOX T([Sun Jan 09 23:00:00 2000 PST, Sun Jan 16 23:00:00 2000 PST))
(1 row)

SELECT valueTimeTiles(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, 2.5, '1 week') LIMIT 3;
                                       valuetimetiles                                        
---------------------------------------------------------------------------------------------
 (1,"TBOXFLOAT XT([15, 17.5),[Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST))")
 (2,"TBOXFLOAT XT([17.5, 20),[Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST))")
 (3,"TBOXFLOAT XT([20, 22.5),[Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST))")
(3 rows)

SELECT valueTimeTiles(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, 2.5, '1 week', 15.5) LIMIT 3;
                                       valuetimetiles                                        
---------------------------------------------------------------------------------------------
 (1,"TBOXFLOAT XT([13, 15.5),[Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST))")
 (2,"TBOXFLOAT XT([15.5, 18),[Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST))")
 (3,"TBOXFLOAT XT([18, 20.5),[Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST))")
(3 rows)

SELECT valueTimeTiles(tfloat '[15@2000-01-15, 25@2000-01-25]'::tbox, 2.5, '1 week', 15.5, '2000-01-15') LIMIT 3;
                                       valuetimetiles                                        
---------------------------------------------------------------------------------------------
 (1,"TBOXFLOAT XT([13, 15.5),[Sat Jan 15 00:00:00 2000 PST, Sat Jan 22 00:00:00 2000 PST))")
 (2,"TBOXFLOAT XT([15.5, 18),[Sat Jan 15 00:00:00 2000 PST, Sat Jan 22 00:00:00 2000 PST))")
 (3,"TBOXFLOAT XT([18, 20.5),[Sat Jan 15 00:00:00 2000 PST, Sat Jan 22 00:00:00 2000 PST))")
(3 rows)

SELECT getValueTimeTile(15.5, timestamptz '2000-01-15', 2.5, interval '1 week');
                                   getvaluetimetile                                    
---------------------------------------------------------------------------------------
 TBOXFLOAT XT([15, 17.5),[Mon Jan 10 00:00:00 2000 PST, Mon Jan 17 00:00:00 2000 PST))
(1 row)

SELECT getValueTimeTile(15.5, timestamptz '2000-01-15', 2.5, interval '1 week', 1.5, '2020-06-15');
                                   getvaluetimetile                                    
---------------------------------------------------------------------------------------
 TBOXFLOAT XT([14, 16.5),[Sun Jan 09 23:00:00 2000 PST, Sun Jan 16 23:00:00 2000 PST))
(1 row)

SELECT valueBoxes(tint '1@2000-01-01', 2);
                                     valueboxes                                      
-------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 2),[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', 2);
                                                                              valueboxes                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 2),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXINT XT([2, 3),[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', 2);
                                                                              valueboxes                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 2),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXINT XT([2, 3),[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST))"}
(1 row)

SELECT valueBoxes(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', 2);
                                                                              valueboxes                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 2),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXINT XT([2, 4),[Sun Jan 02 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tint '1@2000-01-01', 2, 1);
                                     valueboxes                                      
-------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 2),[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', 2, 1);
                                     valueboxes                                      
-------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 3),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', 2, 1);
                                     valueboxes                                      
-------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 3),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', 2, 1);
                                                                              valueboxes                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 3),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXINT XT([3, 4),[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tfloat '1.5@2000-01-01', 0.5);
                                        valueboxes                                         
-------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 1.5],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tfloat '{1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03}', 0.5);
                                                                                    valueboxes                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 1.5],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tfloat '[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5);
                                                                                                                              valueboxes                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 2),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2.5),[Sat Jan 01 12:00:00 2000 PST, Sun Jan 02 12:00:00 2000 PST])","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tfloat 'Interp=Step;[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5);
                                                                                    valueboxes                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 1.5],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST))"}
(1 row)

SELECT valueBoxes(tfloat '{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5);
                                                                                                                                                                          valueboxes                                                                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 2),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2.5),[Sat Jan 01 12:00:00 2000 PST, Sun Jan 02 12:00:00 2000 PST])","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3.5, 3.5],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT valueBoxes(tfloat 'Interp=Step;{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5);
                                                                                                                                valueboxes                                                                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 1.5],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST))","TBOXFLOAT XT([3.5, 3.5],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT timeBoxes(tint '1@2000-01-01', '1 week');
ERROR:  The value must be strictly positive: 0
SELECT timeBoxes(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', '1 week');
ERROR:  The value must be strictly positive: 0
SELECT timeBoxes(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', '1 week');
ERROR:  The value must be strictly positive: 0
SELECT timeBoxes(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', '1 week');
ERROR:  The value must be strictly positive: 0
SELECT timeBoxes(tfloat '1.5@2000-01-01', '1 week');
ERROR:  The value must be strictly positive: 0.000000
SELECT timeBoxes(tfloat '{1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03}', '1 week');
ERROR:  The value must be strictly positive: 0.000000
SELECT timeBoxes(tfloat '[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', '1 week');
ERROR:  The value must be strictly positive: 0.000000
SELECT timeBoxes(tfloat 'Interp=Step;[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', '1 week');
ERROR:  The value must be strictly positive: 0.000000
SELECT timeBoxes(tfloat '{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', '1 week');
ERROR:  The value must be strictly positive: 0.000000
SELECT timeBoxes(tfloat 'Interp=Step;{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', '1 week');
ERROR:  The value must be strictly positive: 0.000000
SELECT valueTimeBoxes(tint '1@2000-01-01', 2, '1 week');
                                   valuetimeboxes                                    
-------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 2),[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT valueTimeBoxes(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', 2, '1 week');
                                                                                                                     valuetimeboxes                                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 2),[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXINT XT([2, 3),[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXINT XT([1, 2),[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])"}
(1 row)

SELECT valueTimeBoxes(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', 2, '1 week');
                                                                                                                     valuetimeboxes                                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 2),[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST))","TBOXINT XT([2, 3),[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST))","TBOXINT XT([1, 2),[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])"}
(1 row)

SELECT valueTimeBoxes(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', 2, '1 week');
                                                                                                                                                              valuetimeboxes                                                                                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXINT XT([1, 2),[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST))","TBOXINT XT([2, 3),[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST))","TBOXINT XT([1, 2),[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXINT XT([3, 4),[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT valueTimeBoxes(tfloat '1.5@2000-01-01', 0.5, '1 week');
                                      valuetimeboxes                                       
-------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 1.5],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT valueTimeBoxes(tfloat '{1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03}', 0.5, '1 week');
                                                                                                                              valuetimeboxes                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 1.5],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([1.5, 1.5],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])"}
(1 row)

SELECT valueTimeBoxes(tfloat '[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5, '1 week');
                                                                                                                                                                        valuetimeboxes                                                                                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 2),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST))","TBOXFLOAT XT([2, 2.5),[Sat Jan 01 12:00:00 2000 PST, Sun Jan 02 12:00:00 2000 PST])","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([1.5, 1.5],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])"}
(1 row)

SELECT valueTimeBoxes(tfloat 'Interp=Step;[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5, '1 week');
                                                                                                                              valuetimeboxes                                                                                                                               
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 1.5],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST))","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST))","TBOXFLOAT XT([1.5, 1.5],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])"}
(1 row)

SELECT valueTimeBoxes(tfloat '{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5, '1 week');
                                                                                                                                                                                                                    valuetimeboxes                                                                                                                                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 2),[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST))","TBOXFLOAT XT([2, 2.5),[Sat Jan 01 12:00:00 2000 PST, Sun Jan 02 12:00:00 2000 PST])","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([1.5, 1.5],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([3.5, 3.5],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT valueTimeBoxes(tfloat 'Interp=Step;{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5, '1 week');
                                                                                                                                                                          valuetimeboxes                                                                                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1.5, 1.5],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST))","TBOXFLOAT XT([2.5, 2.5],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST))","TBOXFLOAT XT([1.5, 1.5],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([3.5, 3.5],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT valueSplit(tint '1@2000-01-01', 2);
              valuesplit              
--------------------------------------
 (0,"1@Sat Jan 01 00:00:00 2000 PST")
(1 row)

SELECT valueSplit(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', 2);
                               valuesplit                               
------------------------------------------------------------------------
 (0,"{1@Sat Jan 01 00:00:00 2000 PST, 1@Mon Jan 03 00:00:00 2000 PST}")
 (2,"{2@Sun Jan 02 00:00:00 2000 PST}")
(2 rows)

SELECT valueSplit(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', 2);
                                                 valuesplit                                                 
------------------------------------------------------------------------------------------------------------
 (0,"{[1@Sat Jan 01 00:00:00 2000 PST, 1@Sun Jan 02 00:00:00 2000 PST), [1@Mon Jan 03 00:00:00 2000 PST]}")
 (2,"{[2@Sun Jan 02 00:00:00 2000 PST, 2@Mon Jan 03 00:00:00 2000 PST)}")
(2 rows)

SELECT valueSplit(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', 2);
                                                                 valuesplit                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------
 (0,"{[1@Sat Jan 01 00:00:00 2000 PST, 1@Sun Jan 02 00:00:00 2000 PST), [1@Mon Jan 03 00:00:00 2000 PST]}")
 (2,"{[2@Sun Jan 02 00:00:00 2000 PST, 2@Mon Jan 03 00:00:00 2000 PST), [3@Tue Jan 04 00:00:00 2000 PST, 3@Wed Jan 05 00:00:00 2000 PST]}")
(2 rows)

SELECT valueSplit(tfloat '1.5@2000-01-01', 0.5);
                valuesplit                
------------------------------------------
 (1.5,"1.5@Sat Jan 01 00:00:00 2000 PST")
(1 row)

SELECT valueSplit(tfloat '{1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03}', 0.5);
                                  valuesplit                                  
------------------------------------------------------------------------------
 (1.5,"{1.5@Sat Jan 01 00:00:00 2000 PST, 1.5@Mon Jan 03 00:00:00 2000 PST}")
 (2.5,"{2.5@Sun Jan 02 00:00:00 2000 PST}")
(2 rows)

SELECT valueSplit(tfloat '[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5);
                                                                    valuesplit                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 (1.5,"{[1.5@Sat Jan 01 00:00:00 2000 PST, 2@Sat Jan 01 12:00:00 2000 PST), (2@Sun Jan 02 12:00:00 2000 PST, 1.5@Mon Jan 03 00:00:00 2000 PST]}")
 (2,"{[2@Sat Jan 01 12:00:00 2000 PST, 2.5@Sun Jan 02 00:00:00 2000 PST), (2.5@Sun Jan 02 00:00:00 2000 PST, 2@Sun Jan 02 12:00:00 2000 PST]}")
 (2.5,"{[2.5@Sun Jan 02 00:00:00 2000 PST]}")
(3 rows)

SELECT valueSplit(tfloat 'Interp=Step;[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5);
                                                           valuesplit                                                           
--------------------------------------------------------------------------------------------------------------------------------
 (1.5,"Interp=Step;{[1.5@Sat Jan 01 00:00:00 2000 PST, 1.5@Sun Jan 02 00:00:00 2000 PST), [1.5@Mon Jan 03 00:00:00 2000 PST]}")
 (2.5,"Interp=Step;{[2.5@Sun Jan 02 00:00:00 2000 PST, 2.5@Mon Jan 03 00:00:00 2000 PST)}")
(2 rows)

SELECT valueSplit(tfloat '{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5);
                                                                    valuesplit                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 (1.5,"{[1.5@Sat Jan 01 00:00:00 2000 PST, 2@Sat Jan 01 12:00:00 2000 PST), (2@Sun Jan 02 12:00:00 2000 PST, 1.5@Mon Jan 03 00:00:00 2000 PST]}")
 (2,"{[2@Sat Jan 01 12:00:00 2000 PST, 2.5@Sun Jan 02 00:00:00 2000 PST), (2.5@Sun Jan 02 00:00:00 2000 PST, 2@Sun Jan 02 12:00:00 2000 PST]}")
 (2.5,"{[2.5@Sun Jan 02 00:00:00 2000 PST]}")
 (3.5,"{[3.5@Tue Jan 04 00:00:00 2000 PST, 3.5@Wed Jan 05 00:00:00 2000 PST]}")
(4 rows)

SELECT valueSplit(tfloat 'Interp=Step;{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5);
                                                           valuesplit                                                           
--------------------------------------------------------------------------------------------------------------------------------
 (1.5,"Interp=Step;{[1.5@Sat Jan 01 00:00:00 2000 PST, 1.5@Sun Jan 02 00:00:00 2000 PST), [1.5@Mon Jan 03 00:00:00 2000 PST]}")
 (2.5,"Interp=Step;{[2.5@Sun Jan 02 00:00:00 2000 PST, 2.5@Mon Jan 03 00:00:00 2000 PST)}")
 (3.5,"Interp=Step;{[3.5@Tue Jan 04 00:00:00 2000 PST, 3.5@Wed Jan 05 00:00:00 2000 PST]}")
(3 rows)

SELECT timeSplit(tbool 't@2000-01-01', '1 week');
                             timesplit                             
-------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","t@Sat Jan 01 00:00:00 2000 PST")
(1 row)

SELECT timeSplit(tbool '{t@2000-01-01, f@2000-01-02, t@2000-01-03}', '1 week');
                                              timesplit                                              
-----------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","{t@Sat Jan 01 00:00:00 2000 PST, f@Sun Jan 02 00:00:00 2000 PST}")
 ("Mon Jan 03 00:00:00 2000 PST","{t@Mon Jan 03 00:00:00 2000 PST}")
(2 rows)

SELECT timeSplit(tbool '[t@2000-01-01, f@2000-01-02, t@2000-01-03]', '1 week');
                                                              timesplit                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","[t@Sat Jan 01 00:00:00 2000 PST, f@Sun Jan 02 00:00:00 2000 PST, f@Mon Jan 03 00:00:00 2000 PST)")
 ("Mon Jan 03 00:00:00 2000 PST","[t@Mon Jan 03 00:00:00 2000 PST]")
(2 rows)

SELECT timeSplit(tbool '{[t@2000-01-01, f@2000-01-02, t@2000-01-03],[t@2000-01-04, t@2000-01-05]}', '1 week');
                                                                timesplit                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","{[t@Sat Jan 01 00:00:00 2000 PST, f@Sun Jan 02 00:00:00 2000 PST, f@Mon Jan 03 00:00:00 2000 PST)}")
 ("Mon Jan 03 00:00:00 2000 PST","{[t@Mon Jan 03 00:00:00 2000 PST], [t@Tue Jan 04 00:00:00 2000 PST, t@Wed Jan 05 00:00:00 2000 PST]}")
(2 rows)

SELECT timeSplit(tint '1@2000-01-01', '1 week');
                             timesplit                             
-------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","1@Sat Jan 01 00:00:00 2000 PST")
(1 row)

SELECT timeSplit(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', '1 week');
                                              timesplit                                              
-----------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","{1@Sat Jan 01 00:00:00 2000 PST, 2@Sun Jan 02 00:00:00 2000 PST}")
 ("Mon Jan 03 00:00:00 2000 PST","{1@Mon Jan 03 00:00:00 2000 PST}")
(2 rows)

SELECT timeSplit(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', '1 week');
                                                              timesplit                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","[1@Sat Jan 01 00:00:00 2000 PST, 2@Sun Jan 02 00:00:00 2000 PST, 2@Mon Jan 03 00:00:00 2000 PST)")
 ("Mon Jan 03 00:00:00 2000 PST","[1@Mon Jan 03 00:00:00 2000 PST]")
(2 rows)

SELECT timeSplit(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', '1 week');
                                                                timesplit                                                                
-----------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","{[1@Sat Jan 01 00:00:00 2000 PST, 2@Sun Jan 02 00:00:00 2000 PST, 2@Mon Jan 03 00:00:00 2000 PST)}")
 ("Mon Jan 03 00:00:00 2000 PST","{[1@Mon Jan 03 00:00:00 2000 PST], [3@Tue Jan 04 00:00:00 2000 PST, 3@Wed Jan 05 00:00:00 2000 PST]}")
(2 rows)

SELECT timeSplit(tfloat '1.5@2000-01-01', '1 week');
                              timesplit                              
---------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","1.5@Sat Jan 01 00:00:00 2000 PST")
(1 row)

SELECT timeSplit(tfloat '{1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03}', '1 week');
                                                timesplit                                                
---------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","{1.5@Sat Jan 01 00:00:00 2000 PST, 2.5@Sun Jan 02 00:00:00 2000 PST}")
 ("Mon Jan 03 00:00:00 2000 PST","{1.5@Mon Jan 03 00:00:00 2000 PST}")
(2 rows)

SELECT timeSplit(tfloat '[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', '1 week');
                                                                 timesplit                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","[1.5@Sat Jan 01 00:00:00 2000 PST, 2.5@Sun Jan 02 00:00:00 2000 PST, 1.5@Mon Jan 03 00:00:00 2000 PST)")
 ("Mon Jan 03 00:00:00 2000 PST","[1.5@Mon Jan 03 00:00:00 2000 PST]")
(2 rows)

SELECT timeSplit(tfloat 'Interp=Step;[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', '1 week');
                                                                       timesplit                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","Interp=Step;[1.5@Sat Jan 01 00:00:00 2000 PST, 2.5@Sun Jan 02 00:00:00 2000 PST, 2.5@Mon Jan 03 00:00:00 2000 PST)")
 ("Mon Jan 03 00:00:00 2000 PST","Interp=Step;[1.5@Mon Jan 03 00:00:00 2000 PST]")
(2 rows)

SELECT timeSplit(tfloat '{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', '1 week');
                                                                   timesplit                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","{[1.5@Sat Jan 01 00:00:00 2000 PST, 2.5@Sun Jan 02 00:00:00 2000 PST, 1.5@Mon Jan 03 00:00:00 2000 PST)}")
 ("Mon Jan 03 00:00:00 2000 PST","{[1.5@Mon Jan 03 00:00:00 2000 PST], [3.5@Tue Jan 04 00:00:00 2000 PST, 3.5@Wed Jan 05 00:00:00 2000 PST]}")
(2 rows)

SELECT timeSplit(tfloat 'Interp=Step;{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', '1 week');
                                                                         timesplit                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","Interp=Step;{[1.5@Sat Jan 01 00:00:00 2000 PST, 2.5@Sun Jan 02 00:00:00 2000 PST, 2.5@Mon Jan 03 00:00:00 2000 PST)}")
 ("Mon Jan 03 00:00:00 2000 PST","Interp=Step;{[1.5@Mon Jan 03 00:00:00 2000 PST], [3.5@Tue Jan 04 00:00:00 2000 PST, 3.5@Wed Jan 05 00:00:00 2000 PST]}")
(2 rows)

SELECT timeSplit(ttext 'AAA@2000-01-01', '1 week');
                                timesplit                                
-------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","""AAA""@Sat Jan 01 00:00:00 2000 PST")
(1 row)

SELECT timeSplit(ttext '{AAA@2000-01-01, BBB@2000-01-02, AAA@2000-01-03}', '1 week');
                                                    timesplit                                                    
-----------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","{""AAA""@Sat Jan 01 00:00:00 2000 PST, ""BBB""@Sun Jan 02 00:00:00 2000 PST}")
 ("Mon Jan 03 00:00:00 2000 PST","{""AAA""@Mon Jan 03 00:00:00 2000 PST}")
(2 rows)

SELECT timeSplit(ttext '[AAA@2000-01-01, BBB@2000-01-02, AAA@2000-01-03]', '1 week');
                                                                       timesplit                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","[""AAA""@Sat Jan 01 00:00:00 2000 PST, ""BBB""@Sun Jan 02 00:00:00 2000 PST, ""BBB""@Mon Jan 03 00:00:00 2000 PST)")
 ("Mon Jan 03 00:00:00 2000 PST","[""AAA""@Mon Jan 03 00:00:00 2000 PST]")
(2 rows)

SELECT timeSplit(ttext '{[AAA@2000-01-01, BBB@2000-01-02, AAA@2000-01-03],[CCC@2000-01-04, CCC@2000-01-05]}', '1 week');
                                                                         timesplit                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 ("Mon Dec 27 00:00:00 1999 PST","{[""AAA""@Sat Jan 01 00:00:00 2000 PST, ""BBB""@Sun Jan 02 00:00:00 2000 PST, ""BBB""@Mon Jan 03 00:00:00 2000 PST)}")
 ("Mon Jan 03 00:00:00 2000 PST","{[""AAA""@Mon Jan 03 00:00:00 2000 PST], [""CCC""@Tue Jan 04 00:00:00 2000 PST, ""CCC""@Wed Jan 05 00:00:00 2000 PST]}")
(2 rows)

/* Errors */
SELECT timeSplit(tbool 't@2000-01-01', '-1 week');
ERROR:  The interval must be positive: -7 days
SELECT valueTimeSplit(tint '1@2000-01-01', 2, '1 week');
                           valuetimesplit                            
---------------------------------------------------------------------
 (0,"Mon Dec 27 00:00:00 1999 PST","1@Sat Jan 01 00:00:00 2000 PST")
(1 row)

SELECT valueTimeSplit(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}', 2, '1 week');
                            valuetimesplit                             
-----------------------------------------------------------------------
 (0,"Mon Dec 27 00:00:00 1999 PST","{1@Sat Jan 01 00:00:00 2000 PST}")
 (2,"Mon Dec 27 00:00:00 1999 PST","{2@Sun Jan 02 00:00:00 2000 PST}")
 (0,"Mon Jan 03 00:00:00 2000 PST","{1@Mon Jan 03 00:00:00 2000 PST}")
(3 rows)

SELECT valueTimeSplit(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]', 2, '1 week');
                                             valuetimesplit                                              
---------------------------------------------------------------------------------------------------------
 (0,"Mon Dec 27 00:00:00 1999 PST","{[1@Sat Jan 01 00:00:00 2000 PST, 1@Sun Jan 02 00:00:00 2000 PST)}")
 (2,"Mon Dec 27 00:00:00 1999 PST","{[2@Sun Jan 02 00:00:00 2000 PST, 2@Mon Jan 03 00:00:00 2000 PST)}")
 (0,"Mon Jan 03 00:00:00 2000 PST","{[1@Mon Jan 03 00:00:00 2000 PST]}")
(3 rows)

SELECT valueTimeSplit(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', 2, '1 week');
                                             valuetimesplit                                              
---------------------------------------------------------------------------------------------------------
 (0,"Mon Dec 27 00:00:00 1999 PST","{[1@Sat Jan 01 00:00:00 2000 PST, 1@Sun Jan 02 00:00:00 2000 PST)}")
 (2,"Mon Dec 27 00:00:00 1999 PST","{[2@Sun Jan 02 00:00:00 2000 PST, 2@Mon Jan 03 00:00:00 2000 PST)}")
 (0,"Mon Jan 03 00:00:00 2000 PST","{[1@Mon Jan 03 00:00:00 2000 PST]}")
 (2,"Mon Jan 03 00:00:00 2000 PST","{[3@Tue Jan 04 00:00:00 2000 PST, 3@Wed Jan 05 00:00:00 2000 PST]}")
(4 rows)

SELECT valueTimeSplit(tfloat '1.5@2000-01-01', 0.5, '1 week');
                             valuetimesplit                              
-------------------------------------------------------------------------
 (1.5,"Mon Dec 27 00:00:00 1999 PST","1.5@Sat Jan 01 00:00:00 2000 PST")
(1 row)

SELECT valueTimeSplit(tfloat '{1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03}', 0.5, '1 week');
                              valuetimesplit                               
---------------------------------------------------------------------------
 (1.5,"Mon Dec 27 00:00:00 1999 PST","{1.5@Sat Jan 01 00:00:00 2000 PST}")
 (2.5,"Mon Dec 27 00:00:00 1999 PST","{2.5@Sun Jan 02 00:00:00 2000 PST}")
 (1.5,"Mon Jan 03 00:00:00 2000 PST","{1.5@Mon Jan 03 00:00:00 2000 PST}")
(3 rows)

SELECT valueTimeSplit(tfloat '[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5, '1 week');
                                                                                 valuetimesplit                                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 (1.5,"Mon Dec 27 00:00:00 1999 PST","{[1.5@Sat Jan 01 00:00:00 2000 PST, 2@Sat Jan 01 12:00:00 2000 PST), (2@Sun Jan 02 12:00:00 2000 PST, 1.5@Mon Jan 03 00:00:00 2000 PST)}")
 (2,"Mon Dec 27 00:00:00 1999 PST","{[2@Sat Jan 01 12:00:00 2000 PST, 2.5@Sun Jan 02 00:00:00 2000 PST), (2.5@Sun Jan 02 00:00:00 2000 PST, 2@Sun Jan 02 12:00:00 2000 PST]}")
 (2.5,"Mon Dec 27 00:00:00 1999 PST","{[2.5@Sun Jan 02 00:00:00 2000 PST]}")
 (1.5,"Mon Jan 03 00:00:00 2000 PST","{[1.5@Mon Jan 03 00:00:00 2000 PST]}")
(4 rows)

SELECT valueTimeSplit(tfloat 'Interp=Step;[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03]', 0.5, '1 week');
                                                      valuetimesplit                                                       
---------------------------------------------------------------------------------------------------------------------------
 (1.5,"Mon Dec 27 00:00:00 1999 PST","Interp=Step;{[1.5@Sat Jan 01 00:00:00 2000 PST, 1.5@Sun Jan 02 00:00:00 2000 PST)}")
 (2.5,"Mon Dec 27 00:00:00 1999 PST","Interp=Step;{[2.5@Sun Jan 02 00:00:00 2000 PST, 2.5@Mon Jan 03 00:00:00 2000 PST)}")
 (1.5,"Mon Jan 03 00:00:00 2000 PST","Interp=Step;{[1.5@Mon Jan 03 00:00:00 2000 PST]}")
(3 rows)

SELECT valueTimeSplit(tfloat '{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5, '1 week');
                                                                                 valuetimesplit                                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 (1.5,"Mon Dec 27 00:00:00 1999 PST","{[1.5@Sat Jan 01 00:00:00 2000 PST, 2@Sat Jan 01 12:00:00 2000 PST), (2@Sun Jan 02 12:00:00 2000 PST, 1.5@Mon Jan 03 00:00:00 2000 PST)}")
 (2,"Mon Dec 27 00:00:00 1999 PST","{[2@Sat Jan 01 12:00:00 2000 PST, 2.5@Sun Jan 02 00:00:00 2000 PST), (2.5@Sun Jan 02 00:00:00 2000 PST, 2@Sun Jan 02 12:00:00 2000 PST]}")
 (2.5,"Mon Dec 27 00:00:00 1999 PST","{[2.5@Sun Jan 02 00:00:00 2000 PST]}")
 (1.5,"Mon Jan 03 00:00:00 2000 PST","{[1.5@Mon Jan 03 00:00:00 2000 PST]}")
 (3.5,"Mon Jan 03 00:00:00 2000 PST","{[3.5@Tue Jan 04 00:00:00 2000 PST, 3.5@Wed Jan 05 00:00:00 2000 PST]}")
(5 rows)

SELECT valueTimeSplit(tfloat 'Interp=Step;{[1.5@2000-01-01, 2.5@2000-01-02, 1.5@2000-01-03],[3.5@2000-01-04, 3.5@2000-01-05]}', 0.5, '1 week');
                                                      valuetimesplit                                                       
---------------------------------------------------------------------------------------------------------------------------
 (1.5,"Mon Dec 27 00:00:00 1999 PST","Interp=Step;{[1.5@Sat Jan 01 00:00:00 2000 PST, 1.5@Sun Jan 02 00:00:00 2000 PST)}")
 (2.5,"Mon Dec 27 00:00:00 1999 PST","Interp=Step;{[2.5@Sun Jan 02 00:00:00 2000 PST, 2.5@Mon Jan 03 00:00:00 2000 PST)}")
 (1.5,"Mon Jan 03 00:00:00 2000 PST","Interp=Step;{[1.5@Mon Jan 03 00:00:00 2000 PST]}")
 (3.5,"Mon Jan 03 00:00:00 2000 PST","Interp=Step;{[3.5@Tue Jan 04 00:00:00 2000 PST, 3.5@Wed Jan 05 00:00:00 2000 PST]}")
(4 rows)

