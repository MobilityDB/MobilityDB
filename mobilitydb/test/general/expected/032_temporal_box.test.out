SELECT COUNT(*) FROM tbl_tbool WHERE temp::tstzspan IS NOT NULL;
 count 
-------
    96
(1 row)

SELECT COUNT(*) FROM tbl_ttext WHERE temp::tstzspan IS NOT NULL;
 count 
-------
    96
(1 row)

SELECT COUNT(*) FROM tbl_int WHERE i::tbox IS NOT NULL;
 count 
-------
    99
(1 row)

SELECT COUNT(*) FROM tbl_float WHERE f::tbox IS NOT NULL;
 count 
-------
    99
(1 row)

SELECT COUNT(*) FROM tbl_intspan WHERE i::tbox IS NOT NULL;
 count 
-------
    99
(1 row)

SELECT COUNT(*) FROM tbl_floatspan WHERE f::tbox IS NOT NULL;
 count 
-------
    99
(1 row)

SELECT COUNT(*) FROM tbl_timestamptz WHERE t::tbox IS NOT NULL;
 count 
-------
    99
(1 row)

SELECT COUNT(*) FROM tbl_tstzspan WHERE t::tbox IS NOT NULL;
 count 
-------
    99
(1 row)

SELECT COUNT(*) FROM tbl_tstzset WHERE t::tbox IS NOT NULL;
 count 
-------
    99
(1 row)

SELECT COUNT(*) FROM tbl_tstzspanset WHERE t::tbox IS NOT NULL;
 count 
-------
    99
(1 row)

SELECT COUNT(*) FROM tbl_tint WHERE temp::tbox IS NOT NULL;
 count 
-------
    96
(1 row)

SELECT COUNT(*) FROM tbl_tfloat WHERE temp::tbox IS NOT NULL;
 count 
-------
    96
(1 row)

SELECT COUNT(*) FROM tbl_int, tbl_timestamptz WHERE tbox(i, t) IS NOT NULL;
 count 
-------
  9801
(1 row)

SELECT COUNT(*) FROM tbl_intspan, tbl_timestamptz WHERE tbox(i, t) IS NOT NULL;
 count 
-------
  9801
(1 row)

SELECT COUNT(*) FROM tbl_float, tbl_timestamptz WHERE tbox(f, t) IS NOT NULL;
 count 
-------
  9801
(1 row)

SELECT COUNT(*) FROM tbl_floatspan, tbl_timestamptz WHERE tbox(f, t) IS NOT NULL;
 count 
-------
  9801
(1 row)

SELECT COUNT(*) FROM tbl_int, tbl_tstzspan WHERE tbox(i, t) IS NOT NULL;
 count 
-------
  9801
(1 row)

SELECT COUNT(*) FROM tbl_intspan, tbl_tstzspan WHERE tbox(i, t) IS NOT NULL;
 count 
-------
  9801
(1 row)

SELECT COUNT(*) FROM tbl_float, tbl_tstzspan WHERE tbox(f, t) IS NOT NULL;
 count 
-------
  9801
(1 row)

SELECT COUNT(*) FROM tbl_floatspan, tbl_tstzspan WHERE tbox(f, t) IS NOT NULL;
 count 
-------
  9801
(1 row)

SELECT spans(ttext '[A@2000-01-01]');
                              spans                               
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]"}
(1 row)

SELECT spans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03]');
                                                              spans                                                              
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]"}
(1 row)

SELECT spans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],[3 3)@2000-01-04, 3 3)@2000-01-05]}');
                                                                                             spans                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT spans(ttext 'A@2000-01-01');
                              spans                               
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]"}
(1 row)

SELECT spans(ttext '{A@2000-01-01}');
                              spans                               
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext 'A@2000-01-01', 1);
                           splitnspans                            
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext 'A@2000-01-01', 5);
                           splitnspans                            
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 1);
                           splitnspans                            
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 2);
                                                           splitnspans                                                           
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 3);
                                                                                          splitnspans                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 4);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 5);
                                                                                                                                                         splitnspans                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 6);
                                                                                                                                                         splitnspans                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 1);
                           splitnspans                            
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 2);
                                                           splitnspans                                                           
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 3);
                                                                                          splitnspans                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 4);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 5);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 6);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 1);
                           splitnspans                            
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 2);
                                                           splitnspans                                                           
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 3);
                                                                                          splitnspans                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 4);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 5);
                                                                                                                                                         splitnspans                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 1);
                           splitnspans                            
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 2);
                                                           splitnspans                                                           
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 3);
                                                                                          splitnspans                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 4);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 5);
                                                                                                                                                         splitnspans                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 6);
                                                                                                                                                                                         splitnspans                                                                                                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 1);
                           splitnspans                            
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 2);
                                                           splitnspans                                                           
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 3);
                                                                                          splitnspans                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 4);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 5);
                                                                                                                                                         splitnspans                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 6);
                                                                                                                                                         splitnspans                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 11);
                                                                                                                                                         splitnspans                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 1);
                           splitnspans                            
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 2);
                                                           splitnspans                                                           
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 3);
                                                                                          splitnspans                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 4);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 5);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 6);
                                                                                                                          splitnspans                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 1);
                           splitnspans                            
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 2);
                                                           splitnspans                                                           
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 3);
                                                           splitnspans                                                           
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 4);
                                                                                          splitnspans                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 5);
                                                                                                                                                         splitnspans                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 6);
                                                                                                                                                         splitnspans                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

/* Errors */
SELECT splitNSpans(ttext 'A@2000-01-01', -1);
ERROR:  The value must be strictly positive: -1
SELECT splitEachNSpans(ttext 'A@2000-01-01', 1);
                         spliteachnspans                          
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext 'A@2000-01-01', 5);
                         spliteachnspans                          
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 1);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 2);
                                                                                        spliteachnspans                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 3);
                                                         spliteachnspans                                                         
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 4);
                                                         spliteachnspans                                                         
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 5);
                         spliteachnspans                          
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05}', 6);
                         spliteachnspans                          
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 1);
                                                                                                                        spliteachnspans                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 2);
                                                         spliteachnspans                                                         
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 3);
                                                         spliteachnspans                                                         
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 4);
                         spliteachnspans                          
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 5);
                         spliteachnspans                          
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '[A@2000-01-01, B@2000-01-02, A@2000-01-03, B@2000-01-04, A@2000-01-05]', 6);
                         spliteachnspans                          
------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 1);
                                                                                                                                                                                                                                                                                     spliteachnspans                                                                                                                                                                                                                                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 2);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 3);
                                                                                        spliteachnspans                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 4);
                                                                                        spliteachnspans                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06, A@2000-01-07,
B@2000-01-08, A@2000-01-09,B@2000-01-10]}', 5);
                                                         spliteachnspans                                                         
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 1);
                                                                                                                                                                                                                                                                                                                     spliteachnspans                                                                                                                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 2);
                                                                                                                                                                                                                                                                                                                     spliteachnspans                                                                                                                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 3);
                                                                                                                                                                                                                                                                                                                     spliteachnspans                                                                                                                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 4);
                                                                                                                                                                                                                                                                                                                     spliteachnspans                                                                                                                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 5);
                                                                                                                                                                                                                                                                                                                     spliteachnspans                                                                                                                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01], [B@2000-01-02], [A@2000-01-03],
[B@2000-01-04], [A@2000-01-05], [B@2000-01-06], [A@2000-01-07],
[B@2000-01-08], [A@2000-01-09], [B@2000-01-10]}', 6);
                                                                                                                                                                                                                                                                                                                     spliteachnspans                                                                                                                                                                                                                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 1);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 2);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 3);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 4);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 5);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 6);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02], [A@2000-01-03,
B@2000-01-04], [A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08], [A@2000-01-09, B@2000-01-10]}', 11);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 1);
                                                                                                                                                                                                                      spliteachnspans                                                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 2);
                                                                                                                        spliteachnspans                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 3);
                                                                                                                        spliteachnspans                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 4);
                                                                                                                        spliteachnspans                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 5);
                                                                                                                        spliteachnspans                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03],
[B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09], [B@2000-01-10]}', 6);
                                                                                                                        spliteachnspans                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 1);
                                                                                                                                                                                                                                                      spliteachnspans                                                                                                                                                                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST]","[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST]","[Sat Jan 08 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 2);
                                                                                                                                                       spliteachnspans                                                                                                                                                        
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST]","[Mon Jan 03 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST]","[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 3);
                                                                                        spliteachnspans                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST]","[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 4);
                                                                                        spliteachnspans                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST]","[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 5);
                                                         spliteachnspans                                                         
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

SELECT splitEachNSpans(ttext '{[A@2000-01-01, B@2000-01-02, A@2000-01-03,
B@2000-01-04, A@2000-01-05, B@2000-01-06], [A@2000-01-07,
B@2000-01-08, A@2000-01-09, B@2000-01-10]}', 6);
                                                         spliteachnspans                                                         
---------------------------------------------------------------------------------------------------------------------------------
 {"[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST]","[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST]"}
(1 row)

/* Errors */
SELECT splitEachNSpans(ttext 'A@2000-01-01', -1);
ERROR:  The value must be strictly positive: -1
SELECT tboxes(tfloat '1@2000-01-01');
                                        tboxes                                         
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT tboxes(tfloat '{1@2000-01-01}');
                                        tboxes                                         
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT tboxes(tfloat '[1@2000-01-01]');
                                        tboxes                                         
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT tboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]');
                                                                                  tboxes                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])"}
(1 row)

SELECT tboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3 3)@2000-01-04, 3 3)@2000-01-05]}');
                                                                                                                            tboxes                                                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '1@2000-01-01', 1);
                                     splitntboxes                                      
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{1@2000-01-01}', 1);
                                     splitntboxes                                      
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '[1@2000-01-01]', 1);
                                     splitntboxes                                      
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01]}', 1);
                                     splitntboxes                                      
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 1);
                                     splitntboxes                                      
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 5],[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 2);
                                                                               splitntboxes                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 5],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 3);
                                                                                                                         splitntboxes                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 4);
                                                                                                                                                                   splitntboxes                                                                                                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 5);
                                                                                                                                                                                                             splitntboxes                                                                                                                                                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 6);
                                                                                                                                                                                                             splitntboxes                                                                                                                                                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 1);
                                     splitntboxes                                      
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 2);
                                                                               splitntboxes                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Mon Jan 03 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 3);
                                                                                                                         splitntboxes                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 4);
                                                                                                                                                                   splitntboxes                                                                                                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 5);
                                                                                                                                                                   splitntboxes                                                                                                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 6);
                                                                                                                                                                   splitntboxes                                                                                                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 1);
                                      splitntboxes                                      
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 2);
                                      splitntboxes                                      
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 3);
                                      splitntboxes                                      
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 4);
                                      splitntboxes                                      
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 5);
                                      splitntboxes                                      
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 1);
                                      splitntboxes                                      
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 2);
                                                                                splitntboxes                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 5],[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])","TBOXFLOAT XT([6, 10],[Thu Jan 06 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 3);
                                                                                                                          splitntboxes                                                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 4],[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 7],[Wed Jan 05 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST])","TBOXFLOAT XT([8, 10],[Sat Jan 08 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 4);
                                                                                                                                                                    splitntboxes                                                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 5);
                                                                                                                                                                                                              splitntboxes                                                                                                                                                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 6);
                                                                                                                                                                                                                                                        splitntboxes                                                                                                                                                                                                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 9],[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 1);
                                      splitntboxes                                      
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 2);
                                                                                splitntboxes                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 3);
                                                                                                                          splitntboxes                                                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 4],[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 8],[Wed Jan 05 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 4);
                                                                                                                                                                    splitntboxes                                                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 4],[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 5);
                                                                                                                                                                                                              splitntboxes                                                                                                                                                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 6);
                                                                                                                                                                                                              splitntboxes                                                                                                                                                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 1);
                                      splitntboxes                                      
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 2);
                                                                                splitntboxes                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 3);
                                                                                                                          splitntboxes                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 4);
                                                                                                                                                                    splitntboxes                                                                                                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 5);
                                                                                                                                                                    splitntboxes                                                                                                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 6);
                                                                                                                                                                    splitntboxes                                                                                                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 1);
                                      splitntboxes                                      
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 2);
                                                                                splitntboxes                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 3);
                                                                                splitntboxes                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 4);
                                                                                splitntboxes                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 5);
                                                                                splitntboxes                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 6);
                                                                                splitntboxes                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

/* Errors */
SELECT splitNTboxes(tfloat '1@2000-01-01', -1);
ERROR:  The value must be strictly positive: -1
SELECT splitEachNTboxes(tfloat '1@2000-01-01', 3);
                                   spliteachntboxes                                    
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{1@2000-01-01}', 3);
                                   spliteachntboxes                                    
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '[1@2000-01-01]', 3);
                                   spliteachntboxes                                    
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01]}', 3);
                                   spliteachntboxes                                    
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 1);
                                                                                                                                                                                                           spliteachntboxes                                                                                                                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 2);
                                                                                                                       spliteachntboxes                                                                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 3);
                                                                             spliteachntboxes                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 5],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 4);
                                                                             spliteachntboxes                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 4],[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 5);
                                   spliteachntboxes                                    
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 5],[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{1@2000-01-01, 2@2000-01-02, 3@2000-01-03, 4@2000-01-04, 5@2000-01-05}', 6);
                                   spliteachntboxes                                    
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 5],[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 1);
                                                                                                                                                                 spliteachntboxes                                                                                                                                                                  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Sun Jan 02 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 2);
                                                                             spliteachntboxes                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Mon Jan 03 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 3);
                                                                             spliteachntboxes                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([1, 2],[Tue Jan 04 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 4);
                                   spliteachntboxes                                    
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 5);
                                   spliteachntboxes                                    
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03, 2@2000-01-04, 1@2000-01-05]', 6);
                                   spliteachntboxes                                    
---------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 1);
                                    spliteachntboxes                                    
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 2);
                                    spliteachntboxes                                    
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 3);
                                    spliteachntboxes                                    
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 4);
                                    spliteachntboxes                                    
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06, 7@2000-01-07,
8@2000-01-08, 9@2000-01-09,10@2000-01-10]}', 5);
                                    spliteachntboxes                                    
----------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 10],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 1);
                                                                                                                                                                                                                                                                                                                                                                                                                              spliteachntboxes                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])","TBOXFLOAT XT([6, 6],[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 7],[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST])","TBOXFLOAT XT([8, 8],[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 9],[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 2);
                                                                                                                                                                                                                                                                                                                                                                                                                              spliteachntboxes                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])","TBOXFLOAT XT([6, 6],[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 7],[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST])","TBOXFLOAT XT([8, 8],[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 9],[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 3);
                                                                                                                                                                                                                                                                                                                                                                                                                              spliteachntboxes                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])","TBOXFLOAT XT([6, 6],[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 7],[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST])","TBOXFLOAT XT([8, 8],[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 9],[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 4);
                                                                                                                                                                                                                                                                                                                                                                                                                              spliteachntboxes                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])","TBOXFLOAT XT([6, 6],[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 7],[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST])","TBOXFLOAT XT([8, 8],[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 9],[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 5);
                                                                                                                                                                                                                                                                                                                                                                                                                              spliteachntboxes                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])","TBOXFLOAT XT([6, 6],[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 7],[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST])","TBOXFLOAT XT([8, 8],[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 9],[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01], [2@2000-01-02], [3@2000-01-03],
[4@2000-01-04], [5@2000-01-05], [6@2000-01-06], [7@2000-01-07],
[8@2000-01-08], [9@2000-01-09], [10@2000-01-10]}', 6);
                                                                                                                                                                                                                                                                                                                                                                                                                              spliteachntboxes                                                                                                                                                                                                                                                                                                                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 1],[Sat Jan 01 00:00:00 2000 PST, Sat Jan 01 00:00:00 2000 PST])","TBOXFLOAT XT([2, 2],[Sun Jan 02 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 3],[Mon Jan 03 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 4],[Tue Jan 04 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 5],[Wed Jan 05 00:00:00 2000 PST, Wed Jan 05 00:00:00 2000 PST])","TBOXFLOAT XT([6, 6],[Thu Jan 06 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 7],[Fri Jan 07 00:00:00 2000 PST, Fri Jan 07 00:00:00 2000 PST])","TBOXFLOAT XT([8, 8],[Sat Jan 08 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 9],[Sun Jan 09 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 1);
                                                                                                                                                                                                            spliteachntboxes                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 2);
                                                                                                                                                                                                            spliteachntboxes                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 3);
                                                                                                                                                                                                            spliteachntboxes                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 4);
                                                                                                                                                                                                            spliteachntboxes                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 5);
                                                                                                                                                                                                            spliteachntboxes                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02], [3@2000-01-03,
4@2000-01-04], [5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08], [9@2000-01-09, 10@2000-01-10]}', 6);
                                                                                                                                                                                                            spliteachntboxes                                                                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 2],[Sat Jan 01 00:00:00 2000 PST, Sun Jan 02 00:00:00 2000 PST])","TBOXFLOAT XT([3, 4],[Mon Jan 03 00:00:00 2000 PST, Tue Jan 04 00:00:00 2000 PST])","TBOXFLOAT XT([5, 6],[Wed Jan 05 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 8],[Fri Jan 07 00:00:00 2000 PST, Sat Jan 08 00:00:00 2000 PST])","TBOXFLOAT XT([9, 10],[Sun Jan 09 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 1);
                                                                                                                                                                  spliteachntboxes                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 2);
                                                                                                                                                                  spliteachntboxes                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 3);
                                                                                                                                                                  spliteachntboxes                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 4);
                                                                                                                                                                  spliteachntboxes                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 5);
                                                                                                                                                                  spliteachntboxes                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03],
[4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09], [10@2000-01-10]}', 6);
                                                                                                                                                                  spliteachntboxes                                                                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 3],[Sat Jan 01 00:00:00 2000 PST, Mon Jan 03 00:00:00 2000 PST])","TBOXFLOAT XT([4, 6],[Tue Jan 04 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 9],[Fri Jan 07 00:00:00 2000 PST, Sun Jan 09 00:00:00 2000 PST])","TBOXFLOAT XT([10, 10],[Mon Jan 10 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 1);
                                                                              spliteachntboxes                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 2);
                                                                              spliteachntboxes                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 3);
                                                                              spliteachntboxes                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 4);
                                                                              spliteachntboxes                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 5);
                                                                              spliteachntboxes                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

SELECT splitEachNTboxes(tfloat '{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03,
4@2000-01-04, 5@2000-01-05, 6@2000-01-06], [7@2000-01-07,
8@2000-01-08, 9@2000-01-09, 10@2000-01-10]}', 6);
                                                                              spliteachntboxes                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"TBOXFLOAT XT([1, 6],[Sat Jan 01 00:00:00 2000 PST, Thu Jan 06 00:00:00 2000 PST])","TBOXFLOAT XT([7, 10],[Fri Jan 07 00:00:00 2000 PST, Mon Jan 10 00:00:00 2000 PST])"}
(1 row)

/* Errors */
SELECT splitEachNTboxes(tfloat '1@2000-01-01', -1);
ERROR:  The value must be strictly positive: -1
